import{aX as mn,a7 as wu}from"./BXLc-fqL.js";import{_ as mu}from"./DZIK79hL.js";var bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qi={},Xr={},Ds;function ua(){if(Ds)return Xr;Ds=1,Xr.byteLength=s,Xr.toByteArray=b,Xr.fromByteArray=A;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)e[i]=n[i],t[n.charCodeAt(i)]=i;t[45]=62,t[95]=63;function u(_){var y=_.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $=_.indexOf("=");$===-1&&($=y);var V=$===y?0:4-$%4;return[$,V]}function s(_){var y=u(_),$=y[0],V=y[1];return($+V)*3/4-V}function p(_,y,$){return(y+$)*3/4-$}function b(_){var y,$=u(_),V=$[0],z=$[1],j=new r(p(_,V,z)),Y=0,ie=z>0?V-4:V,R;for(R=0;R<ie;R+=4)y=t[_.charCodeAt(R)]<<18|t[_.charCodeAt(R+1)]<<12|t[_.charCodeAt(R+2)]<<6|t[_.charCodeAt(R+3)],j[Y++]=y>>16&255,j[Y++]=y>>8&255,j[Y++]=y&255;return z===2&&(y=t[_.charCodeAt(R)]<<2|t[_.charCodeAt(R+1)]>>4,j[Y++]=y&255),z===1&&(y=t[_.charCodeAt(R)]<<10|t[_.charCodeAt(R+1)]<<4|t[_.charCodeAt(R+2)]>>2,j[Y++]=y>>8&255,j[Y++]=y&255),j}function B(_){return e[_>>18&63]+e[_>>12&63]+e[_>>6&63]+e[_&63]}function w(_,y,$){for(var V,z=[],j=y;j<$;j+=3)V=(_[j]<<16&16711680)+(_[j+1]<<8&65280)+(_[j+2]&255),z.push(B(V));return z.join("")}function A(_){for(var y,$=_.length,V=$%3,z=[],j=16383,Y=0,ie=$-V;Y<ie;Y+=j)z.push(w(_,Y,Y+j>ie?ie:Y+j));return V===1?(y=_[$-1],z.push(e[y>>2]+e[y<<4&63]+"==")):V===2&&(y=(_[$-2]<<8)+_[$-1],z.push(e[y>>10]+e[y>>4&63]+e[y<<2&63]+"=")),z.join("")}return Xr}var Bn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Js;function ks(){return Js||(Js=1,Bn.read=function(e,t,r,n,i){var a,u,s=i*8-n-1,p=(1<<s)-1,b=p>>1,B=-7,w=r?i-1:0,A=r?-1:1,_=e[t+w];for(w+=A,a=_&(1<<-B)-1,_>>=-B,B+=s;B>0;a=a*256+e[t+w],w+=A,B-=8);for(u=a&(1<<-B)-1,a>>=-B,B+=n;B>0;u=u*256+e[t+w],w+=A,B-=8);if(a===0)a=1-b;else{if(a===p)return u?NaN:(_?-1:1)*(1/0);u=u+Math.pow(2,n),a=a-b}return(_?-1:1)*u*Math.pow(2,a-n)},Bn.write=function(e,t,r,n,i,a){var u,s,p,b=a*8-i-1,B=(1<<b)-1,w=B>>1,A=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=n?0:a-1,y=n?1:-1,$=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,u=B):(u=Math.floor(Math.log(t)/Math.LN2),t*(p=Math.pow(2,-u))<1&&(u--,p*=2),u+w>=1?t+=A/p:t+=A*Math.pow(2,1-w),t*p>=2&&(u++,p/=2),u+w>=B?(s=0,u=B):u+w>=1?(s=(t*p-1)*Math.pow(2,i),u=u+w):(s=t*Math.pow(2,w-1)*Math.pow(2,i),u=0));i>=8;e[r+_]=s&255,_+=y,s/=256,i-=8);for(u=u<<i|s,b+=i;b>0;e[r+_]=u&255,_+=y,u/=256,b-=8);e[r+_-y]|=$*128}),Bn}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Qs;function xu(){return Qs||(Qs=1,function(e){const t=ua(),r=ks(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=j,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=a(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const g=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(g,f),g.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(g){if(g>i)throw new RangeError('The value "'+g+'" is invalid for option "size"');const f=new Uint8Array(g);return Object.setPrototypeOf(f,s.prototype),f}function s(g,f,l){if(typeof g=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(g)}return p(g,f,l)}s.poolSize=8192;function p(g,f,l){if(typeof g=="string")return A(g,f);if(ArrayBuffer.isView(g))return y(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(W(g,ArrayBuffer)||g&&W(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(W(g,SharedArrayBuffer)||g&&W(g.buffer,SharedArrayBuffer)))return $(g,f,l);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const N=g.valueOf&&g.valueOf();if(N!=null&&N!==g)return s.from(N,f,l);const H=V(g);if(H)return H;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return s.from(g[Symbol.toPrimitive]("string"),f,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}s.from=function(g,f,l){return p(g,f,l)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function b(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function B(g,f,l){return b(g),g<=0?u(g):f!==void 0?typeof l=="string"?u(g).fill(f,l):u(g).fill(f):u(g)}s.alloc=function(g,f,l){return B(g,f,l)};function w(g){return b(g),u(g<0?0:z(g)|0)}s.allocUnsafe=function(g){return w(g)},s.allocUnsafeSlow=function(g){return w(g)};function A(g,f){if((typeof f!="string"||f==="")&&(f="utf8"),!s.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const l=Y(g,f)|0;let N=u(l);const H=N.write(g,f);return H!==l&&(N=N.slice(0,H)),N}function _(g){const f=g.length<0?0:z(g.length)|0,l=u(f);for(let N=0;N<f;N+=1)l[N]=g[N]&255;return l}function y(g){if(W(g,Uint8Array)){const f=new Uint8Array(g);return $(f.buffer,f.byteOffset,f.byteLength)}return _(g)}function $(g,f,l){if(f<0||g.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<f+(l||0))throw new RangeError('"length" is outside of buffer bounds');let N;return f===void 0&&l===void 0?N=new Uint8Array(g):l===void 0?N=new Uint8Array(g,f):N=new Uint8Array(g,f,l),Object.setPrototypeOf(N,s.prototype),N}function V(g){if(s.isBuffer(g)){const f=z(g.length)|0,l=u(f);return l.length===0||g.copy(l,0,0,f),l}if(g.length!==void 0)return typeof g.length!="number"||se(g.length)?u(0):_(g);if(g.type==="Buffer"&&Array.isArray(g.data))return _(g.data)}function z(g){if(g>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return g|0}function j(g){return+g!=g&&(g=0),s.alloc(+g)}s.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==s.prototype},s.compare=function(f,l){if(W(f,Uint8Array)&&(f=s.from(f,f.offset,f.byteLength)),W(l,Uint8Array)&&(l=s.from(l,l.offset,l.byteLength)),!s.isBuffer(f)||!s.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===l)return 0;let N=f.length,H=l.length;for(let L=0,Z=Math.min(N,H);L<Z;++L)if(f[L]!==l[L]){N=f[L],H=l[L];break}return N<H?-1:H<N?1:0},s.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(f,l){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return s.alloc(0);let N;if(l===void 0)for(l=0,N=0;N<f.length;++N)l+=f[N].length;const H=s.allocUnsafe(l);let L=0;for(N=0;N<f.length;++N){let Z=f[N];if(W(Z,Uint8Array))L+Z.length>H.length?(s.isBuffer(Z)||(Z=s.from(Z)),Z.copy(H,L)):Uint8Array.prototype.set.call(H,Z,L);else if(s.isBuffer(Z))Z.copy(H,L);else throw new TypeError('"list" argument must be an Array of Buffers');L+=Z.length}return H};function Y(g,f){if(s.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||W(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const l=g.length,N=arguments.length>2&&arguments[2]===!0;if(!N&&l===0)return 0;let H=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return o(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return E(g).length;default:if(H)return N?-1:o(g).length;f=(""+f).toLowerCase(),H=!0}}s.byteLength=Y;function ie(g,f,l){let N=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,f>>>=0,l<=f))return"";for(g||(g="utf8");;)switch(g){case"hex":return ue(this,f,l);case"utf8":case"utf-8":return T(this,f,l);case"ascii":return Q(this,f,l);case"latin1":case"binary":return re(this,f,l);case"base64":return d(this,f,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,f,l);default:if(N)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),N=!0}}s.prototype._isBuffer=!0;function R(g,f,l){const N=g[f];g[f]=g[l],g[l]=N}s.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let l=0;l<f;l+=2)R(this,l,l+1);return this},s.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let l=0;l<f;l+=4)R(this,l,l+3),R(this,l+1,l+2);return this},s.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let l=0;l<f;l+=8)R(this,l,l+7),R(this,l+1,l+6),R(this,l+2,l+5),R(this,l+3,l+4);return this},s.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?T(this,0,f):ie.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(f){if(!s.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:s.compare(this,f)===0},s.prototype.inspect=function(){let f="";const l=e.INSPECT_MAX_BYTES;return f=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(f+=" ... "),"<Buffer "+f+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(f,l,N,H,L){if(W(f,Uint8Array)&&(f=s.from(f,f.offset,f.byteLength)),!s.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(l===void 0&&(l=0),N===void 0&&(N=f?f.length:0),H===void 0&&(H=0),L===void 0&&(L=this.length),l<0||N>f.length||H<0||L>this.length)throw new RangeError("out of range index");if(H>=L&&l>=N)return 0;if(H>=L)return-1;if(l>=N)return 1;if(l>>>=0,N>>>=0,H>>>=0,L>>>=0,this===f)return 0;let Z=L-H,we=N-l;const xe=Math.min(Z,we),me=this.slice(H,L),ge=f.slice(l,N);for(let Se=0;Se<xe;++Se)if(me[Se]!==ge[Se]){Z=me[Se],we=ge[Se];break}return Z<we?-1:we<Z?1:0};function X(g,f,l,N,H){if(g.length===0)return-1;if(typeof l=="string"?(N=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,se(l)&&(l=H?0:g.length-1),l<0&&(l=g.length+l),l>=g.length){if(H)return-1;l=g.length-1}else if(l<0)if(H)l=0;else return-1;if(typeof f=="string"&&(f=s.from(f,N)),s.isBuffer(f))return f.length===0?-1:J(g,f,l,N,H);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?H?Uint8Array.prototype.indexOf.call(g,f,l):Uint8Array.prototype.lastIndexOf.call(g,f,l):J(g,[f],l,N,H);throw new TypeError("val must be string, number or Buffer")}function J(g,f,l,N,H){let L=1,Z=g.length,we=f.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(g.length<2||f.length<2)return-1;L=2,Z/=2,we/=2,l/=2}function xe(ge,Se){return L===1?ge[Se]:ge.readUInt16BE(Se*L)}let me;if(H){let ge=-1;for(me=l;me<Z;me++)if(xe(g,me)===xe(f,ge===-1?0:me-ge)){if(ge===-1&&(ge=me),me-ge+1===we)return ge*L}else ge!==-1&&(me-=me-ge),ge=-1}else for(l+we>Z&&(l=Z-we),me=l;me>=0;me--){let ge=!0;for(let Se=0;Se<we;Se++)if(xe(g,me+Se)!==xe(f,Se)){ge=!1;break}if(ge)return me}return-1}s.prototype.includes=function(f,l,N){return this.indexOf(f,l,N)!==-1},s.prototype.indexOf=function(f,l,N){return X(this,f,l,N,!0)},s.prototype.lastIndexOf=function(f,l,N){return X(this,f,l,N,!1)};function I(g,f,l,N){l=Number(l)||0;const H=g.length-l;N?(N=Number(N),N>H&&(N=H)):N=H;const L=f.length;N>L/2&&(N=L/2);let Z;for(Z=0;Z<N;++Z){const we=parseInt(f.substr(Z*2,2),16);if(se(we))return Z;g[l+Z]=we}return Z}function O(g,f,l,N){return F(o(f,g.length-l),g,l,N)}function P(g,f,l,N){return F(c(f),g,l,N)}function D(g,f,l,N){return F(E(f),g,l,N)}function te(g,f,l,N){return F(m(f,g.length-l),g,l,N)}s.prototype.write=function(f,l,N,H){if(l===void 0)H="utf8",N=this.length,l=0;else if(N===void 0&&typeof l=="string")H=l,N=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(N)?(N=N>>>0,H===void 0&&(H="utf8")):(H=N,N=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const L=this.length-l;if((N===void 0||N>L)&&(N=L),f.length>0&&(N<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");H||(H="utf8");let Z=!1;for(;;)switch(H){case"hex":return I(this,f,l,N);case"utf8":case"utf-8":return O(this,f,l,N);case"ascii":case"latin1":case"binary":return P(this,f,l,N);case"base64":return D(this,f,l,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,f,l,N);default:if(Z)throw new TypeError("Unknown encoding: "+H);H=(""+H).toLowerCase(),Z=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function d(g,f,l){return f===0&&l===g.length?t.fromByteArray(g):t.fromByteArray(g.slice(f,l))}function T(g,f,l){l=Math.min(g.length,l);const N=[];let H=f;for(;H<l;){const L=g[H];let Z=null,we=L>239?4:L>223?3:L>191?2:1;if(H+we<=l){let xe,me,ge,Se;switch(we){case 1:L<128&&(Z=L);break;case 2:xe=g[H+1],(xe&192)===128&&(Se=(L&31)<<6|xe&63,Se>127&&(Z=Se));break;case 3:xe=g[H+1],me=g[H+2],(xe&192)===128&&(me&192)===128&&(Se=(L&15)<<12|(xe&63)<<6|me&63,Se>2047&&(Se<55296||Se>57343)&&(Z=Se));break;case 4:xe=g[H+1],me=g[H+2],ge=g[H+3],(xe&192)===128&&(me&192)===128&&(ge&192)===128&&(Se=(L&15)<<18|(xe&63)<<12|(me&63)<<6|ge&63,Se>65535&&Se<1114112&&(Z=Se))}}Z===null?(Z=65533,we=1):Z>65535&&(Z-=65536,N.push(Z>>>10&1023|55296),Z=56320|Z&1023),N.push(Z),H+=we}return K(N)}const k=4096;function K(g){const f=g.length;if(f<=k)return String.fromCharCode.apply(String,g);let l="",N=0;for(;N<f;)l+=String.fromCharCode.apply(String,g.slice(N,N+=k));return l}function Q(g,f,l){let N="";l=Math.min(g.length,l);for(let H=f;H<l;++H)N+=String.fromCharCode(g[H]&127);return N}function re(g,f,l){let N="";l=Math.min(g.length,l);for(let H=f;H<l;++H)N+=String.fromCharCode(g[H]);return N}function ue(g,f,l){const N=g.length;(!f||f<0)&&(f=0),(!l||l<0||l>N)&&(l=N);let H="";for(let L=f;L<l;++L)H+=fe[g[L]];return H}function ye(g,f,l){const N=g.slice(f,l);let H="";for(let L=0;L<N.length-1;L+=2)H+=String.fromCharCode(N[L]+N[L+1]*256);return H}s.prototype.slice=function(f,l){const N=this.length;f=~~f,l=l===void 0?N:~~l,f<0?(f+=N,f<0&&(f=0)):f>N&&(f=N),l<0?(l+=N,l<0&&(l=0)):l>N&&(l=N),l<f&&(l=f);const H=this.subarray(f,l);return Object.setPrototypeOf(H,s.prototype),H};function oe(g,f,l){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+f>l)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(f,l,N){f=f>>>0,l=l>>>0,N||oe(f,l,this.length);let H=this[f],L=1,Z=0;for(;++Z<l&&(L*=256);)H+=this[f+Z]*L;return H},s.prototype.readUintBE=s.prototype.readUIntBE=function(f,l,N){f=f>>>0,l=l>>>0,N||oe(f,l,this.length);let H=this[f+--l],L=1;for(;l>0&&(L*=256);)H+=this[f+--l]*L;return H},s.prototype.readUint8=s.prototype.readUInt8=function(f,l){return f=f>>>0,l||oe(f,1,this.length),this[f]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(f,l){return f=f>>>0,l||oe(f,2,this.length),this[f]|this[f+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(f,l){return f=f>>>0,l||oe(f,2,this.length),this[f]<<8|this[f+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},s.prototype.readBigUInt64LE=he(function(f){f=f>>>0,C(f,"offset");const l=this[f],N=this[f+7];(l===void 0||N===void 0)&&M(f,this.length-8);const H=l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,L=this[++f]+this[++f]*2**8+this[++f]*2**16+N*2**24;return BigInt(H)+(BigInt(L)<<BigInt(32))}),s.prototype.readBigUInt64BE=he(function(f){f=f>>>0,C(f,"offset");const l=this[f],N=this[f+7];(l===void 0||N===void 0)&&M(f,this.length-8);const H=l*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],L=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+N;return(BigInt(H)<<BigInt(32))+BigInt(L)}),s.prototype.readIntLE=function(f,l,N){f=f>>>0,l=l>>>0,N||oe(f,l,this.length);let H=this[f],L=1,Z=0;for(;++Z<l&&(L*=256);)H+=this[f+Z]*L;return L*=128,H>=L&&(H-=Math.pow(2,8*l)),H},s.prototype.readIntBE=function(f,l,N){f=f>>>0,l=l>>>0,N||oe(f,l,this.length);let H=l,L=1,Z=this[f+--H];for(;H>0&&(L*=256);)Z+=this[f+--H]*L;return L*=128,Z>=L&&(Z-=Math.pow(2,8*l)),Z},s.prototype.readInt8=function(f,l){return f=f>>>0,l||oe(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},s.prototype.readInt16LE=function(f,l){f=f>>>0,l||oe(f,2,this.length);const N=this[f]|this[f+1]<<8;return N&32768?N|4294901760:N},s.prototype.readInt16BE=function(f,l){f=f>>>0,l||oe(f,2,this.length);const N=this[f+1]|this[f]<<8;return N&32768?N|4294901760:N},s.prototype.readInt32LE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},s.prototype.readInt32BE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},s.prototype.readBigInt64LE=he(function(f){f=f>>>0,C(f,"offset");const l=this[f],N=this[f+7];(l===void 0||N===void 0)&&M(f,this.length-8);const H=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(N<<24);return(BigInt(H)<<BigInt(32))+BigInt(l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24)}),s.prototype.readBigInt64BE=he(function(f){f=f>>>0,C(f,"offset");const l=this[f],N=this[f+7];(l===void 0||N===void 0)&&M(f,this.length-8);const H=(l<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(H)<<BigInt(32))+BigInt(this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+N)}),s.prototype.readFloatLE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),r.read(this,f,!0,23,4)},s.prototype.readFloatBE=function(f,l){return f=f>>>0,l||oe(f,4,this.length),r.read(this,f,!1,23,4)},s.prototype.readDoubleLE=function(f,l){return f=f>>>0,l||oe(f,8,this.length),r.read(this,f,!0,52,8)},s.prototype.readDoubleBE=function(f,l){return f=f>>>0,l||oe(f,8,this.length),r.read(this,f,!1,52,8)};function le(g,f,l,N,H,L){if(!s.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>H||f<L)throw new RangeError('"value" argument is out of bounds');if(l+N>g.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(f,l,N,H){if(f=+f,l=l>>>0,N=N>>>0,!H){const we=Math.pow(2,8*N)-1;le(this,f,l,N,we,0)}let L=1,Z=0;for(this[l]=f&255;++Z<N&&(L*=256);)this[l+Z]=f/L&255;return l+N},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(f,l,N,H){if(f=+f,l=l>>>0,N=N>>>0,!H){const we=Math.pow(2,8*N)-1;le(this,f,l,N,we,0)}let L=N-1,Z=1;for(this[l+L]=f&255;--L>=0&&(Z*=256);)this[l+L]=f/Z&255;return l+N},s.prototype.writeUint8=s.prototype.writeUInt8=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,1,255,0),this[l]=f&255,l+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,2,65535,0),this[l]=f&255,this[l+1]=f>>>8,l+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,2,65535,0),this[l]=f>>>8,this[l+1]=f&255,l+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,4,4294967295,0),this[l+3]=f>>>24,this[l+2]=f>>>16,this[l+1]=f>>>8,this[l]=f&255,l+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,4,4294967295,0),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4};function Ne(g,f,l,N,H){U(f,N,H,g,l,7);let L=Number(f&BigInt(4294967295));g[l++]=L,L=L>>8,g[l++]=L,L=L>>8,g[l++]=L,L=L>>8,g[l++]=L;let Z=Number(f>>BigInt(32)&BigInt(4294967295));return g[l++]=Z,Z=Z>>8,g[l++]=Z,Z=Z>>8,g[l++]=Z,Z=Z>>8,g[l++]=Z,l}function S(g,f,l,N,H){U(f,N,H,g,l,7);let L=Number(f&BigInt(4294967295));g[l+7]=L,L=L>>8,g[l+6]=L,L=L>>8,g[l+5]=L,L=L>>8,g[l+4]=L;let Z=Number(f>>BigInt(32)&BigInt(4294967295));return g[l+3]=Z,Z=Z>>8,g[l+2]=Z,Z=Z>>8,g[l+1]=Z,Z=Z>>8,g[l]=Z,l+8}s.prototype.writeBigUInt64LE=he(function(f,l=0){return Ne(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=he(function(f,l=0){return S(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(f,l,N,H){if(f=+f,l=l>>>0,!H){const xe=Math.pow(2,8*N-1);le(this,f,l,N,xe-1,-xe)}let L=0,Z=1,we=0;for(this[l]=f&255;++L<N&&(Z*=256);)f<0&&we===0&&this[l+L-1]!==0&&(we=1),this[l+L]=(f/Z>>0)-we&255;return l+N},s.prototype.writeIntBE=function(f,l,N,H){if(f=+f,l=l>>>0,!H){const xe=Math.pow(2,8*N-1);le(this,f,l,N,xe-1,-xe)}let L=N-1,Z=1,we=0;for(this[l+L]=f&255;--L>=0&&(Z*=256);)f<0&&we===0&&this[l+L+1]!==0&&(we=1),this[l+L]=(f/Z>>0)-we&255;return l+N},s.prototype.writeInt8=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,1,127,-128),f<0&&(f=255+f+1),this[l]=f&255,l+1},s.prototype.writeInt16LE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,2,32767,-32768),this[l]=f&255,this[l+1]=f>>>8,l+2},s.prototype.writeInt16BE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,2,32767,-32768),this[l]=f>>>8,this[l+1]=f&255,l+2},s.prototype.writeInt32LE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,4,2147483647,-2147483648),this[l]=f&255,this[l+1]=f>>>8,this[l+2]=f>>>16,this[l+3]=f>>>24,l+4},s.prototype.writeInt32BE=function(f,l,N){return f=+f,l=l>>>0,N||le(this,f,l,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4},s.prototype.writeBigInt64LE=he(function(f,l=0){return Ne(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=he(function(f,l=0){return S(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Be(g,f,l,N,H,L){if(l+N>g.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function Ie(g,f,l,N,H){return f=+f,l=l>>>0,H||Be(g,f,l,4),r.write(g,f,l,N,23,4),l+4}s.prototype.writeFloatLE=function(f,l,N){return Ie(this,f,l,!0,N)},s.prototype.writeFloatBE=function(f,l,N){return Ie(this,f,l,!1,N)};function ae(g,f,l,N,H){return f=+f,l=l>>>0,H||Be(g,f,l,8),r.write(g,f,l,N,52,8),l+8}s.prototype.writeDoubleLE=function(f,l,N){return ae(this,f,l,!0,N)},s.prototype.writeDoubleBE=function(f,l,N){return ae(this,f,l,!1,N)},s.prototype.copy=function(f,l,N,H){if(!s.isBuffer(f))throw new TypeError("argument should be a Buffer");if(N||(N=0),!H&&H!==0&&(H=this.length),l>=f.length&&(l=f.length),l||(l=0),H>0&&H<N&&(H=N),H===N||f.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(N<0||N>=this.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("sourceEnd out of bounds");H>this.length&&(H=this.length),f.length-l<H-N&&(H=f.length-l+N);const L=H-N;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,N,H):Uint8Array.prototype.set.call(f,this.subarray(N,H),l),L},s.prototype.fill=function(f,l,N,H){if(typeof f=="string"){if(typeof l=="string"?(H=l,l=0,N=this.length):typeof N=="string"&&(H=N,N=this.length),H!==void 0&&typeof H!="string")throw new TypeError("encoding must be a string");if(typeof H=="string"&&!s.isEncoding(H))throw new TypeError("Unknown encoding: "+H);if(f.length===1){const Z=f.charCodeAt(0);(H==="utf8"&&Z<128||H==="latin1")&&(f=Z)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(l<0||this.length<l||this.length<N)throw new RangeError("Out of range index");if(N<=l)return this;l=l>>>0,N=N===void 0?this.length:N>>>0,f||(f=0);let L;if(typeof f=="number")for(L=l;L<N;++L)this[L]=f;else{const Z=s.isBuffer(f)?f:s.from(f,H),we=Z.length;if(we===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(L=0;L<N-l;++L)this[L+l]=Z[L%we]}return this};const ee={};function ne(g,f,l){ee[g]=class extends l{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(H){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:H,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}ne("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ne("ERR_INVALID_ARG_TYPE",function(g,f){return`The "${g}" argument must be of type number. Received type ${typeof f}`},TypeError),ne("ERR_OUT_OF_RANGE",function(g,f,l){let N=`The value of "${g}" is out of range.`,H=l;return Number.isInteger(l)&&Math.abs(l)>2**32?H=x(String(l)):typeof l=="bigint"&&(H=String(l),(l>BigInt(2)**BigInt(32)||l<-(BigInt(2)**BigInt(32)))&&(H=x(H)),H+="n"),N+=` It must be ${f}. Received ${H}`,N},RangeError);function x(g){let f="",l=g.length;const N=g[0]==="-"?1:0;for(;l>=N+4;l-=3)f=`_${g.slice(l-3,l)}${f}`;return`${g.slice(0,l)}${f}`}function v(g,f,l){C(f,"offset"),(g[f]===void 0||g[f+l]===void 0)&&M(f,g.length-(l+1))}function U(g,f,l,N,H,L){if(g>l||g<f){const Z=typeof f=="bigint"?"n":"";let we;throw f===0||f===BigInt(0)?we=`>= 0${Z} and < 2${Z} ** ${(L+1)*8}${Z}`:we=`>= -(2${Z} ** ${(L+1)*8-1}${Z}) and < 2 ** ${(L+1)*8-1}${Z}`,new ee.ERR_OUT_OF_RANGE("value",we,g)}v(N,H,L)}function C(g,f){if(typeof g!="number")throw new ee.ERR_INVALID_ARG_TYPE(f,"number",g)}function M(g,f,l){throw Math.floor(g)!==g?(C(g,l),new ee.ERR_OUT_OF_RANGE("offset","an integer",g)):f<0?new ee.ERR_BUFFER_OUT_OF_BOUNDS:new ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,g)}const G=/[^+/0-9A-Za-z-_]/g;function h(g){if(g=g.split("=")[0],g=g.trim().replace(G,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function o(g,f){f=f||1/0;let l;const N=g.length;let H=null;const L=[];for(let Z=0;Z<N;++Z){if(l=g.charCodeAt(Z),l>55295&&l<57344){if(!H){if(l>56319){(f-=3)>-1&&L.push(239,191,189);continue}else if(Z+1===N){(f-=3)>-1&&L.push(239,191,189);continue}H=l;continue}if(l<56320){(f-=3)>-1&&L.push(239,191,189),H=l;continue}l=(H-55296<<10|l-56320)+65536}else H&&(f-=3)>-1&&L.push(239,191,189);if(H=null,l<128){if((f-=1)<0)break;L.push(l)}else if(l<2048){if((f-=2)<0)break;L.push(l>>6|192,l&63|128)}else if(l<65536){if((f-=3)<0)break;L.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((f-=4)<0)break;L.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return L}function c(g){const f=[];for(let l=0;l<g.length;++l)f.push(g.charCodeAt(l)&255);return f}function m(g,f){let l,N,H;const L=[];for(let Z=0;Z<g.length&&!((f-=2)<0);++Z)l=g.charCodeAt(Z),N=l>>8,H=l%256,L.push(H),L.push(N);return L}function E(g){return t.toByteArray(h(g))}function F(g,f,l,N){let H;for(H=0;H<N&&!(H+l>=f.length||H>=g.length);++H)f[H+l]=g[H];return H}function W(g,f){return g instanceof f||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===f.name}function se(g){return g!==g}const fe=function(){const g="0123456789abcdef",f=new Array(256);for(let l=0;l<16;++l){const N=l*16;for(let H=0;H<16;++H)f[N+H]=g[l]+g[H]}return f}();function he(g){return typeof BigInt>"u"?be:g}function be(){throw new Error("BigInt not supported")}}(qi)),qi}var Eu=xu(),bs;(function(e){e[e.SysFatal=1]="SysFatal",e[e.SysTransient=2]="SysTransient",e[e.DestinationInvalid=3]="DestinationInvalid",e[e.CanisterReject=4]="CanisterReject",e[e.CanisterError=5]="CanisterError"})(bs||(bs={}));const ii="abcdefghijklmnopqrstuvwxyz234567",Hr=Object.create(null);for(let e=0;e<ii.length;e++)Hr[ii[e]]=e;Hr[0]=Hr.o;Hr[1]=Hr.i;function vu(e){let t=0,r=0,n="";function i(a){return t<0?r|=a>>-t:r=a<<t&248,t>3?(t-=8,1):(t<4&&(n+=ii[r>>3],t+=5),0)}for(let a=0;a<e.length;)a+=i(e[a]);return n+(t<0?ii[r>>3]:"")}function Bu(e){let t=0,r=0;const n=new Uint8Array(e.length*4/3|0);let i=0;function a(u){let s=Hr[u.toLowerCase()];if(s===void 0)throw new Error(`Invalid character: ${JSON.stringify(u)}`);s<<=3,r|=s>>>t,t+=5,t>=8&&(n[i++]=r,t-=8,t>0?r=s<<5-t&255:r=0)}for(const u of e)a(u);return n.slice(0,i)}const Au=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Tu(e){const t=new Uint8Array(e);let r=-1;for(let n=0;n<t.length;n++){const a=(t[n]^r)&255;r=Au[a]^r>>>8}return(r^-1)>>>0}const Br=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ms(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Su(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Le(e,...t){if(!Ms(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function eo(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Nu(e,t){Le(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function fn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function $i(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function wt(e,t){return e<<32-t|e>>>t}const fa=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Iu=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Kr(e){if(Le(e),fa)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Iu[e[r]];return t}const St={_0:48,_9:57,A:65,F:70,a:97,f:102};function to(e){if(e>=St._0&&e<=St._9)return e-St._0;if(e>=St.A&&e<=St.F)return e-(St.A-10);if(e>=St.a&&e<=St.f)return e-(St.a-10)}function la(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(fa)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let i=0,a=0;i<r;i++,a+=2){const u=to(e.charCodeAt(a)),s=to(e.charCodeAt(a+1));if(u===void 0||s===void 0){const p=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+a)}n[i]=u*16+s}return n}function wi(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function ha(e){return typeof e=="string"&&(e=wi(e)),Le(e),e}function Ce(...e){let t=0;for(let n=0;n<e.length;n++){const i=e[n];Le(i),t+=i.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const a=e[n];r.set(a,i),i+=a.length}return r}class Ru{}function Cs(e){const t=n=>e().update(ha(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function da(e=32){if(Br&&typeof Br.getRandomValues=="function")return Br.getRandomValues(new Uint8Array(e));if(Br&&typeof Br.randomBytes=="function")return Uint8Array.from(Br.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function Uu(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const i=BigInt(32),a=BigInt(4294967295),u=Number(r>>i&a),s=Number(r&a),p=n?4:0,b=n?0:4;e.setUint32(t+p,u,n),e.setUint32(t+b,s,n)}function Ou(e,t,r){return e&t^~e&r}function Fu(e,t,r){return e&t^e&r^t&r}class pa extends Ru{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=$i(this.buffer)}update(t){eo(this),t=ha(t),Le(t);const{view:r,buffer:n,blockLen:i}=this,a=t.length;for(let u=0;u<a;){const s=Math.min(i-this.pos,a-u);if(s===i){const p=$i(t);for(;i<=a-u;u+=i)this.process(p,u);continue}n.set(t.subarray(u,u+s),this.pos),this.pos+=s,u+=s,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){eo(this),Nu(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:a}=this;let{pos:u}=this;r[u++]=128,fn(this.buffer.subarray(u)),this.padOffset>i-u&&(this.process(n,0),u=0);for(let w=u;w<i;w++)r[w]=0;Uu(n,i-8,BigInt(this.length*8),a),this.process(n,0);const s=$i(t),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=p/4,B=this.get();if(b>B.length)throw new Error("_sha2: outputLen bigger than state");for(let w=0;w<b;w++)s.setUint32(4*w,B[w],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:a,destroyed:u,pos:s}=this;return t.destroyed=u,t.finished=a,t.length=i,t.pos=s,i%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const Ht=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Kt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Xe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),An=BigInt(2**32-1),ro=BigInt(32);function Pu(e,t=!1){return t?{h:Number(e&An),l:Number(e>>ro&An)}:{h:Number(e>>ro&An)|0,l:Number(e&An)|0}}function ku(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let a=0;a<r;a++){const{h:u,l:s}=Pu(e[a],t);[n[a],i[a]]=[u,s]}return[n,i]}const no=(e,t,r)=>e>>>r,io=(e,t,r)=>e<<32-r|t>>>r,Ar=(e,t,r)=>e>>>r|t<<32-r,Tr=(e,t,r)=>e<<32-r|t>>>r,Tn=(e,t,r)=>e<<64-r|t>>>r-32,Sn=(e,t,r)=>e>>>r-32|t<<64-r;function Nt(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}const Mu=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Cu=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,qu=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),$u=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,Gu=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Vu=(e,t,r,n,i,a)=>t+r+n+i+a+(e/2**32|0)|0,Hu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),jt=new Uint32Array(64);class ya extends pa{constructor(t=32){super(64,t,8,!1),this.A=Ht[0]|0,this.B=Ht[1]|0,this.C=Ht[2]|0,this.D=Ht[3]|0,this.E=Ht[4]|0,this.F=Ht[5]|0,this.G=Ht[6]|0,this.H=Ht[7]|0}get(){const{A:t,B:r,C:n,D:i,E:a,F:u,G:s,H:p}=this;return[t,r,n,i,a,u,s,p]}set(t,r,n,i,a,u,s,p){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=u|0,this.G=s|0,this.H=p|0}process(t,r){for(let w=0;w<16;w++,r+=4)jt[w]=t.getUint32(r,!1);for(let w=16;w<64;w++){const A=jt[w-15],_=jt[w-2],y=wt(A,7)^wt(A,18)^A>>>3,$=wt(_,17)^wt(_,19)^_>>>10;jt[w]=$+jt[w-7]+y+jt[w-16]|0}let{A:n,B:i,C:a,D:u,E:s,F:p,G:b,H:B}=this;for(let w=0;w<64;w++){const A=wt(s,6)^wt(s,11)^wt(s,25),_=B+A+Ou(s,p,b)+Hu[w]+jt[w]|0,$=(wt(n,2)^wt(n,13)^wt(n,22))+Fu(n,i,a)|0;B=b,b=p,p=s,s=u+_|0,u=a,a=i,i=n,n=_+$|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,u=u+this.D|0,s=s+this.E|0,p=p+this.F|0,b=b+this.G|0,B=B+this.H|0,this.set(n,i,a,u,s,p,b,B)}roundClean(){fn(jt)}destroy(){this.set(0,0,0,0,0,0,0,0),fn(this.buffer)}}class Ku extends ya{constructor(){super(28),this.A=Kt[0]|0,this.B=Kt[1]|0,this.C=Kt[2]|0,this.D=Kt[3]|0,this.E=Kt[4]|0,this.F=Kt[5]|0,this.G=Kt[6]|0,this.H=Kt[7]|0}}const ga=ku(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ju=ga[0],zu=ga[1],zt=new Uint32Array(80),Wt=new Uint32Array(80);class Wu extends pa{constructor(t=64){super(128,t,16,!1),this.Ah=Xe[0]|0,this.Al=Xe[1]|0,this.Bh=Xe[2]|0,this.Bl=Xe[3]|0,this.Ch=Xe[4]|0,this.Cl=Xe[5]|0,this.Dh=Xe[6]|0,this.Dl=Xe[7]|0,this.Eh=Xe[8]|0,this.El=Xe[9]|0,this.Fh=Xe[10]|0,this.Fl=Xe[11]|0,this.Gh=Xe[12]|0,this.Gl=Xe[13]|0,this.Hh=Xe[14]|0,this.Hl=Xe[15]|0}get(){const{Ah:t,Al:r,Bh:n,Bl:i,Ch:a,Cl:u,Dh:s,Dl:p,Eh:b,El:B,Fh:w,Fl:A,Gh:_,Gl:y,Hh:$,Hl:V}=this;return[t,r,n,i,a,u,s,p,b,B,w,A,_,y,$,V]}set(t,r,n,i,a,u,s,p,b,B,w,A,_,y,$,V){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=u|0,this.Dh=s|0,this.Dl=p|0,this.Eh=b|0,this.El=B|0,this.Fh=w|0,this.Fl=A|0,this.Gh=_|0,this.Gl=y|0,this.Hh=$|0,this.Hl=V|0}process(t,r){for(let Y=0;Y<16;Y++,r+=4)zt[Y]=t.getUint32(r),Wt[Y]=t.getUint32(r+=4);for(let Y=16;Y<80;Y++){const ie=zt[Y-15]|0,R=Wt[Y-15]|0,X=Ar(ie,R,1)^Ar(ie,R,8)^no(ie,R,7),J=Tr(ie,R,1)^Tr(ie,R,8)^io(ie,R,7),I=zt[Y-2]|0,O=Wt[Y-2]|0,P=Ar(I,O,19)^Tn(I,O,61)^no(I,O,6),D=Tr(I,O,19)^Sn(I,O,61)^io(I,O,6),te=qu(J,D,Wt[Y-7],Wt[Y-16]),d=$u(te,X,P,zt[Y-7],zt[Y-16]);zt[Y]=d|0,Wt[Y]=te|0}let{Ah:n,Al:i,Bh:a,Bl:u,Ch:s,Cl:p,Dh:b,Dl:B,Eh:w,El:A,Fh:_,Fl:y,Gh:$,Gl:V,Hh:z,Hl:j}=this;for(let Y=0;Y<80;Y++){const ie=Ar(w,A,14)^Ar(w,A,18)^Tn(w,A,41),R=Tr(w,A,14)^Tr(w,A,18)^Sn(w,A,41),X=w&_^~w&$,J=A&y^~A&V,I=Gu(j,R,J,zu[Y],Wt[Y]),O=Vu(I,z,ie,X,ju[Y],zt[Y]),P=I|0,D=Ar(n,i,28)^Tn(n,i,34)^Tn(n,i,39),te=Tr(n,i,28)^Sn(n,i,34)^Sn(n,i,39),d=n&a^n&s^a&s,T=i&u^i&p^u&p;z=$|0,j=V|0,$=_|0,V=y|0,_=w|0,y=A|0,{h:w,l:A}=Nt(b|0,B|0,O|0,P|0),b=s|0,B=p|0,s=a|0,p=u|0,a=n|0,u=i|0;const k=Mu(P,te,T);n=Cu(k,O,D,d),i=k|0}({h:n,l:i}=Nt(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l:u}=Nt(this.Bh|0,this.Bl|0,a|0,u|0),{h:s,l:p}=Nt(this.Ch|0,this.Cl|0,s|0,p|0),{h:b,l:B}=Nt(this.Dh|0,this.Dl|0,b|0,B|0),{h:w,l:A}=Nt(this.Eh|0,this.El|0,w|0,A|0),{h:_,l:y}=Nt(this.Fh|0,this.Fl|0,_|0,y|0),{h:$,l:V}=Nt(this.Gh|0,this.Gl|0,$|0,V|0),{h:z,l:j}=Nt(this.Hh|0,this.Hl|0,z|0,j|0),this.set(n,i,a,u,s,p,b,B,w,A,_,y,$,V,z,j)}roundClean(){fn(zt,Wt)}destroy(){fn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const qs=Cs(()=>new ya),Yu=Cs(()=>new Ku),Zu=Cs(()=>new Wu),Lu=qs,Xu=Yu;function Du(e){return Xu.create().update(new Uint8Array(e)).digest()}const Nn="__principal__",Ju=2,so=4,Qu="aaaaa-aa",ef=e=>{var t;return new Uint8Array(((t=e.match(/.{1,2}/g))!==null&&t!==void 0?t:[]).map(r=>parseInt(r,16)))},tf=e=>e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),"");let _e=class Pn{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([so]))}static managementCanister(){return this.fromText(Qu)}static selfAuthenticating(t){const r=Du(t);return new this(new Uint8Array([...r,Ju]))}static from(t){if(typeof t=="string")return Pn.fromText(t);if(Object.getPrototypeOf(t)===Uint8Array.prototype)return new Pn(t);if(typeof t=="object"&&t!==null&&t._isPrincipal===!0)return new Pn(t._arr);throw new Error(`Impossible to convert ${JSON.stringify(t)} to Principal.`)}static fromHex(t){return new this(ef(t))}static fromText(t){let r=t;if(t.includes(Nn)){const u=JSON.parse(t);Nn in u&&(r=u[Nn])}const n=r.toLowerCase().replace(/-/g,"");let i=Bu(n);i=i.slice(4,i.length);const a=new this(i);if(a.toText()!==r)throw new Error(`Principal "${a.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return a}static fromUint8Array(t){return new this(t)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===so}toUint8Array(){return this._arr}toHex(){return tf(this._arr).toUpperCase()}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,Tu(this._arr));const n=new Uint8Array(t),i=Uint8Array.from(this._arr),a=new Uint8Array([...n,...i]),s=vu(a).match(/.{1,5}/g);if(!s)throw new Error;return s.join("-")}toString(){return this.toText()}toJSON(){return{[Nn]:this.toText()}}compareTo(t){for(let r=0;r<Math.min(this._arr.length,t._arr.length);r++){if(this._arr[r]<t._arr[r])return"lt";if(this._arr[r]>t._arr[r])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const r=this.compareTo(t);return r=="lt"||r=="eq"}gtEq(t){const r=this.compareTo(t);return r=="gt"||r=="eq"}};function gt(...e){const t=new Uint8Array(e.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of e)t.set(new Uint8Array(n),r),r+=n.byteLength;return t.buffer}function Pe(e){return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("")}const rf=new RegExp(/^[0-9a-fA-F]+$/);function qt(e){if(!rf.test(e))throw new Error("Invalid hexadecimal string.");const t=[...e].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(t).buffer}function wa(e,t){if(e.byteLength!==t.byteLength)return e.byteLength-t.byteLength;const r=new Uint8Array(e),n=new Uint8Array(t);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function bn(e,t){return wa(e,t)===0}function an(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function kt(e){return e instanceof Uint8Array?an(e):e instanceof ArrayBuffer?e:Array.isArray(e)?an(new Uint8Array(e)):"buffer"in e?kt(e.buffer):an(new Uint8Array(e))}class ke extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=ke.prototype,Object.setPrototypeOf(this,ke.prototype)}}function Re(...e){const t=new Uint8Array(e.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of e)t.set(new Uint8Array(n),r),r+=n.byteLength;return t}class Yr{constructor(t,r=(t==null?void 0:t.byteLength)||0){this._buffer=wr(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}save(){return this._view}restore(t){this._view=t}get buffer(){return wr(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const r=this._view.subarray(0,t);return this._view=this._view.subarray(t),r.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const r=new Uint8Array(t),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(t){const r=new ArrayBuffer((this._buffer.byteLength+t)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+t);n.set(this._view),this._buffer=r,this._view=n}}function Gi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function wr(e){return e instanceof Uint8Array?Gi(e):e instanceof ArrayBuffer?e:Array.isArray(e)?Gi(new Uint8Array(e)):"buffer"in e?wr(e.buffer):Gi(new Uint8Array(e))}function nf(e){const r=new TextEncoder().encode(e);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function Bt(e){if(/^_\d+_$/.test(e)||/^_0x[0-9a-fA-F]+_$/.test(e)){const t=+e.slice(1,-1);if(Number.isSafeInteger(t)&&t>=0&&t<2**32)return t}return nf(e)}function ma(){throw new Error("unexpected end of buffer")}function mr(e,t){return e.byteLength<t&&ma(),e.read(t)}function br(e){const t=e.readUint8();return t===void 0&&ma(),t}function Me(e){if(typeof e=="number"&&(e=BigInt(e)),e<BigInt(0))throw new Error("Cannot leb encode negative values.");const t=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,r=new Yr(new ArrayBuffer(t),0);for(;;){const n=Number(e&BigInt(127));if(e/=BigInt(128),e===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function je(e){let t=BigInt(1),r=BigInt(0),n;do n=br(e),r+=BigInt(n&127).valueOf()*t,t*=BigInt(128);while(n>=128);return r}function He(e){typeof e=="number"&&(e=BigInt(e));const t=e<BigInt(0);t&&(e=-e-BigInt(1));const r=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,n=new Yr(new ArrayBuffer(r),0);for(;;){const a=i(e);if(e/=BigInt(128),t&&e===BigInt(0)&&(a&64)!==0||!t&&e===BigInt(0)&&(a&64)===0){n.write(new Uint8Array([a]));break}else n.write(new Uint8Array([a|128]))}function i(a){const u=a%BigInt(128);return Number(t?BigInt(128)-u-BigInt(1):u)}return n.buffer}function Zt(e){const t=new Uint8Array(e.buffer);let r=0;for(;r<t.byteLength;r++)if(t[r]<128){if((t[r]&64)===0)return je(e);break}const n=new Uint8Array(mr(e,r+1));let i=BigInt(0);for(let a=n.byteLength-1;a>=0;a--)i=i*BigInt(128)+BigInt(128-(n[a]&127)-1);return-i-BigInt(1)}function sf(e,t){if(BigInt(e)<BigInt(0))throw new Error("Cannot write negative values.");return ba(e,t)}function ba(e,t){e=BigInt(e);const r=new Yr(new ArrayBuffer(Math.min(1,t)),0);let n=0,i=BigInt(256),a=BigInt(0),u=Number(e%i);for(r.write(new Uint8Array([u]));++n<t;)e<0&&a===BigInt(0)&&u!==0&&(a=BigInt(1)),u=Number((e/i-a)%BigInt(256)),r.write(new Uint8Array([u])),i*=BigInt(256);return r.buffer}function _a(e,t){let r=BigInt(br(e)),n=BigInt(1),i=0;for(;++i<t;){n*=BigInt(256);const a=BigInt(br(e));r=r+n*a}return r}function of(e,t){let r=_a(e,t);const n=BigInt(2)**(BigInt(8)*BigInt(t-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function _s(e){const t=BigInt(e);if(e<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<t}const kn="DIDL",oo=400;function ln(e,t,r){return e.map((n,i)=>r(n,t[i]))}class af{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,r){const n=this._typs.length;this._idx.set(t.name,n),this._typs.push(r)}merge(t,r){const n=this._idx.get(t.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+t);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const t=Me(this._typs.length),r=Re(...this._typs);return Re(t,r)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return He(this._idx.get(t)||0)}}class cf{visitType(t,r){throw new Error("Not implemented")}visitPrimitive(t,r){return this.visitType(t,r)}visitEmpty(t,r){return this.visitPrimitive(t,r)}visitBool(t,r){return this.visitPrimitive(t,r)}visitNull(t,r){return this.visitPrimitive(t,r)}visitReserved(t,r){return this.visitPrimitive(t,r)}visitText(t,r){return this.visitPrimitive(t,r)}visitNumber(t,r){return this.visitPrimitive(t,r)}visitInt(t,r){return this.visitNumber(t,r)}visitNat(t,r){return this.visitNumber(t,r)}visitFloat(t,r){return this.visitPrimitive(t,r)}visitFixedInt(t,r){return this.visitNumber(t,r)}visitFixedNat(t,r){return this.visitNumber(t,r)}visitPrincipal(t,r){return this.visitPrimitive(t,r)}visitConstruct(t,r){return this.visitType(t,r)}visitVec(t,r,n){return this.visitConstruct(t,n)}visitOpt(t,r,n){return this.visitConstruct(t,n)}visitRecord(t,r,n){return this.visitConstruct(t,n)}visitTuple(t,r,n){const i=r.map((a,u)=>[`_${u}_`,a]);return this.visitRecord(t,i,n)}visitVariant(t,r,n){return this.visitConstruct(t,n)}visitRec(t,r,n){return this.visitConstruct(r,n)}visitFunc(t,r){return this.visitConstruct(t,r)}visitService(t,r){return this.visitConstruct(t,r)}}class mi{display(){return this.name}valueToString(t){return qe(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class ht extends mi{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class or extends mi{checkType(t){if(t instanceof Gt){const r=t.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class xa extends ht{accept(t,r){return t.visitEmpty(this,r)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return He(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class Ea extends mi{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,r){throw t.visitType(this,r)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,r){let n=r.decodeValue(t,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof Gt?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class va extends ht{accept(t,r){return t.visitBool(this,r)}covariant(t){if(typeof t=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return He(-2)}decodeValue(t,r){switch(this.checkType(r),br(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class si extends ht{accept(t,r){return t.visitNull(this,r)}covariant(t){if(t===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return He(-1)}decodeValue(t,r){return this.checkType(r),null}get name(){return"null"}}class jr extends ht{accept(t,r){return t.visitReserved(this,r)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return He(-16)}decodeValue(t,r){return r.name!==this.name&&r.decodeValue(t,r),null}get name(){return"reserved"}}class Ba extends ht{accept(t,r){return t.visitText(this,r)}covariant(t){if(typeof t=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=new TextEncoder().encode(t),n=Me(r.byteLength);return Re(n,r)}encodeType(){return He(-15)}decodeValue(t,r){this.checkType(r);const n=je(t),i=mr(t,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class Aa extends ht{accept(t,r){return t.visitInt(this,r)}covariant(t){if(typeof t=="bigint"||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return He(t)}encodeType(){return He(-4)}decodeValue(t,r){return this.checkType(r),Zt(t)}get name(){return"int"}valueToString(t){return t.toString()}}class Ta extends ht{accept(t,r){return t.visitNat(this,r)}covariant(t){if(typeof t=="bigint"&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return Me(t)}encodeType(){return He(-3)}decodeValue(t,r){return this.checkType(r),je(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class $s extends ht{constructor(t){if(super(),this._bits=t,t!==32&&t!==64)throw new Error("not a valid float type")}accept(t,r){return t.visitFloat(this,r)}covariant(t){if(typeof t=="number"||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,t,!0):n.setFloat64(0,t,!0),r}encodeType(){const t=this._bits===32?-13:-14;return He(t)}decodeValue(t,r){this.checkType(r);const n=mr(t,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class _r extends ht{constructor(t){super(),this._bits=t}accept(t,r){return t.visitFixedInt(this,r)}covariant(t){const r=_s(this._bits-1)*BigInt(-1),n=_s(this._bits-1)-BigInt(1);let i=!1;if(typeof t=="bigint")i=t>=r&&t<=n;else if(Number.isInteger(t)){const a=BigInt(t);i=a>=r&&a<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return ba(t,this._bits/8)}encodeType(){const t=Math.log2(this._bits)-3;return He(-9-t)}decodeValue(t,r){this.checkType(r);const n=of(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class rr extends ht{constructor(t){super(),this._bits=t}accept(t,r){return t.visitFixedNat(this,r)}covariant(t){const r=_s(this._bits);let n=!1;if(typeof t=="bigint"&&t>=BigInt(0)?n=t<r:Number.isInteger(t)&&t>=0?n=BigInt(t)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return sf(t,this._bits/8)}encodeType(){const t=Math.log2(this._bits)-3;return He(-5-t)}decodeValue(t,r){this.checkType(r);const n=_a(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class bi extends or{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof rr&&t._bits===8&&(this._blobOptimization=!0)}accept(t,r){return t.visitVec(this,this._type,r)}covariant(t){const r=this._type instanceof rr?this._type._bits:this._type instanceof _r?this._type._bits:0;if(ArrayBuffer.isView(t)&&r==t.BYTES_PER_ELEMENT*8||Array.isArray(t)&&t.every((n,i)=>{try{return this._type.covariant(n)}catch(a){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${a.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=Me(t.length);if(this._blobOptimization)return Re(r,new Uint8Array(t));if(ArrayBuffer.isView(t))return Re(r,new Uint8Array(t.buffer));const n=new Yr(new ArrayBuffer(r.byteLength+t.length),0);n.write(r);for(const i of t){const a=this._type.encodeValue(i);n.write(new Uint8Array(a))}return n.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const r=He(-19),n=this._type.encodeType(t);t.add(this,Re(r,n))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof bi))throw new Error("Not a vector type");const i=Number(je(t));if(this._type instanceof rr){if(this._type._bits==8)return new Uint8Array(t.read(i));if(this._type._bits==16)return new Uint16Array(t.read(i*2));if(this._type._bits==32)return new Uint32Array(t.read(i*4));if(this._type._bits==64)return new BigUint64Array(t.read(i*8))}if(this._type instanceof _r){if(this._type._bits==8)return new Int8Array(t.read(i));if(this._type._bits==16)return new Int16Array(t.read(i*2));if(this._type._bits==32)return new Int32Array(t.read(i*4));if(this._type._bits==64)return new BigInt64Array(t.read(i*8))}const a=[];for(let u=0;u<i;u++)a.push(this._type.decodeValue(t,n._type));return a}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class xr extends or{constructor(t){super(),this._type=t}accept(t,r){return t.visitOpt(this,this._type,r)}covariant(t){try{if(Array.isArray(t)&&(t.length===0||t.length===1&&this._type.covariant(t[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${qe(t)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){return t.length===0?new Uint8Array([0]):Re(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const r=He(-18),n=this._type.encodeType(t);t.add(this,Re(r,n))}decodeValue(t,r){if(r instanceof si)return[];if(r instanceof jr)return[];let n=r;if(r instanceof Gt){const i=r.getType();if(typeof i>"u")throw new Error("type mismatch with uninitialized type");n=i}if(n instanceof xr)switch(br(t)){case 0:return[];case 1:{const i=t.save();try{return[this._type.decodeValue(t,n._type)]}catch{return t.restore(i),n._type.decodeValue(t,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof si||this._type instanceof xr||this._type instanceof jr)return n.decodeValue(t,n),[];{const i=t.save();try{return[this._type.decodeValue(t,r)]}catch{return t.restore(i),n.decodeValue(t,r),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return t.length===0?"null":`opt ${this._type.valueToString(t[0])}`}}class _n extends or{constructor(t={}){super(),this._fields=Object.entries(t).sort((r,n)=>Bt(r[0])-Bt(n[0]))}accept(t,r){return t.visitRecord(this,this._fields,r)}tryAsTuple(){const t=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;t.push(i)}return t}covariant(t){if(typeof t=="object"&&this._fields.every(([r,n])=>{if(!t.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(t[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=this._fields.map(([i])=>t[i]),n=ln(this._fields,r,([,i],a)=>i.encodeValue(a));return Re(...n)}_buildTypeTableImpl(t){this._fields.forEach(([a,u])=>u.buildTypeTable(t));const r=He(-20),n=Me(this._fields.length),i=this._fields.map(([a,u])=>Re(Me(Bt(a)),u.encodeType(t)));t.add(this,Re(r,n,Re(...i)))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof _n))throw new Error("Not a record type");const i={};let a=0,u=0;for(;u<n._fields.length;){const[s,p]=n._fields[u];if(a>=this._fields.length){p.decodeValue(t,p),u++;continue}const[b,B]=this._fields[a],w=Bt(this._fields[a][0]),A=Bt(s);if(w===A)i[b]=B.decodeValue(t,p),a++,u++;else if(A>w)if(B instanceof xr||B instanceof jr)i[b]=[],a++;else throw new Error("Cannot find required field "+b);else p.decodeValue(t,p),u++}for(const[s,p]of this._fields.slice(a))if(p instanceof xr||p instanceof jr)i[s]=[];else throw new Error("Cannot find required field "+s);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(t){const r=this._fields.map(([i])=>t[i]);return`record {${ln(this._fields,r,([i,a],u)=>i+"="+a.valueToString(u)).join("; ")}}`}}class _i extends _n{constructor(t){const r={};t.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=t}accept(t,r){return t.visitTuple(this,this._components,r)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(t[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=ln(this._components,t,(n,i)=>n.encodeValue(i));return Re(...r)}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof _i))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[a,u]of n._components.entries())a>=this._components.length?u.decodeValue(t,u):i.push(this._components[a].decodeValue(t,u));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(t){return`record {${ln(this._components,t,(n,i)=>n.valueToString(i)).join("; ")}}`}}class xi extends or{constructor(t={}){super(),this._fields=Object.entries(t).sort((r,n)=>Bt(r[0])-Bt(n[0]))}accept(t,r){return t.visitVariant(this,this._fields,r)}covariant(t){if(typeof t=="object"&&Object.entries(t).length===1&&this._fields.every(([r,n])=>{try{return!t.hasOwnProperty(r)||n.covariant(t[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(t.hasOwnProperty(n)){const a=Me(r),u=i.encodeValue(t[n]);return Re(a,u)}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach(([,a])=>{a.buildTypeTable(t)});const r=He(-21),n=Me(this._fields.length),i=this._fields.map(([a,u])=>Re(Me(Bt(a)),u.encodeType(t)));t.add(this,Re(r,n,...i))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof xi))throw new Error("Not a variant type");const i=Number(je(t));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[a,u]=n._fields[i];for(const[s,p]of this._fields)if(Bt(a)===Bt(s)){const b=p.decodeValue(t,u);return{[s]:b}}throw new Error("Cannot find field hash "+a)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(t){for(const[r,n]of this._fields)if(t.hasOwnProperty(r)){const i=n.valueToString(t[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+t)}}class Gt extends or{constructor(){super(...arguments),this._id=Gt._counter++,this._type=void 0}accept(t,r){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,r)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}Gt._counter=0;function Gs(e){if(br(e)!==1)throw new Error("Cannot decode principal");const r=Number(je(e));return _e.fromUint8Array(new Uint8Array(mr(e,r)))}class Sa extends ht{accept(t,r){return t.visitPrincipal(this,r)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=t.toUint8Array(),n=Me(r.byteLength);return Re(new Uint8Array([1]),n,r)}encodeType(){return He(-24)}decodeValue(t,r){return this.checkType(r),Gs(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class Vs extends or{constructor(t,r,n=[]){super(),this.argTypes=t,this.retTypes=r,this.annotations=n}static argsToString(t,r){if(t.length!==r.length)throw new Error("arity mismatch");return"("+t.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(t,r){return t.visitFunc(this,r)}covariant(t){if(Array.isArray(t)&&t.length===2&&t[0]&&t[0]._isPrincipal&&typeof t[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue([t,r]){const n=t.toUint8Array(),i=Me(n.byteLength),a=Re(new Uint8Array([1]),i,n),u=new TextEncoder().encode(r),s=Me(u.byteLength);return Re(new Uint8Array([1]),a,s,u)}_buildTypeTableImpl(t){this.argTypes.forEach(b=>b.buildTypeTable(t)),this.retTypes.forEach(b=>b.buildTypeTable(t));const r=He(-22),n=Me(this.argTypes.length),i=Re(...this.argTypes.map(b=>b.encodeType(t))),a=Me(this.retTypes.length),u=Re(...this.retTypes.map(b=>b.encodeType(t))),s=Me(this.annotations.length),p=Re(...this.annotations.map(b=>this.encodeAnnotation(b)));t.add(this,Re(r,n,i,a,u,s,p))}decodeValue(t){if(br(t)!==1)throw new Error("Cannot decode function reference");const n=Gs(t),i=Number(je(t)),a=mr(t,i),s=new TextDecoder("utf8",{fatal:!0}).decode(a);return[n,s]}get name(){const t=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${t}) -> (${r})${n}`}valueToString([t,r]){return`func "${t.toText()}".${r}`}display(){const t=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${t}) → (${r})${n}`}encodeAnnotation(t){if(t==="query")return new Uint8Array([1]);if(t==="oneway")return new Uint8Array([2]);if(t==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Na extends or{constructor(t){super(),this._fields=Object.entries(t).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(t,r){return t.visitService(this,r)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${qe(t)}`)}encodeValue(t){const r=t.toUint8Array(),n=Me(r.length);return Re(new Uint8Array([1]),n,r)}_buildTypeTableImpl(t){this._fields.forEach(([a,u])=>u.buildTypeTable(t));const r=He(-23),n=Me(this._fields.length),i=this._fields.map(([a,u])=>{const s=new TextEncoder().encode(a),p=Me(s.length);return Re(p,s,u.encodeType(t))});t.add(this,Re(r,n,...i))}decodeValue(t){return Gs(t)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function qe(e){const t=JSON.stringify(e,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return t&&t.length>oo?t.substring(0,oo-3)+"...":t}function xs(e,t){if(t.length<e.length)throw Error("Wrong number of message arguments");const r=new af;e.forEach(p=>p.buildTypeTable(r));const n=new TextEncoder().encode(kn),i=r.encode(),a=Me(t.length),u=Re(...e.map(p=>p.encodeType(r))),s=Re(...ln(e,t,(p,b)=>{try{p.covariant(b)}catch(B){throw new Error(B.message+`

`)}return p.encodeValue(b)}));return Re(n,i,a,u,s)}function Ia(e,t){const r=new Yr(t);if(t.byteLength<kn.length)throw new Error("Message length smaller than magic number");const n=mr(r,kn.length),i=new TextDecoder().decode(n);if(i!==kn)throw new Error("Wrong magic number: "+JSON.stringify(i));function a(_){const y=[],$=Number(je(_));for(let j=0;j<$;j++){const Y=Number(Zt(_));switch(Y){case-18:case-19:{const ie=Number(Zt(_));y.push([Y,ie]);break}case-20:case-21:{const ie=[];let R=Number(je(_)),X;for(;R--;){const J=Number(je(_));if(J>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof X=="number"&&X>=J)throw new Error("field id collision or not sorted");X=J;const I=Number(Zt(_));ie.push([J,I])}y.push([Y,ie]);break}case-22:{const ie=[];let R=Number(je(_));for(;R--;)ie.push(Number(Zt(_)));const X=[];let J=Number(je(_));for(;J--;)X.push(Number(Zt(_)));const I=[];let O=Number(je(_));for(;O--;)switch(Number(je(_))){case 1:{I.push("query");break}case 2:{I.push("oneway");break}case 3:{I.push("composite_query");break}default:throw new Error("unknown annotation")}y.push([Y,[ie,X,I]]);break}case-23:{let ie=Number(je(_));const R=[];for(;ie--;){const X=Number(je(_)),J=new TextDecoder().decode(mr(_,X)),I=Zt(_);R.push([J,I])}y.push([Y,R]);break}default:throw new Error("Illegal op_code: "+Y)}}const V=[],z=Number(je(_));for(let j=0;j<z;j++)V.push(Number(Zt(_)));return[y,V]}const[u,s]=a(r);if(s.length<e.length)throw new Error("Wrong number of return values");const p=u.map(_=>Qa());function b(_){if(_<-24)throw new Error("future value not supported");if(_<0)switch(_){case-1:return Fa;case-2:return Oa;case-3:return Ma;case-4:return ka;case-5:return Ka;case-6:return ja;case-7:return za;case-8:return Wa;case-9:return $a;case-10:return Ga;case-11:return Va;case-12:return Ha;case-13:return Ca;case-14:return qa;case-15:return Pa;case-16:return Ua;case-17:return Ra;case-24:return Ya;default:throw new Error("Illegal op_code: "+_)}if(_>=u.length)throw new Error("type index out of range");return p[_]}function B(_){switch(_[0]){case-19:{const y=b(_[1]);return La(y)}case-18:{const y=b(_[1]);return Xa(y)}case-20:{const y={};for(const[z,j]of _[1]){const Y=`_${z}_`;y[Y]=b(j)}const $=Da(y),V=$.tryAsTuple();return Array.isArray(V)?Za(...V):$}case-21:{const y={};for(const[$,V]of _[1]){const z=`_${$}_`;y[z]=b(V)}return Ja(y)}case-22:{const[y,$,V]=_[1];return ec(y.map(z=>b(z)),$.map(z=>b(z)),V)}case-23:{const y={},$=_[1];for(const[V,z]of $){let j=b(z);if(j instanceof Gt&&(j=j.getType()),!(j instanceof Vs))throw new Error("Illegal service definition: services can only contain functions");y[V]=j}return tc(y)}default:throw new Error("Illegal op_code: "+_[0])}}u.forEach((_,y)=>{if(_[0]===-22){const $=B(_);p[y].fill($)}}),u.forEach((_,y)=>{if(_[0]!==-22){const $=B(_);p[y].fill($)}});const w=s.map(_=>b(_)),A=e.map((_,y)=>_.decodeValue(r,w[y]));for(let _=e.length;_<w.length;_++)w[_].decodeValue(r,w[_]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return A}const Ra=new xa,Ua=new jr,uf=new Ea,Oa=new va,Fa=new si,Pa=new Ba,ka=new Aa,Ma=new Ta,Ca=new $s(32),qa=new $s(64),$a=new _r(8),Ga=new _r(16),Va=new _r(32),Ha=new _r(64),Ka=new rr(8),ja=new rr(16),za=new rr(32),Wa=new rr(64),Ya=new Sa;function Za(...e){return new _i(e)}function La(e){return new bi(e)}function Xa(e){return new xr(e)}function Da(e){return new _n(e)}function Ja(e){return new xi(e)}function Qa(){return new Gt}function ec(e,t,r=[]){return new Vs(e,t,r)}function tc(e){return new Na(e)}const ff=Object.freeze(Object.defineProperty({__proto__:null,Bool:Oa,BoolClass:va,ConstructType:or,Empty:Ra,EmptyClass:xa,FixedIntClass:_r,FixedNatClass:rr,Float32:Ca,Float64:qa,FloatClass:$s,Func:ec,FuncClass:Vs,Int:ka,Int16:Ga,Int32:Va,Int64:Ha,Int8:$a,IntClass:Aa,Nat:Ma,Nat16:ja,Nat32:za,Nat64:Wa,Nat8:Ka,NatClass:Ta,Null:Fa,NullClass:si,Opt:Xa,OptClass:xr,PrimitiveType:ht,Principal:Ya,PrincipalClass:Sa,Rec:Qa,RecClass:Gt,Record:Da,RecordClass:_n,Reserved:Ua,ReservedClass:jr,Service:tc,ServiceClass:Na,Text:Pa,TextClass:Ba,Tuple:Za,TupleClass:_i,Type:mi,Unknown:uf,UnknownClass:Ea,Variant:Ja,VariantClass:xi,Vec:La,VecClass:bi,Visitor:cf,decode:Ia,encode:xs},Symbol.toStringTag,{value:"Module"}));var Vi={},Hi={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ao;function Ei(){return ao||(ao=1,function(e){var t=ua(),r=ks(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=j,e.INSPECT_MAX_BYTES=50;var i=2147483647;e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=a(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{var h=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(h,o),h.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(h){if(h>i)throw new RangeError('The value "'+h+'" is invalid for option "size"');var o=new Uint8Array(h);return Object.setPrototypeOf(o,s.prototype),o}function s(h,o,c){if(typeof h=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(h)}return p(h,o,c)}s.poolSize=8192;function p(h,o,c){if(typeof h=="string")return A(h,o);if(ArrayBuffer.isView(h))return y(h);if(h==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if(C(h,ArrayBuffer)||h&&C(h.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(C(h,SharedArrayBuffer)||h&&C(h.buffer,SharedArrayBuffer)))return $(h,o,c);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var m=h.valueOf&&h.valueOf();if(m!=null&&m!==h)return s.from(m,o,c);var E=V(h);if(E)return E;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return s.from(h[Symbol.toPrimitive]("string"),o,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}s.from=function(h,o,c){return p(h,o,c)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function b(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(h<0)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function B(h,o,c){return b(h),h<=0?u(h):o!==void 0?typeof c=="string"?u(h).fill(o,c):u(h).fill(o):u(h)}s.alloc=function(h,o,c){return B(h,o,c)};function w(h){return b(h),u(h<0?0:z(h)|0)}s.allocUnsafe=function(h){return w(h)},s.allocUnsafeSlow=function(h){return w(h)};function A(h,o){if((typeof o!="string"||o==="")&&(o="utf8"),!s.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var c=Y(h,o)|0,m=u(c),E=m.write(h,o);return E!==c&&(m=m.slice(0,E)),m}function _(h){for(var o=h.length<0?0:z(h.length)|0,c=u(o),m=0;m<o;m+=1)c[m]=h[m]&255;return c}function y(h){if(C(h,Uint8Array)){var o=new Uint8Array(h);return $(o.buffer,o.byteOffset,o.byteLength)}return _(h)}function $(h,o,c){if(o<0||h.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<o+(c||0))throw new RangeError('"length" is outside of buffer bounds');var m;return o===void 0&&c===void 0?m=new Uint8Array(h):c===void 0?m=new Uint8Array(h,o):m=new Uint8Array(h,o,c),Object.setPrototypeOf(m,s.prototype),m}function V(h){if(s.isBuffer(h)){var o=z(h.length)|0,c=u(o);return c.length===0||h.copy(c,0,0,o),c}if(h.length!==void 0)return typeof h.length!="number"||M(h.length)?u(0):_(h);if(h.type==="Buffer"&&Array.isArray(h.data))return _(h.data)}function z(h){if(h>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return h|0}function j(h){return+h!=h&&(h=0),s.alloc(+h)}s.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==s.prototype},s.compare=function(o,c){if(C(o,Uint8Array)&&(o=s.from(o,o.offset,o.byteLength)),C(c,Uint8Array)&&(c=s.from(c,c.offset,c.byteLength)),!s.isBuffer(o)||!s.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===c)return 0;for(var m=o.length,E=c.length,F=0,W=Math.min(m,E);F<W;++F)if(o[F]!==c[F]){m=o[F],E=c[F];break}return m<E?-1:E<m?1:0},s.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(o,c){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return s.alloc(0);var m;if(c===void 0)for(c=0,m=0;m<o.length;++m)c+=o[m].length;var E=s.allocUnsafe(c),F=0;for(m=0;m<o.length;++m){var W=o[m];if(C(W,Uint8Array))F+W.length>E.length?s.from(W).copy(E,F):Uint8Array.prototype.set.call(E,W,F);else if(s.isBuffer(W))W.copy(E,F);else throw new TypeError('"list" argument must be an Array of Buffers');F+=W.length}return E};function Y(h,o){if(s.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||C(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);var c=h.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&c===0)return 0;for(var E=!1;;)switch(o){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return ee(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return v(h).length;default:if(E)return m?-1:ee(h).length;o=(""+o).toLowerCase(),E=!0}}s.byteLength=Y;function ie(h,o,c){var m=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,o>>>=0,c<=o))return"";for(h||(h="utf8");;)switch(h){case"hex":return ue(this,o,c);case"utf8":case"utf-8":return T(this,o,c);case"ascii":return Q(this,o,c);case"latin1":case"binary":return re(this,o,c);case"base64":return d(this,o,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,o,c);default:if(m)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),m=!0}}s.prototype._isBuffer=!0;function R(h,o,c){var m=h[o];h[o]=h[c],h[c]=m}s.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<o;c+=2)R(this,c,c+1);return this},s.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<o;c+=4)R(this,c,c+3),R(this,c+1,c+2);return this},s.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<o;c+=8)R(this,c,c+7),R(this,c+1,c+6),R(this,c+2,c+5),R(this,c+3,c+4);return this},s.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?T(this,0,o):ie.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(o){if(!s.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:s.compare(this,o)===0},s.prototype.inspect=function(){var o="",c=e.INSPECT_MAX_BYTES;return o=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(o+=" ... "),"<Buffer "+o+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(o,c,m,E,F){if(C(o,Uint8Array)&&(o=s.from(o,o.offset,o.byteLength)),!s.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(c===void 0&&(c=0),m===void 0&&(m=o?o.length:0),E===void 0&&(E=0),F===void 0&&(F=this.length),c<0||m>o.length||E<0||F>this.length)throw new RangeError("out of range index");if(E>=F&&c>=m)return 0;if(E>=F)return-1;if(c>=m)return 1;if(c>>>=0,m>>>=0,E>>>=0,F>>>=0,this===o)return 0;for(var W=F-E,se=m-c,fe=Math.min(W,se),he=this.slice(E,F),be=o.slice(c,m),g=0;g<fe;++g)if(he[g]!==be[g]){W=he[g],se=be[g];break}return W<se?-1:se<W?1:0};function X(h,o,c,m,E){if(h.length===0)return-1;if(typeof c=="string"?(m=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,M(c)&&(c=E?0:h.length-1),c<0&&(c=h.length+c),c>=h.length){if(E)return-1;c=h.length-1}else if(c<0)if(E)c=0;else return-1;if(typeof o=="string"&&(o=s.from(o,m)),s.isBuffer(o))return o.length===0?-1:J(h,o,c,m,E);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?E?Uint8Array.prototype.indexOf.call(h,o,c):Uint8Array.prototype.lastIndexOf.call(h,o,c):J(h,[o],c,m,E);throw new TypeError("val must be string, number or Buffer")}function J(h,o,c,m,E){var F=1,W=h.length,se=o.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(h.length<2||o.length<2)return-1;F=2,W/=2,se/=2,c/=2}function fe(l,N){return F===1?l[N]:l.readUInt16BE(N*F)}var he;if(E){var be=-1;for(he=c;he<W;he++)if(fe(h,he)===fe(o,be===-1?0:he-be)){if(be===-1&&(be=he),he-be+1===se)return be*F}else be!==-1&&(he-=he-be),be=-1}else for(c+se>W&&(c=W-se),he=c;he>=0;he--){for(var g=!0,f=0;f<se;f++)if(fe(h,he+f)!==fe(o,f)){g=!1;break}if(g)return he}return-1}s.prototype.includes=function(o,c,m){return this.indexOf(o,c,m)!==-1},s.prototype.indexOf=function(o,c,m){return X(this,o,c,m,!0)},s.prototype.lastIndexOf=function(o,c,m){return X(this,o,c,m,!1)};function I(h,o,c,m){c=Number(c)||0;var E=h.length-c;m?(m=Number(m),m>E&&(m=E)):m=E;var F=o.length;m>F/2&&(m=F/2);for(var W=0;W<m;++W){var se=parseInt(o.substr(W*2,2),16);if(M(se))return W;h[c+W]=se}return W}function O(h,o,c,m){return U(ee(o,h.length-c),h,c,m)}function P(h,o,c,m){return U(ne(o),h,c,m)}function D(h,o,c,m){return U(v(o),h,c,m)}function te(h,o,c,m){return U(x(o,h.length-c),h,c,m)}s.prototype.write=function(o,c,m,E){if(c===void 0)E="utf8",m=this.length,c=0;else if(m===void 0&&typeof c=="string")E=c,m=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(m)?(m=m>>>0,E===void 0&&(E="utf8")):(E=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var F=this.length-c;if((m===void 0||m>F)&&(m=F),o.length>0&&(m<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");for(var W=!1;;)switch(E){case"hex":return I(this,o,c,m);case"utf8":case"utf-8":return O(this,o,c,m);case"ascii":case"latin1":case"binary":return P(this,o,c,m);case"base64":return D(this,o,c,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,o,c,m);default:if(W)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),W=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function d(h,o,c){return o===0&&c===h.length?t.fromByteArray(h):t.fromByteArray(h.slice(o,c))}function T(h,o,c){c=Math.min(h.length,c);for(var m=[],E=o;E<c;){var F=h[E],W=null,se=F>239?4:F>223?3:F>191?2:1;if(E+se<=c){var fe,he,be,g;switch(se){case 1:F<128&&(W=F);break;case 2:fe=h[E+1],(fe&192)===128&&(g=(F&31)<<6|fe&63,g>127&&(W=g));break;case 3:fe=h[E+1],he=h[E+2],(fe&192)===128&&(he&192)===128&&(g=(F&15)<<12|(fe&63)<<6|he&63,g>2047&&(g<55296||g>57343)&&(W=g));break;case 4:fe=h[E+1],he=h[E+2],be=h[E+3],(fe&192)===128&&(he&192)===128&&(be&192)===128&&(g=(F&15)<<18|(fe&63)<<12|(he&63)<<6|be&63,g>65535&&g<1114112&&(W=g))}}W===null?(W=65533,se=1):W>65535&&(W-=65536,m.push(W>>>10&1023|55296),W=56320|W&1023),m.push(W),E+=se}return K(m)}var k=4096;function K(h){var o=h.length;if(o<=k)return String.fromCharCode.apply(String,h);for(var c="",m=0;m<o;)c+=String.fromCharCode.apply(String,h.slice(m,m+=k));return c}function Q(h,o,c){var m="";c=Math.min(h.length,c);for(var E=o;E<c;++E)m+=String.fromCharCode(h[E]&127);return m}function re(h,o,c){var m="";c=Math.min(h.length,c);for(var E=o;E<c;++E)m+=String.fromCharCode(h[E]);return m}function ue(h,o,c){var m=h.length;(!o||o<0)&&(o=0),(!c||c<0||c>m)&&(c=m);for(var E="",F=o;F<c;++F)E+=G[h[F]];return E}function ye(h,o,c){for(var m=h.slice(o,c),E="",F=0;F<m.length-1;F+=2)E+=String.fromCharCode(m[F]+m[F+1]*256);return E}s.prototype.slice=function(o,c){var m=this.length;o=~~o,c=c===void 0?m:~~c,o<0?(o+=m,o<0&&(o=0)):o>m&&(o=m),c<0?(c+=m,c<0&&(c=0)):c>m&&(c=m),c<o&&(c=o);var E=this.subarray(o,c);return Object.setPrototypeOf(E,s.prototype),E};function oe(h,o,c){if(h%1!==0||h<0)throw new RangeError("offset is not uint");if(h+o>c)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(o,c,m){o=o>>>0,c=c>>>0,m||oe(o,c,this.length);for(var E=this[o],F=1,W=0;++W<c&&(F*=256);)E+=this[o+W]*F;return E},s.prototype.readUintBE=s.prototype.readUIntBE=function(o,c,m){o=o>>>0,c=c>>>0,m||oe(o,c,this.length);for(var E=this[o+--c],F=1;c>0&&(F*=256);)E+=this[o+--c]*F;return E},s.prototype.readUint8=s.prototype.readUInt8=function(o,c){return o=o>>>0,c||oe(o,1,this.length),this[o]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(o,c){return o=o>>>0,c||oe(o,2,this.length),this[o]|this[o+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(o,c){return o=o>>>0,c||oe(o,2,this.length),this[o]<<8|this[o+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},s.prototype.readIntLE=function(o,c,m){o=o>>>0,c=c>>>0,m||oe(o,c,this.length);for(var E=this[o],F=1,W=0;++W<c&&(F*=256);)E+=this[o+W]*F;return F*=128,E>=F&&(E-=Math.pow(2,8*c)),E},s.prototype.readIntBE=function(o,c,m){o=o>>>0,c=c>>>0,m||oe(o,c,this.length);for(var E=c,F=1,W=this[o+--E];E>0&&(F*=256);)W+=this[o+--E]*F;return F*=128,W>=F&&(W-=Math.pow(2,8*c)),W},s.prototype.readInt8=function(o,c){return o=o>>>0,c||oe(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},s.prototype.readInt16LE=function(o,c){o=o>>>0,c||oe(o,2,this.length);var m=this[o]|this[o+1]<<8;return m&32768?m|4294901760:m},s.prototype.readInt16BE=function(o,c){o=o>>>0,c||oe(o,2,this.length);var m=this[o+1]|this[o]<<8;return m&32768?m|4294901760:m},s.prototype.readInt32LE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},s.prototype.readInt32BE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},s.prototype.readFloatLE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),r.read(this,o,!0,23,4)},s.prototype.readFloatBE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),r.read(this,o,!1,23,4)},s.prototype.readDoubleLE=function(o,c){return o=o>>>0,c||oe(o,8,this.length),r.read(this,o,!0,52,8)},s.prototype.readDoubleBE=function(o,c){return o=o>>>0,c||oe(o,8,this.length),r.read(this,o,!1,52,8)};function le(h,o,c,m,E,F){if(!s.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>E||o<F)throw new RangeError('"value" argument is out of bounds');if(c+m>h.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(o,c,m,E){if(o=+o,c=c>>>0,m=m>>>0,!E){var F=Math.pow(2,8*m)-1;le(this,o,c,m,F,0)}var W=1,se=0;for(this[c]=o&255;++se<m&&(W*=256);)this[c+se]=o/W&255;return c+m},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(o,c,m,E){if(o=+o,c=c>>>0,m=m>>>0,!E){var F=Math.pow(2,8*m)-1;le(this,o,c,m,F,0)}var W=m-1,se=1;for(this[c+W]=o&255;--W>=0&&(se*=256);)this[c+W]=o/se&255;return c+m},s.prototype.writeUint8=s.prototype.writeUInt8=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,1,255,0),this[c]=o&255,c+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,2,65535,0),this[c]=o&255,this[c+1]=o>>>8,c+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,2,65535,0),this[c]=o>>>8,this[c+1]=o&255,c+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,4,4294967295,0),this[c+3]=o>>>24,this[c+2]=o>>>16,this[c+1]=o>>>8,this[c]=o&255,c+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,4,4294967295,0),this[c]=o>>>24,this[c+1]=o>>>16,this[c+2]=o>>>8,this[c+3]=o&255,c+4},s.prototype.writeIntLE=function(o,c,m,E){if(o=+o,c=c>>>0,!E){var F=Math.pow(2,8*m-1);le(this,o,c,m,F-1,-F)}var W=0,se=1,fe=0;for(this[c]=o&255;++W<m&&(se*=256);)o<0&&fe===0&&this[c+W-1]!==0&&(fe=1),this[c+W]=(o/se>>0)-fe&255;return c+m},s.prototype.writeIntBE=function(o,c,m,E){if(o=+o,c=c>>>0,!E){var F=Math.pow(2,8*m-1);le(this,o,c,m,F-1,-F)}var W=m-1,se=1,fe=0;for(this[c+W]=o&255;--W>=0&&(se*=256);)o<0&&fe===0&&this[c+W+1]!==0&&(fe=1),this[c+W]=(o/se>>0)-fe&255;return c+m},s.prototype.writeInt8=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,1,127,-128),o<0&&(o=255+o+1),this[c]=o&255,c+1},s.prototype.writeInt16LE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,2,32767,-32768),this[c]=o&255,this[c+1]=o>>>8,c+2},s.prototype.writeInt16BE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,2,32767,-32768),this[c]=o>>>8,this[c+1]=o&255,c+2},s.prototype.writeInt32LE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,4,2147483647,-2147483648),this[c]=o&255,this[c+1]=o>>>8,this[c+2]=o>>>16,this[c+3]=o>>>24,c+4},s.prototype.writeInt32BE=function(o,c,m){return o=+o,c=c>>>0,m||le(this,o,c,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[c]=o>>>24,this[c+1]=o>>>16,this[c+2]=o>>>8,this[c+3]=o&255,c+4};function Ne(h,o,c,m,E,F){if(c+m>h.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function S(h,o,c,m,E){return o=+o,c=c>>>0,E||Ne(h,o,c,4),r.write(h,o,c,m,23,4),c+4}s.prototype.writeFloatLE=function(o,c,m){return S(this,o,c,!0,m)},s.prototype.writeFloatBE=function(o,c,m){return S(this,o,c,!1,m)};function Be(h,o,c,m,E){return o=+o,c=c>>>0,E||Ne(h,o,c,8),r.write(h,o,c,m,52,8),c+8}s.prototype.writeDoubleLE=function(o,c,m){return Be(this,o,c,!0,m)},s.prototype.writeDoubleBE=function(o,c,m){return Be(this,o,c,!1,m)},s.prototype.copy=function(o,c,m,E){if(!s.isBuffer(o))throw new TypeError("argument should be a Buffer");if(m||(m=0),!E&&E!==0&&(E=this.length),c>=o.length&&(c=o.length),c||(c=0),E>0&&E<m&&(E=m),E===m||o.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),o.length-c<E-m&&(E=o.length-c+m);var F=E-m;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(c,m,E):Uint8Array.prototype.set.call(o,this.subarray(m,E),c),F},s.prototype.fill=function(o,c,m,E){if(typeof o=="string"){if(typeof c=="string"?(E=c,c=0,m=this.length):typeof m=="string"&&(E=m,m=this.length),E!==void 0&&typeof E!="string")throw new TypeError("encoding must be a string");if(typeof E=="string"&&!s.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(o.length===1){var F=o.charCodeAt(0);(E==="utf8"&&F<128||E==="latin1")&&(o=F)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(c<0||this.length<c||this.length<m)throw new RangeError("Out of range index");if(m<=c)return this;c=c>>>0,m=m===void 0?this.length:m>>>0,o||(o=0);var W;if(typeof o=="number")for(W=c;W<m;++W)this[W]=o;else{var se=s.isBuffer(o)?o:s.from(o,E),fe=se.length;if(fe===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(W=0;W<m-c;++W)this[W+c]=se[W%fe]}return this};var Ie=/[^+/0-9A-Za-z-_]/g;function ae(h){if(h=h.split("=")[0],h=h.trim().replace(Ie,""),h.length<2)return"";for(;h.length%4!==0;)h=h+"=";return h}function ee(h,o){o=o||1/0;for(var c,m=h.length,E=null,F=[],W=0;W<m;++W){if(c=h.charCodeAt(W),c>55295&&c<57344){if(!E){if(c>56319){(o-=3)>-1&&F.push(239,191,189);continue}else if(W+1===m){(o-=3)>-1&&F.push(239,191,189);continue}E=c;continue}if(c<56320){(o-=3)>-1&&F.push(239,191,189),E=c;continue}c=(E-55296<<10|c-56320)+65536}else E&&(o-=3)>-1&&F.push(239,191,189);if(E=null,c<128){if((o-=1)<0)break;F.push(c)}else if(c<2048){if((o-=2)<0)break;F.push(c>>6|192,c&63|128)}else if(c<65536){if((o-=3)<0)break;F.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((o-=4)<0)break;F.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return F}function ne(h){for(var o=[],c=0;c<h.length;++c)o.push(h.charCodeAt(c)&255);return o}function x(h,o){for(var c,m,E,F=[],W=0;W<h.length&&!((o-=2)<0);++W)c=h.charCodeAt(W),m=c>>8,E=c%256,F.push(E),F.push(m);return F}function v(h){return t.toByteArray(ae(h))}function U(h,o,c,m){for(var E=0;E<m&&!(E+c>=o.length||E>=h.length);++E)o[E+c]=h[E];return E}function C(h,o){return h instanceof o||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===o.name}function M(h){return h!==h}var G=function(){for(var h="0123456789abcdef",o=new Array(256),c=0;c<16;++c)for(var m=c*16,E=0;E<16;++E)o[m+E]=h[c]+h[E];return o}()}(Hi)),Hi}var Mn={exports:{}},lf=Mn.exports,co;function vi(){return co||(co=1,function(e){(function(t){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,a=Math.floor,u="[BigNumber Error] ",s=u+"Number primitive has more than 15 significant digits: ",p=1e14,b=14,B=9007199254740991,w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],A=1e7,_=1e9;function y(X){var J,I,O,P=S.prototype={constructor:S,toString:null,valueOf:null},D=new S(1),te=20,d=4,T=-7,k=21,K=-1e7,Q=1e7,re=!1,ue=1,ye=0,oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},le="0123456789abcdefghijklmnopqrstuvwxyz",Ne=!0;function S(x,v){var U,C,M,G,h,o,c,m,E=this;if(!(E instanceof S))return new S(x,v);if(v==null){if(x&&x._isBigNumber===!0){E.s=x.s,!x.c||x.e>Q?E.c=E.e=null:x.e<K?E.c=[E.e=0]:(E.e=x.e,E.c=x.c.slice());return}if((o=typeof x=="number")&&x*0==0){if(E.s=1/x<0?(x=-x,-1):1,x===~~x){for(G=0,h=x;h>=10;h/=10,G++);G>Q?E.c=E.e=null:(E.e=G,E.c=[x]);return}m=String(x)}else{if(!n.test(m=String(x)))return O(E,m,o);E.s=m.charCodeAt(0)==45?(m=m.slice(1),-1):1}(G=m.indexOf("."))>-1&&(m=m.replace(".","")),(h=m.search(/e/i))>0?(G<0&&(G=h),G+=+m.slice(h+1),m=m.substring(0,h)):G<0&&(G=m.length)}else{if(j(v,2,le.length,"Base"),v==10&&Ne)return E=new S(x),ee(E,te+E.e+1,d);if(m=String(x),o=typeof x=="number"){if(x*0!=0)return O(E,m,o,v);if(E.s=1/x<0?(m=m.slice(1),-1):1,S.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(s+x)}else E.s=m.charCodeAt(0)===45?(m=m.slice(1),-1):1;for(U=le.slice(0,v),G=h=0,c=m.length;h<c;h++)if(U.indexOf(C=m.charAt(h))<0){if(C=="."){if(h>G){G=c;continue}}else if(!M&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){M=!0,h=-1,G=0;continue}return O(E,String(x),o,v)}o=!1,m=I(m,v,10,E.s),(G=m.indexOf("."))>-1?m=m.replace(".",""):G=m.length}for(h=0;m.charCodeAt(h)===48;h++);for(c=m.length;m.charCodeAt(--c)===48;);if(m=m.slice(h,++c)){if(c-=h,o&&S.DEBUG&&c>15&&(x>B||x!==a(x)))throw Error(s+E.s*x);if((G=G-h-1)>Q)E.c=E.e=null;else if(G<K)E.c=[E.e=0];else{if(E.e=G,E.c=[],h=(G+1)%b,G<0&&(h+=b),h<c){for(h&&E.c.push(+m.slice(0,h)),c-=b;h<c;)E.c.push(+m.slice(h,h+=b));h=b-(m=m.slice(h)).length}else h-=c;for(;h--;m+="0");E.c.push(+m)}}else E.c=[E.e=0]}S.clone=y,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(x){var v,U;if(x!=null)if(typeof x=="object"){if(x.hasOwnProperty(v="DECIMAL_PLACES")&&(U=x[v],j(U,0,_,v),te=U),x.hasOwnProperty(v="ROUNDING_MODE")&&(U=x[v],j(U,0,8,v),d=U),x.hasOwnProperty(v="EXPONENTIAL_AT")&&(U=x[v],U&&U.pop?(j(U[0],-_,0,v),j(U[1],0,_,v),T=U[0],k=U[1]):(j(U,-_,_,v),T=-(k=U<0?-U:U))),x.hasOwnProperty(v="RANGE"))if(U=x[v],U&&U.pop)j(U[0],-_,-1,v),j(U[1],1,_,v),K=U[0],Q=U[1];else if(j(U,-_,_,v),U)K=-(Q=U<0?-U:U);else throw Error(u+v+" cannot be zero: "+U);if(x.hasOwnProperty(v="CRYPTO"))if(U=x[v],U===!!U)if(U)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))re=U;else throw re=!U,Error(u+"crypto unavailable");else re=U;else throw Error(u+v+" not true or false: "+U);if(x.hasOwnProperty(v="MODULO_MODE")&&(U=x[v],j(U,0,9,v),ue=U),x.hasOwnProperty(v="POW_PRECISION")&&(U=x[v],j(U,0,_,v),ye=U),x.hasOwnProperty(v="FORMAT"))if(U=x[v],typeof U=="object")oe=U;else throw Error(u+v+" not an object: "+U);if(x.hasOwnProperty(v="ALPHABET"))if(U=x[v],typeof U=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(U))Ne=U.slice(0,10)=="0123456789",le=U;else throw Error(u+v+" invalid: "+U)}else throw Error(u+"Object expected: "+x);return{DECIMAL_PLACES:te,ROUNDING_MODE:d,EXPONENTIAL_AT:[T,k],RANGE:[K,Q],CRYPTO:re,MODULO_MODE:ue,POW_PRECISION:ye,FORMAT:oe,ALPHABET:le}},S.isBigNumber=function(x){if(!x||x._isBigNumber!==!0)return!1;if(!S.DEBUG)return!0;var v,U,C=x.c,M=x.e,G=x.s;e:if({}.toString.call(C)=="[object Array]"){if((G===1||G===-1)&&M>=-_&&M<=_&&M===a(M)){if(C[0]===0){if(M===0&&C.length===1)return!0;break e}if(v=(M+1)%b,v<1&&(v+=b),String(C[0]).length==v){for(v=0;v<C.length;v++)if(U=C[v],U<0||U>=p||U!==a(U))break e;if(U!==0)return!0}}}else if(C===null&&M===null&&(G===null||G===1||G===-1))return!0;throw Error(u+"Invalid BigNumber: "+x)},S.maximum=S.max=function(){return Ie(arguments,-1)},S.minimum=S.min=function(){return Ie(arguments,1)},S.random=function(){var x=9007199254740992,v=Math.random()*x&2097151?function(){return a(Math.random()*x)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(U){var C,M,G,h,o,c=0,m=[],E=new S(D);if(U==null?U=te:j(U,0,_),h=i(U/b),re)if(crypto.getRandomValues){for(C=crypto.getRandomValues(new Uint32Array(h*=2));c<h;)o=C[c]*131072+(C[c+1]>>>11),o>=9e15?(M=crypto.getRandomValues(new Uint32Array(2)),C[c]=M[0],C[c+1]=M[1]):(m.push(o%1e14),c+=2);c=h/2}else if(crypto.randomBytes){for(C=crypto.randomBytes(h*=7);c<h;)o=(C[c]&31)*281474976710656+C[c+1]*1099511627776+C[c+2]*4294967296+C[c+3]*16777216+(C[c+4]<<16)+(C[c+5]<<8)+C[c+6],o>=9e15?crypto.randomBytes(7).copy(C,c):(m.push(o%1e14),c+=7);c=h/7}else throw re=!1,Error(u+"crypto unavailable");if(!re)for(;c<h;)o=v(),o<9e15&&(m[c++]=o%1e14);for(h=m[--c],U%=b,h&&U&&(o=w[b-U],m[c]=a(h/o)*o);m[c]===0;m.pop(),c--);if(c<0)m=[G=0];else{for(G=-1;m[0]===0;m.splice(0,1),G-=b);for(c=1,o=m[0];o>=10;o/=10,c++);c<b&&(G-=b-c)}return E.e=G,E.c=m,E}}(),S.sum=function(){for(var x=1,v=arguments,U=new S(v[0]);x<v.length;)U=U.plus(v[x++]);return U},I=function(){var x="0123456789";function v(U,C,M,G){for(var h,o=[0],c,m=0,E=U.length;m<E;){for(c=o.length;c--;o[c]*=C);for(o[0]+=G.indexOf(U.charAt(m++)),h=0;h<o.length;h++)o[h]>M-1&&(o[h+1]==null&&(o[h+1]=0),o[h+1]+=o[h]/M|0,o[h]%=M)}return o.reverse()}return function(U,C,M,G,h){var o,c,m,E,F,W,se,fe,he=U.indexOf("."),be=te,g=d;for(he>=0&&(E=ye,ye=0,U=U.replace(".",""),fe=new S(C),W=fe.pow(U.length-he),ye=E,fe.c=v(R(V(W.c),W.e,"0"),10,M,x),fe.e=fe.c.length),se=v(U,C,M,h?(o=le,x):(o=x,le)),m=E=se.length;se[--E]==0;se.pop());if(!se[0])return o.charAt(0);if(he<0?--m:(W.c=se,W.e=m,W.s=G,W=J(W,fe,be,g,M),se=W.c,F=W.r,m=W.e),c=m+be+1,he=se[c],E=M/2,F=F||c<0||se[c+1]!=null,F=g<4?(he!=null||F)&&(g==0||g==(W.s<0?3:2)):he>E||he==E&&(g==4||F||g==6&&se[c-1]&1||g==(W.s<0?8:7)),c<1||!se[0])U=F?R(o.charAt(1),-be,o.charAt(0)):o.charAt(0);else{if(se.length=c,F)for(--M;++se[--c]>M;)se[c]=0,c||(++m,se=[1].concat(se));for(E=se.length;!se[--E];);for(he=0,U="";he<=E;U+=o.charAt(se[he++]));U=R(U,m,o.charAt(0))}return U}}(),J=function(){function x(C,M,G){var h,o,c,m,E=0,F=C.length,W=M%A,se=M/A|0;for(C=C.slice();F--;)c=C[F]%A,m=C[F]/A|0,h=se*c+m*W,o=W*c+h%A*A+E,E=(o/G|0)+(h/A|0)+se*m,C[F]=o%G;return E&&(C=[E].concat(C)),C}function v(C,M,G,h){var o,c;if(G!=h)c=G>h?1:-1;else for(o=c=0;o<G;o++)if(C[o]!=M[o]){c=C[o]>M[o]?1:-1;break}return c}function U(C,M,G,h){for(var o=0;G--;)C[G]-=o,o=C[G]<M[G]?1:0,C[G]=o*h+C[G]-M[G];for(;!C[0]&&C.length>1;C.splice(0,1));}return function(C,M,G,h,o){var c,m,E,F,W,se,fe,he,be,g,f,l,N,H,L,Z,we,xe=C.s==M.s?1:-1,me=C.c,ge=M.c;if(!me||!me[0]||!ge||!ge[0])return new S(!C.s||!M.s||(me?ge&&me[0]==ge[0]:!ge)?NaN:me&&me[0]==0||!ge?xe*0:xe/0);for(he=new S(xe),be=he.c=[],m=C.e-M.e,xe=G+m+1,o||(o=p,m=$(C.e/b)-$(M.e/b),xe=xe/b|0),E=0;ge[E]==(me[E]||0);E++);if(ge[E]>(me[E]||0)&&m--,xe<0)be.push(1),F=!0;else{for(H=me.length,Z=ge.length,E=0,xe+=2,W=a(o/(ge[0]+1)),W>1&&(ge=x(ge,W,o),me=x(me,W,o),Z=ge.length,H=me.length),N=Z,g=me.slice(0,Z),f=g.length;f<Z;g[f++]=0);we=ge.slice(),we=[0].concat(we),L=ge[0],ge[1]>=o/2&&L++;do{if(W=0,c=v(ge,g,Z,f),c<0){if(l=g[0],Z!=f&&(l=l*o+(g[1]||0)),W=a(l/L),W>1)for(W>=o&&(W=o-1),se=x(ge,W,o),fe=se.length,f=g.length;v(se,g,fe,f)==1;)W--,U(se,Z<fe?we:ge,fe,o),fe=se.length,c=1;else W==0&&(c=W=1),se=ge.slice(),fe=se.length;if(fe<f&&(se=[0].concat(se)),U(g,se,f,o),f=g.length,c==-1)for(;v(ge,g,Z,f)<1;)W++,U(g,Z<f?we:ge,f,o),f=g.length}else c===0&&(W++,g=[0]);be[E++]=W,g[0]?g[f++]=me[N]||0:(g=[me[N]],f=1)}while((N++<H||g[0]!=null)&&xe--);F=g[0]!=null,be[0]||be.splice(0,1)}if(o==p){for(E=1,xe=be[0];xe>=10;xe/=10,E++);ee(he,G+(he.e=E+m*b-1)+1,h,F)}else he.e=m,he.r=+F;return he}}();function Be(x,v,U,C){var M,G,h,o,c;if(U==null?U=d:j(U,0,8),!x.c)return x.toString();if(M=x.c[0],h=x.e,v==null)c=V(x.c),c=C==1||C==2&&(h<=T||h>=k)?ie(c,h):R(c,h,"0");else if(x=ee(new S(x),v,U),G=x.e,c=V(x.c),o=c.length,C==1||C==2&&(v<=G||G<=T)){for(;o<v;c+="0",o++);c=ie(c,G)}else if(v-=h,c=R(c,G,"0"),G+1>o){if(--v>0)for(c+=".";v--;c+="0");}else if(v+=G-o,v>0)for(G+1==o&&(c+=".");v--;c+="0");return x.s<0&&M?"-"+c:c}function Ie(x,v){for(var U,C,M=1,G=new S(x[0]);M<x.length;M++)C=new S(x[M]),(!C.s||(U=z(G,C))===v||U===0&&G.s===v)&&(G=C);return G}function ae(x,v,U){for(var C=1,M=v.length;!v[--M];v.pop());for(M=v[0];M>=10;M/=10,C++);return(U=C+U*b-1)>Q?x.c=x.e=null:U<K?x.c=[x.e=0]:(x.e=U,x.c=v),x}O=function(){var x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,v=/^([^.]+)\.$/,U=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,M=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(G,h,o,c){var m,E=o?h:h.replace(M,"");if(C.test(E))G.s=isNaN(E)?null:E<0?-1:1;else{if(!o&&(E=E.replace(x,function(F,W,se){return m=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!c||c==m?W:F}),c&&(m=c,E=E.replace(v,"$1").replace(U,"0.$1")),h!=E))return new S(E,m);if(S.DEBUG)throw Error(u+"Not a"+(c?" base "+c:"")+" number: "+h);G.s=null}G.c=G.e=null}}();function ee(x,v,U,C){var M,G,h,o,c,m,E,F=x.c,W=w;if(F){e:{for(M=1,o=F[0];o>=10;o/=10,M++);if(G=v-M,G<0)G+=b,h=v,c=F[m=0],E=a(c/W[M-h-1]%10);else if(m=i((G+1)/b),m>=F.length)if(C){for(;F.length<=m;F.push(0));c=E=0,M=1,G%=b,h=G-b+1}else break e;else{for(c=o=F[m],M=1;o>=10;o/=10,M++);G%=b,h=G-b+M,E=h<0?0:a(c/W[M-h-1]%10)}if(C=C||v<0||F[m+1]!=null||(h<0?c:c%W[M-h-1]),C=U<4?(E||C)&&(U==0||U==(x.s<0?3:2)):E>5||E==5&&(U==4||C||U==6&&(G>0?h>0?c/W[M-h]:0:F[m-1])%10&1||U==(x.s<0?8:7)),v<1||!F[0])return F.length=0,C?(v-=x.e+1,F[0]=W[(b-v%b)%b],x.e=-v||0):F[0]=x.e=0,x;if(G==0?(F.length=m,o=1,m--):(F.length=m+1,o=W[b-G],F[m]=h>0?a(c/W[M-h]%W[h])*o:0),C)for(;;)if(m==0){for(G=1,h=F[0];h>=10;h/=10,G++);for(h=F[0]+=o,o=1;h>=10;h/=10,o++);G!=o&&(x.e++,F[0]==p&&(F[0]=1));break}else{if(F[m]+=o,F[m]!=p)break;F[m--]=0,o=1}for(G=F.length;F[--G]===0;F.pop());}x.e>Q?x.c=x.e=null:x.e<K&&(x.c=[x.e=0])}return x}function ne(x){var v,U=x.e;return U===null?x.toString():(v=V(x.c),v=U<=T||U>=k?ie(v,U):R(v,U,"0"),x.s<0?"-"+v:v)}return P.absoluteValue=P.abs=function(){var x=new S(this);return x.s<0&&(x.s=1),x},P.comparedTo=function(x,v){return z(this,new S(x,v))},P.decimalPlaces=P.dp=function(x,v){var U,C,M,G=this;if(x!=null)return j(x,0,_),v==null?v=d:j(v,0,8),ee(new S(G),x+G.e+1,v);if(!(U=G.c))return null;if(C=((M=U.length-1)-$(this.e/b))*b,M=U[M])for(;M%10==0;M/=10,C--);return C<0&&(C=0),C},P.dividedBy=P.div=function(x,v){return J(this,new S(x,v),te,d)},P.dividedToIntegerBy=P.idiv=function(x,v){return J(this,new S(x,v),0,1)},P.exponentiatedBy=P.pow=function(x,v){var U,C,M,G,h,o,c,m,E,F=this;if(x=new S(x),x.c&&!x.isInteger())throw Error(u+"Exponent not an integer: "+ne(x));if(v!=null&&(v=new S(v)),o=x.e>14,!F.c||!F.c[0]||F.c[0]==1&&!F.e&&F.c.length==1||!x.c||!x.c[0])return E=new S(Math.pow(+ne(F),o?x.s*(2-Y(x)):+ne(x))),v?E.mod(v):E;if(c=x.s<0,v){if(v.c?!v.c[0]:!v.s)return new S(NaN);C=!c&&F.isInteger()&&v.isInteger(),C&&(F=F.mod(v))}else{if(x.e>9&&(F.e>0||F.e<-1||(F.e==0?F.c[0]>1||o&&F.c[1]>=24e7:F.c[0]<8e13||o&&F.c[0]<=9999975e7)))return G=F.s<0&&Y(x)?-0:0,F.e>-1&&(G=1/G),new S(c?1/G:G);ye&&(G=i(ye/b+2))}for(o?(U=new S(.5),c&&(x.s=1),m=Y(x)):(M=Math.abs(+ne(x)),m=M%2),E=new S(D);;){if(m){if(E=E.times(F),!E.c)break;G?E.c.length>G&&(E.c.length=G):C&&(E=E.mod(v))}if(M){if(M=a(M/2),M===0)break;m=M%2}else if(x=x.times(U),ee(x,x.e+1,1),x.e>14)m=Y(x);else{if(M=+ne(x),M===0)break;m=M%2}F=F.times(F),G?F.c&&F.c.length>G&&(F.c.length=G):C&&(F=F.mod(v))}return C?E:(c&&(E=D.div(E)),v?E.mod(v):G?ee(E,ye,d,h):E)},P.integerValue=function(x){var v=new S(this);return x==null?x=d:j(x,0,8),ee(v,v.e+1,x)},P.isEqualTo=P.eq=function(x,v){return z(this,new S(x,v))===0},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(x,v){return z(this,new S(x,v))>0},P.isGreaterThanOrEqualTo=P.gte=function(x,v){return(v=z(this,new S(x,v)))===1||v===0},P.isInteger=function(){return!!this.c&&$(this.e/b)>this.c.length-2},P.isLessThan=P.lt=function(x,v){return z(this,new S(x,v))<0},P.isLessThanOrEqualTo=P.lte=function(x,v){return(v=z(this,new S(x,v)))===-1||v===0},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return this.s>0},P.isZero=function(){return!!this.c&&this.c[0]==0},P.minus=function(x,v){var U,C,M,G,h=this,o=h.s;if(x=new S(x,v),v=x.s,!o||!v)return new S(NaN);if(o!=v)return x.s=-v,h.plus(x);var c=h.e/b,m=x.e/b,E=h.c,F=x.c;if(!c||!m){if(!E||!F)return E?(x.s=-v,x):new S(F?h:NaN);if(!E[0]||!F[0])return F[0]?(x.s=-v,x):new S(E[0]?h:d==3?-0:0)}if(c=$(c),m=$(m),E=E.slice(),o=c-m){for((G=o<0)?(o=-o,M=E):(m=c,M=F),M.reverse(),v=o;v--;M.push(0));M.reverse()}else for(C=(G=(o=E.length)<(v=F.length))?o:v,o=v=0;v<C;v++)if(E[v]!=F[v]){G=E[v]<F[v];break}if(G&&(M=E,E=F,F=M,x.s=-x.s),v=(C=F.length)-(U=E.length),v>0)for(;v--;E[U++]=0);for(v=p-1;C>o;){if(E[--C]<F[C]){for(U=C;U&&!E[--U];E[U]=v);--E[U],E[C]+=p}E[C]-=F[C]}for(;E[0]==0;E.splice(0,1),--m);return E[0]?ae(x,E,m):(x.s=d==3?-1:1,x.c=[x.e=0],x)},P.modulo=P.mod=function(x,v){var U,C,M=this;return x=new S(x,v),!M.c||!x.s||x.c&&!x.c[0]?new S(NaN):!x.c||M.c&&!M.c[0]?new S(M):(ue==9?(C=x.s,x.s=1,U=J(M,x,0,3),x.s=C,U.s*=C):U=J(M,x,0,ue),x=M.minus(U.times(x)),!x.c[0]&&ue==1&&(x.s=M.s),x)},P.multipliedBy=P.times=function(x,v){var U,C,M,G,h,o,c,m,E,F,W,se,fe,he,be,g=this,f=g.c,l=(x=new S(x,v)).c;if(!f||!l||!f[0]||!l[0])return!g.s||!x.s||f&&!f[0]&&!l||l&&!l[0]&&!f?x.c=x.e=x.s=null:(x.s*=g.s,!f||!l?x.c=x.e=null:(x.c=[0],x.e=0)),x;for(C=$(g.e/b)+$(x.e/b),x.s*=g.s,c=f.length,F=l.length,c<F&&(fe=f,f=l,l=fe,M=c,c=F,F=M),M=c+F,fe=[];M--;fe.push(0));for(he=p,be=A,M=F;--M>=0;){for(U=0,W=l[M]%be,se=l[M]/be|0,h=c,G=M+h;G>M;)m=f[--h]%be,E=f[h]/be|0,o=se*m+E*W,m=W*m+o%be*be+fe[G]+U,U=(m/he|0)+(o/be|0)+se*E,fe[G--]=m%he;fe[G]=U}return U?++C:fe.splice(0,1),ae(x,fe,C)},P.negated=function(){var x=new S(this);return x.s=-x.s||null,x},P.plus=function(x,v){var U,C=this,M=C.s;if(x=new S(x,v),v=x.s,!M||!v)return new S(NaN);if(M!=v)return x.s=-v,C.minus(x);var G=C.e/b,h=x.e/b,o=C.c,c=x.c;if(!G||!h){if(!o||!c)return new S(M/0);if(!o[0]||!c[0])return c[0]?x:new S(o[0]?C:M*0)}if(G=$(G),h=$(h),o=o.slice(),M=G-h){for(M>0?(h=G,U=c):(M=-M,U=o),U.reverse();M--;U.push(0));U.reverse()}for(M=o.length,v=c.length,M-v<0&&(U=c,c=o,o=U,v=M),M=0;v;)M=(o[--v]=o[v]+c[v]+M)/p|0,o[v]=p===o[v]?0:o[v]%p;return M&&(o=[M].concat(o),++h),ae(x,o,h)},P.precision=P.sd=function(x,v){var U,C,M,G=this;if(x!=null&&x!==!!x)return j(x,1,_),v==null?v=d:j(v,0,8),ee(new S(G),x,v);if(!(U=G.c))return null;if(M=U.length-1,C=M*b+1,M=U[M]){for(;M%10==0;M/=10,C--);for(M=U[0];M>=10;M/=10,C++);}return x&&G.e+1>C&&(C=G.e+1),C},P.shiftedBy=function(x){return j(x,-B,B),this.times("1e"+x)},P.squareRoot=P.sqrt=function(){var x,v,U,C,M,G=this,h=G.c,o=G.s,c=G.e,m=te+4,E=new S("0.5");if(o!==1||!h||!h[0])return new S(!o||o<0&&(!h||h[0])?NaN:h?G:1/0);if(o=Math.sqrt(+ne(G)),o==0||o==1/0?(v=V(h),(v.length+c)%2==0&&(v+="0"),o=Math.sqrt(+v),c=$((c+1)/2)-(c<0||c%2),o==1/0?v="5e"+c:(v=o.toExponential(),v=v.slice(0,v.indexOf("e")+1)+c),U=new S(v)):U=new S(o+""),U.c[0]){for(c=U.e,o=c+m,o<3&&(o=0);;)if(M=U,U=E.times(M.plus(J(G,M,m,1))),V(M.c).slice(0,o)===(v=V(U.c)).slice(0,o))if(U.e<c&&--o,v=v.slice(o-3,o+1),v=="9999"||!C&&v=="4999"){if(!C&&(ee(M,M.e+te+2,0),M.times(M).eq(G))){U=M;break}m+=4,o+=4,C=1}else{(!+v||!+v.slice(1)&&v.charAt(0)=="5")&&(ee(U,U.e+te+2,1),x=!U.times(U).eq(G));break}}return ee(U,U.e+te+1,d,x)},P.toExponential=function(x,v){return x!=null&&(j(x,0,_),x++),Be(this,x,v,1)},P.toFixed=function(x,v){return x!=null&&(j(x,0,_),x=x+this.e+1),Be(this,x,v)},P.toFormat=function(x,v,U){var C,M=this;if(U==null)x!=null&&v&&typeof v=="object"?(U=v,v=null):x&&typeof x=="object"?(U=x,x=v=null):U=oe;else if(typeof U!="object")throw Error(u+"Argument not an object: "+U);if(C=M.toFixed(x,v),M.c){var G,h=C.split("."),o=+U.groupSize,c=+U.secondaryGroupSize,m=U.groupSeparator||"",E=h[0],F=h[1],W=M.s<0,se=W?E.slice(1):E,fe=se.length;if(c&&(G=o,o=c,c=G,fe-=G),o>0&&fe>0){for(G=fe%o||o,E=se.substr(0,G);G<fe;G+=o)E+=m+se.substr(G,o);c>0&&(E+=m+se.slice(G)),W&&(E="-"+E)}C=F?E+(U.decimalSeparator||"")+((c=+U.fractionGroupSize)?F.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(U.fractionGroupSeparator||"")):F):E}return(U.prefix||"")+C+(U.suffix||"")},P.toFraction=function(x){var v,U,C,M,G,h,o,c,m,E,F,W,se=this,fe=se.c;if(x!=null&&(o=new S(x),!o.isInteger()&&(o.c||o.s!==1)||o.lt(D)))throw Error(u+"Argument "+(o.isInteger()?"out of range: ":"not an integer: ")+ne(o));if(!fe)return new S(se);for(v=new S(D),m=U=new S(D),C=c=new S(D),W=V(fe),G=v.e=W.length-se.e-1,v.c[0]=w[(h=G%b)<0?b+h:h],x=!x||o.comparedTo(v)>0?G>0?v:m:o,h=Q,Q=1/0,o=new S(W),c.c[0]=0;E=J(o,v,0,1),M=U.plus(E.times(C)),M.comparedTo(x)!=1;)U=C,C=M,m=c.plus(E.times(M=m)),c=M,v=o.minus(E.times(M=v)),o=M;return M=J(x.minus(U),C,0,1),c=c.plus(M.times(m)),U=U.plus(M.times(C)),c.s=m.s=se.s,G=G*2,F=J(m,C,G,d).minus(se).abs().comparedTo(J(c,U,G,d).minus(se).abs())<1?[m,C]:[c,U],Q=h,F},P.toNumber=function(){return+ne(this)},P.toPrecision=function(x,v){return x!=null&&j(x,1,_),Be(this,x,v,2)},P.toString=function(x){var v,U=this,C=U.s,M=U.e;return M===null?C?(v="Infinity",C<0&&(v="-"+v)):v="NaN":(x==null?v=M<=T||M>=k?ie(V(U.c),M):R(V(U.c),M,"0"):x===10&&Ne?(U=ee(new S(U),te+M+1,d),v=R(V(U.c),U.e,"0")):(j(x,2,le.length,"Base"),v=I(R(V(U.c),M,"0"),10,x,C,!0)),C<0&&U.c[0]&&(v="-"+v)),v},P.valueOf=P.toJSON=function(){return ne(this)},P._isBigNumber=!0,X!=null&&S.set(X),S}function $(X){var J=X|0;return X>0||X===J?J:J-1}function V(X){for(var J,I,O=1,P=X.length,D=X[0]+"";O<P;){for(J=X[O++]+"",I=b-J.length;I--;J="0"+J);D+=J}for(P=D.length;D.charCodeAt(--P)===48;);return D.slice(0,P+1||1)}function z(X,J){var I,O,P=X.c,D=J.c,te=X.s,d=J.s,T=X.e,k=J.e;if(!te||!d)return null;if(I=P&&!P[0],O=D&&!D[0],I||O)return I?O?0:-d:te;if(te!=d)return te;if(I=te<0,O=T==k,!P||!D)return O?0:!P^I?1:-1;if(!O)return T>k^I?1:-1;for(d=(T=P.length)<(k=D.length)?T:k,te=0;te<d;te++)if(P[te]!=D[te])return P[te]>D[te]^I?1:-1;return T==k?0:T>k^I?1:-1}function j(X,J,I,O){if(X<J||X>I||X!==a(X))throw Error(u+(O||"Argument")+(typeof X=="number"?X<J||X>I?" out of range: ":" not an integer: ":" not a primitive number: ")+String(X))}function Y(X){var J=X.c.length-1;return $(X.e/b)==J&&X.c[J]%2!=0}function ie(X,J){return(X.length>1?X.charAt(0)+"."+X.slice(1):X)+(J<0?"e":"e+")+J}function R(X,J,I){var O,P;if(J<0){for(P=I+".";++J;P+=I);X=P+X}else if(O=X.length,++J>O){for(P=I,J-=O;--J;P+=I);X+=P}else J<O&&(X=X.slice(0,J)+"."+X.slice(J));return X}r=y(),r.default=r.BigNumber=r,e.exports?e.exports=r:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=r)})(lf)}(Mn)),Mn.exports}var Ki,uo;function hf(){return uo||(uo=1,Ki=function(t,r,n){var i=new t.Uint8Array(n),a=r.pushInt,u=r.pushInt32,s=r.pushInt32Neg,p=r.pushInt64,b=r.pushInt64Neg,B=r.pushFloat,w=r.pushFloatSingle,A=r.pushFloatDouble,_=r.pushTrue,y=r.pushFalse,$=r.pushUndefined,V=r.pushNull,z=r.pushInfinity,j=r.pushInfinityNeg,Y=r.pushNaN,ie=r.pushNaNNeg,R=r.pushArrayStart,X=r.pushArrayStartFixed,J=r.pushArrayStartFixed32,I=r.pushArrayStartFixed64,O=r.pushObjectStart,P=r.pushObjectStartFixed,D=r.pushObjectStartFixed32,te=r.pushObjectStartFixed64,d=r.pushByteString,T=r.pushByteStringStart,k=r.pushUtf8String,K=r.pushUtf8StringStart,Q=r.pushSimpleUnassigned,re=r.pushTagStart,ue=r.pushTagStart4,ye=r.pushTagStart8,oe=r.pushTagUnassigned,le=r.pushBreak,Ne=t.Math.pow,S=0,Be=0,Ie=0;function ae(q){for(q=q|0,S=0,Be=q;(S|0)<(Be|0)&&(Ie=gu[i[S]&255](i[S]|0)|0,!((Ie|0)>0)););return Ie|0}function ee(q){return q=q|0,((S|0)+(q|0)|0)<(Be|0)?0:1}function ne(q){return q=q|0,i[q|0]<<8|i[q+1|0]|0}function x(q){return q=q|0,i[q|0]<<24|i[q+1|0]<<16|i[q+2|0]<<8|i[q+3|0]|0}function v(q){return q=q|0,a(q|0),S=S+1|0,0}function U(q){return q=q|0,ee(1)|0?1:(a(i[S+1|0]|0),S=S+2|0,0)}function C(q){return q=q|0,ee(2)|0?1:(a(ne(S+1|0)|0),S=S+3|0,0)}function M(q){return q=q|0,ee(4)|0?1:(u(ne(S+1|0)|0,ne(S+3|0)|0),S=S+5|0,0)}function G(q){return q=q|0,ee(8)|0?1:(p(ne(S+1|0)|0,ne(S+3|0)|0,ne(S+5|0)|0,ne(S+7|0)|0),S=S+9|0,0)}function h(q){return q=q|0,a(-1-(q-32|0)|0),S=S+1|0,0}function o(q){return q=q|0,ee(1)|0?1:(a(-1-(i[S+1|0]|0)|0),S=S+2|0,0)}function c(q){q=q|0;var Ae=0;return ee(2)|0?1:(Ae=ne(S+1|0)|0,a(-1-(Ae|0)|0),S=S+3|0,0)}function m(q){return q=q|0,ee(4)|0?1:(s(ne(S+1|0)|0,ne(S+3|0)|0),S=S+5|0,0)}function E(q){return q=q|0,ee(8)|0?1:(b(ne(S+1|0)|0,ne(S+3|0)|0,ne(S+5|0)|0,ne(S+7|0)|0),S=S+9|0,0)}function F(q){q=q|0;var Ae=0,Te=0,Ee=0;return Ee=q-64|0,ee(Ee|0)|0?1:(Ae=S+1|0,Te=(S+1|0)+(Ee|0)|0,d(Ae|0,Te|0),S=Te|0,0)}function W(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(1)|0||(Ee=i[S+1|0]|0,Ae=S+2|0,Te=(S+2|0)+(Ee|0)|0,ee(Ee+1|0)|0)?1:(d(Ae|0,Te|0),S=Te|0,0)}function se(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(2)|0||(Ee=ne(S+1|0)|0,Ae=S+3|0,Te=(S+3|0)+(Ee|0)|0,ee(Ee+2|0)|0)?1:(d(Ae|0,Te|0),S=Te|0,0)}function fe(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(4)|0||(Ee=x(S+1|0)|0,Ae=S+5|0,Te=(S+5|0)+(Ee|0)|0,ee(Ee+4|0)|0)?1:(d(Ae|0,Te|0),S=Te|0,0)}function he(q){return q=q|0,1}function be(q){return q=q|0,T(),S=S+1|0,0}function g(q){q=q|0;var Ae=0,Te=0,Ee=0;return Ee=q-96|0,ee(Ee|0)|0?1:(Ae=S+1|0,Te=(S+1|0)+(Ee|0)|0,k(Ae|0,Te|0),S=Te|0,0)}function f(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(1)|0||(Ee=i[S+1|0]|0,Ae=S+2|0,Te=(S+2|0)+(Ee|0)|0,ee(Ee+1|0)|0)?1:(k(Ae|0,Te|0),S=Te|0,0)}function l(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(2)|0||(Ee=ne(S+1|0)|0,Ae=S+3|0,Te=(S+3|0)+(Ee|0)|0,ee(Ee+2|0)|0)?1:(k(Ae|0,Te|0),S=Te|0,0)}function N(q){q=q|0;var Ae=0,Te=0,Ee=0;return ee(4)|0||(Ee=x(S+1|0)|0,Ae=S+5|0,Te=(S+5|0)+(Ee|0)|0,ee(Ee+4|0)|0)?1:(k(Ae|0,Te|0),S=Te|0,0)}function H(q){return q=q|0,1}function L(q){return q=q|0,K(),S=S+1|0,0}function Z(q){return q=q|0,X(q-128|0),S=S+1|0,0}function we(q){return q=q|0,ee(1)|0?1:(X(i[S+1|0]|0),S=S+2|0,0)}function xe(q){return q=q|0,ee(2)|0?1:(X(ne(S+1|0)|0),S=S+3|0,0)}function me(q){return q=q|0,ee(4)|0?1:(J(ne(S+1|0)|0,ne(S+3|0)|0),S=S+5|0,0)}function ge(q){return q=q|0,ee(8)|0?1:(I(ne(S+1|0)|0,ne(S+3|0)|0,ne(S+5|0)|0,ne(S+7|0)|0),S=S+9|0,0)}function Se(q){return q=q|0,R(),S=S+1|0,0}function Fe(q){q=q|0;var Ae=0;return Ae=q-160|0,ee(Ae|0)|0?1:(P(Ae|0),S=S+1|0,0)}function Fi(q){return q=q|0,ee(1)|0?1:(P(i[S+1|0]|0),S=S+2|0,0)}function Pi(q){return q=q|0,ee(2)|0?1:(P(ne(S+1|0)|0),S=S+3|0,0)}function ki(q){return q=q|0,ee(4)|0?1:(D(ne(S+1|0)|0,ne(S+3|0)|0),S=S+5|0,0)}function Mi(q){return q=q|0,ee(8)|0?1:(te(ne(S+1|0)|0,ne(S+3|0)|0,ne(S+5|0)|0,ne(S+7|0)|0),S=S+9|0,0)}function Ci(q){return q=q|0,O(),S=S+1|0,0}function Vt(q){return q=q|0,re(q-192|0|0),S=S+1|0,0}function eh(q){return q=q|0,re(q|0),S=S+1|0,0}function th(q){return q=q|0,re(q|0),S=S+1|0,0}function rh(q){return q=q|0,re(q|0),S=S+1|0,0}function nh(q){return q=q|0,re(q|0),S=S+1|0,0}function Ke(q){return q=q|0,re(q-192|0|0),S=S+1|0,0}function ih(q){return q=q|0,re(q|0),S=S+1|0,0}function sh(q){return q=q|0,re(q|0),S=S+1|0,0}function oh(q){return q=q|0,re(q|0),S=S+1|0,0}function nu(q){return q=q|0,ee(1)|0?1:(re(i[S+1|0]|0),S=S+2|0,0)}function iu(q){return q=q|0,ee(2)|0?1:(re(ne(S+1|0)|0),S=S+3|0,0)}function su(q){return q=q|0,ee(4)|0?1:(ue(ne(S+1|0)|0,ne(S+3|0)|0),S=S+5|0,0)}function ou(q){return q=q|0,ee(8)|0?1:(ye(ne(S+1|0)|0,ne(S+3|0)|0,ne(S+5|0)|0,ne(S+7|0)|0),S=S+9|0,0)}function $e(q){return q=q|0,Q((q|0)-224|0),S=S+1|0,0}function au(q){return q=q|0,y(),S=S+1|0,0}function cu(q){return q=q|0,_(),S=S+1|0,0}function uu(q){return q=q|0,V(),S=S+1|0,0}function fu(q){return q=q|0,$(),S=S+1|0,0}function lu(q){return q=q|0,ee(1)|0?1:(Q(i[S+1|0]|0),S=S+2|0,0)}function hu(q){q=q|0;var Ae=0,Te=0,Ee=1,vn=0,Lr=0,ah=0;return ee(2)|0?1:(Ae=i[S+1|0]|0,Te=i[S+2|0]|0,(Ae|0)&128&&(Ee=-1),vn=+(((Ae|0)&124)>>2),Lr=+(((Ae|0)&3)<<8|Te),+vn==0?B(+(+Ee*5960464477539063e-23*+Lr)):+vn==31?+Ee==1?+Lr>0?Y():z():+Lr>0?ie():j():B(+(+Ee*Ne(2,+(+vn-25))*+(1024+Lr))),S=S+3|0,0)}function du(q){return q=q|0,ee(4)|0?1:(w(i[S+1|0]|0,i[S+2|0]|0,i[S+3|0]|0,i[S+4|0]|0),S=S+5|0,0)}function pu(q){return q=q|0,ee(8)|0?1:(A(i[S+1|0]|0,i[S+2|0]|0,i[S+3|0]|0,i[S+4|0]|0,i[S+5|0]|0,i[S+6|0]|0,i[S+7|0]|0,i[S+8|0]|0),S=S+9|0,0)}function Ue(q){return q=q|0,1}function yu(q){return q=q|0,le(),S=S+1|0,0}var gu=[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,U,C,M,G,Ue,Ue,Ue,Ue,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,o,c,m,E,Ue,Ue,Ue,Ue,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,W,se,fe,he,Ue,Ue,Ue,be,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,l,N,H,Ue,Ue,Ue,L,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,we,xe,me,ge,Ue,Ue,Ue,Se,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fi,Pi,ki,Mi,Ue,Ue,Ue,Ci,Vt,Vt,Vt,Vt,Vt,Vt,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,Ke,nu,iu,su,ou,Ue,Ue,Ue,Ue,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,au,cu,uu,fu,lu,hu,du,pu,Ue,Ue,Ue,yu];return{parse:ae}}),Ki}var ji={},it={},fo;function Bi(){if(fo)return it;fo=1;const e=vi().BigNumber;return it.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},it.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},it.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},it.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},it.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},it.SHIFT32=Math.pow(2,32),it.SHIFT16=Math.pow(2,16),it.MAX_SAFE_HIGH=2097151,it.NEG_ONE=new e(-1),it.TEN=new e(10),it.TWO=new e(2),it.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},it}var lo;function Hs(){return lo||(lo=1,function(e){const{Buffer:t}=Ei(),r=vi().BigNumber,n=Bi(),i=n.SHIFT32,a=n.SHIFT16,u=2097151;e.parseHalf=function(b){var B,w,A;return A=b[0]&128?-1:1,B=(b[0]&124)>>2,w=(b[0]&3)<<8|b[1],B?B===31?A*(w?NaN:1/0):A*Math.pow(2,B-25)*(1024+w):A*5960464477539063e-23*w};function s(p){return p<16?"0"+p.toString(16):p.toString(16)}e.arrayBufferToBignumber=function(p){const b=p.byteLength;let B="";for(let w=0;w<b;w++)B+=s(p[w]);return new r(B,16)},e.buildMap=p=>{const b=new Map,B=Object.keys(p),w=B.length;for(let A=0;A<w;A++)b.set(B[A],p[B[A]]);return b},e.buildInt32=(p,b)=>p*a+b,e.buildInt64=(p,b,B,w)=>{const A=e.buildInt32(p,b),_=e.buildInt32(B,w);return A>u?new r(A).times(i).plus(_):A*i+_},e.writeHalf=function(b,B){const w=t.allocUnsafe(4);w.writeFloatBE(B,0);const A=w.readUInt32BE(0);if((A&8191)!==0)return!1;var _=A>>16&32768;const y=A>>23&255,$=A&8388607;if(y>=113&&y<=142)_+=(y-112<<10)+($>>13);else if(y>=103&&y<113){if($&(1<<126-y)-1)return!1;_+=$+8388608>>126-y}else return!1;return b.writeUInt16BE(_,0),!0},e.keySorter=function(p,b){var B=p[0].byteLength,w=b[0].byteLength;return B>w?1:w>B?-1:p[0].compare(b[0])},e.isNegativeZero=p=>p===0&&1/p<0,e.nextPowerOf2=p=>{let b=0;if(p&&!(p&p-1))return p;for(;p!==0;)p>>=1,b+=1;return 1<<b}}(ji)),ji}var zi,ho;function rc(){if(ho)return zi;ho=1;const e=Bi(),t=e.MT,r=e.SIMPLE,n=e.SYMS;class i{constructor(u){if(typeof u!="number")throw new Error("Invalid Simple type: "+typeof u);if(u<0||u>255||(u|0)!==u)throw new Error("value must be a small positive integer: "+u);this.value=u}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(u){return u._pushInt(this.value,t.SIMPLE_FLOAT)}static isSimple(u){return u instanceof i}static decode(u,s){switch(s==null&&(s=!0),u){case r.FALSE:return!1;case r.TRUE:return!0;case r.NULL:return s?null:n.NULL;case r.UNDEFINED:return s?void 0:n.UNDEFINED;case-1:if(!s)throw new Error("Invalid BREAK");return n.BREAK;default:return new i(u)}}}return zi=i,zi}var Wi,po;function nc(){if(po)return Wi;po=1;class e{constructor(r,n,i){if(this.tag=r,this.value=n,this.err=i,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(r){return r._pushTag(this.tag),r.pushAny(this.value)}convert(r){var n,i;if(i=r!=null?r[this.tag]:void 0,typeof i!="function"&&(i=e["_tag"+this.tag],typeof i!="function"))return this;try{return i.call(e,this.value)}catch(a){return n=a,this.err=n,this}}}return Wi=e,Wi}var Yi,yo;function ic(){if(yo)return Yi;yo=1;const e=self.location?self.location.protocol+"//"+self.location.host:"",t=self.URL;class r{constructor(a="",u=e){this.super=new t(a,u),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(a){this.super.hash=a}set host(a){this.super.host=a}set hostname(a){this.super.hostname=a}set href(a){this.super.href=a}set origin(a){this.super.origin=a}set password(a){this.super.password=a}set pathname(a){this.super.pathname=a}set port(a){this.super.port=a}set protocol(a){this.super.protocol=a}set search(a){this.super.search=a}set searchParams(a){this.super.searchParams=a}set username(a){this.super.username=a}createObjectURL(a){return this.super.createObjectURL(a)}revokeObjectURL(a){this.super.revokeObjectURL(a)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function n(i){if(typeof i=="string")return new t(i).toString();if(!(i instanceof t)){const a=i.username&&i.password?`${i.username}:${i.password}@`:"",u=i.auth?i.auth+"@":"",s=i.port?":"+i.port:"",p=i.protocol?i.protocol+"//":"",b=i.host||"",B=i.hostname||"",w=i.search||(i.query?"?"+i.query:""),A=i.hash||"",_=i.pathname||"",y=i.path||_+w;return`${p}${a||u}${b||B+s}${y}${A}`}}return Yi={URLWithLegacySupport:r,URLSearchParams:self.URLSearchParams,defaultBase:e,format:n},Yi}var Zi,go;function df(){if(go)return Zi;go=1;const{URLWithLegacySupport:e,format:t}=ic();return Zi=(r,n={},i={},a)=>{let u=n.protocol?n.protocol.replace(":",""):"http";u=(i[u]||a||u)+":";let s;try{s=new e(r)}catch{s={}}const p=Object.assign({},n,{protocol:u||s.protocol,host:n.host||s.host});return new e(r,t(p)).toString()},Zi}var Li,wo;function sc(){if(wo)return Li;wo=1;const{URLWithLegacySupport:e,format:t,URLSearchParams:r,defaultBase:n}=ic(),i=df();return Li={URL:e,URLSearchParams:r,format:t,relative:i,defaultBase:n},Li}var Xi,mo;function oc(){if(mo)return Xi;mo=1;const{Buffer:e}=Ei(),t=ks(),r=vi().BigNumber,n=hf(),i=Hs(),a=Bi(),u=rc(),s=nc(),{URL:p}=sc();class b{constructor(w){w=w||{},!w.size||w.size<65536?w.size=65536:w.size=i.nextPowerOf2(w.size),this._heap=new ArrayBuffer(w.size),this._heap8=new Uint8Array(this._heap),this._buffer=e.from(this._heap),this._reset(),this._knownTags=Object.assign({0:A=>new Date(A),1:A=>new Date(A*1e3),2:A=>i.arrayBufferToBignumber(A),3:A=>a.NEG_ONE.minus(i.arrayBufferToBignumber(A)),4:A=>a.TEN.pow(A[0]).times(A[1]),5:A=>a.TWO.pow(A[0]).times(A[1]),32:A=>new p(A),35:A=>new RegExp(A)},w.tags),this.parser=n(bu,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var w=this._parents.pop();if(w.length>0)throw new Error(`Missing ${w.length} elements`);switch(w.type){case a.PARENT.TAG:this._push(this.createTag(w.ref[0],w.ref[1]));break;case a.PARENT.BYTE_STRING:this._push(this.createByteString(w.ref,w.length));break;case a.PARENT.UTF8_STRING:this._push(this.createUtf8String(w.ref,w.length));break;case a.PARENT.MAP:if(w.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(w.ref,w.length));break;case a.PARENT.OBJECT:if(w.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(w.ref,w.length));break;case a.PARENT.ARRAY:this._push(this.createArray(w.ref,w.length));break}this._currentParent&&this._currentParent.type===a.PARENT.TAG&&this._dec()}_dec(){const w=this._currentParent;w.length<0||(w.length--,w.length===0&&this._closeParent())}_push(w,A){const _=this._currentParent;switch(_.values++,_.type){case a.PARENT.ARRAY:case a.PARENT.BYTE_STRING:case a.PARENT.UTF8_STRING:_.length>-1?this._ref[this._ref.length-_.length]=w:this._ref.push(w),this._dec();break;case a.PARENT.OBJECT:_.tmpKey!=null?(this._ref[_.tmpKey]=w,_.tmpKey=null,this._dec()):(_.tmpKey=w,typeof _.tmpKey!="string"&&(_.type=a.PARENT.MAP,_.ref=i.buildMap(_.ref)));break;case a.PARENT.MAP:_.tmpKey!=null?(this._ref.set(_.tmpKey,w),_.tmpKey=null,this._dec()):_.tmpKey=w;break;case a.PARENT.TAG:this._ref.push(w),A||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(w,A,_){this._parents[this._depth]={type:A,length:_,ref:w,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:a.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(w,A){const _=this._knownTags[w];return _?_(A):new s(w,A)}createMap(w,A){return w}createObject(w,A){return w}createArray(w,A){return w}createByteString(w,A){return e.concat(w)}createByteStringFromHeap(w,A){return w===A?e.alloc(0):e.from(this._heap.slice(w,A))}createInt(w){return w}createInt32(w,A){return i.buildInt32(w,A)}createInt64(w,A,_,y){return i.buildInt64(w,A,_,y)}createFloat(w){return w}createFloatSingle(w,A,_,y){return t.read([w,A,_,y],0,!1,23,4)}createFloatDouble(w,A,_,y,$,V,z,j){return t.read([w,A,_,y,$,V,z,j],0,!1,52,8)}createInt32Neg(w,A){return-1-i.buildInt32(w,A)}createInt64Neg(w,A,_,y){const $=i.buildInt32(w,A),V=i.buildInt32(_,y);return $>a.MAX_SAFE_HIGH?a.NEG_ONE.minus(new r($).times(a.SHIFT32).plus(V)):-1-($*a.SHIFT32+V)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(w,A){return w.join("")}createUtf8StringFromHeap(w,A){return w===A?"":this._buffer.toString("utf8",w,A)}createSimpleUnassigned(w){return new u(w)}pushInt(w){this._push(this.createInt(w))}pushInt32(w,A){this._push(this.createInt32(w,A))}pushInt64(w,A,_,y){this._push(this.createInt64(w,A,_,y))}pushFloat(w){this._push(this.createFloat(w))}pushFloatSingle(w,A,_,y){this._push(this.createFloatSingle(w,A,_,y))}pushFloatDouble(w,A,_,y,$,V,z,j){this._push(this.createFloatDouble(w,A,_,y,$,V,z,j))}pushInt32Neg(w,A){this._push(this.createInt32Neg(w,A))}pushInt64Neg(w,A,_,y){this._push(this.createInt64Neg(w,A,_,y))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],a.PARENT.ARRAY,-1)}pushArrayStartFixed(w){this._createArrayStartFixed(w)}pushArrayStartFixed32(w,A){const _=i.buildInt32(w,A);this._createArrayStartFixed(_)}pushArrayStartFixed64(w,A,_,y){const $=i.buildInt64(w,A,_,y);this._createArrayStartFixed($)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(w){this._createObjectStartFixed(w)}pushObjectStartFixed32(w,A){const _=i.buildInt32(w,A);this._createObjectStartFixed(_)}pushObjectStartFixed64(w,A,_,y){const $=i.buildInt64(w,A,_,y);this._createObjectStartFixed($)}pushByteStringStart(){this._parents[this._depth]={type:a.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(w,A){this._push(this.createByteStringFromHeap(w,A))}pushUtf8StringStart(){this._parents[this._depth]={type:a.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(w,A){this._push(this.createUtf8StringFromHeap(w,A))}pushSimpleUnassigned(w){this._push(this.createSimpleUnassigned(w))}pushTagStart(w){this._parents[this._depth]={type:a.PARENT.TAG,length:1,ref:[w]}}pushTagStart4(w,A){this.pushTagStart(i.buildInt32(w,A))}pushTagStart8(w,A,_,y){this.pushTagStart(i.buildInt64(w,A,_,y))}pushTagUnassigned(w){this._push(this.createTag(w))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(w){if(w===0){this._push(this.createObject({}));return}this._createParent({},a.PARENT.OBJECT,w)}_createArrayStartFixed(w){if(w===0){this._push(this.createArray([]));return}this._createParent(new Array(w),a.PARENT.ARRAY,w)}_decode(w){if(w.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(w);const A=this.parser.parse(w.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(A>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(w){return this._decode(w),this._res[0]}decodeAll(w){return this._decode(w),this._res}static decode(w,A){return typeof w=="string"&&(w=e.from(w,A||"hex")),new b({size:w.length}).decodeFirst(w)}static decodeAll(w,A){return typeof w=="string"&&(w=e.from(w,A||"hex")),new b({size:w.length}).decodeAll(w)}}return b.decodeFirst=b.decode,Xi=b,Xi}var Di,bo;function pf(){if(bo)return Di;bo=1;const{Buffer:e}=Ei(),t=oc(),r=Hs();class n extends t{createTag(u,s){return`${u}(${s})`}createInt(u){return super.createInt(u).toString()}createInt32(u,s){return super.createInt32(u,s).toString()}createInt64(u,s,p,b){return super.createInt64(u,s,p,b).toString()}createInt32Neg(u,s){return super.createInt32Neg(u,s).toString()}createInt64Neg(u,s,p,b){return super.createInt64Neg(u,s,p,b).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(u){const s=super.createFloat(u);return r.isNegativeZero(u)?"-0_1":`${s}_1`}createFloatSingle(u,s,p,b){return`${super.createFloatSingle(u,s,p,b)}_2`}createFloatDouble(u,s,p,b,B,w,A,_){return`${super.createFloatDouble(u,s,p,b,B,w,A,_)}_3`}createByteString(u,s){const p=u.join(", ");return s===-1?`(_ ${p})`:`h'${p}`}createByteStringFromHeap(u,s){return`h'${e.from(super.createByteStringFromHeap(u,s)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(u){return`simple(${u})`}createArray(u,s){const p=super.createArray(u,s);return s===-1?`[_ ${p.join(", ")}]`:`[${p.join(", ")}]`}createMap(u,s){const p=super.createMap(u),b=Array.from(p.keys()).reduce(i(p),"");return s===-1?`{_ ${b}}`:`{${b}}`}createObject(u,s){const p=super.createObject(u),b=Object.keys(p).reduce(i(p),"");return s===-1?`{_ ${b}}`:`{${b}}`}createUtf8String(u,s){const p=u.join(", ");return s===-1?`(_ ${p})`:`"${p}"`}createUtf8StringFromHeap(u,s){return`"${e.from(super.createUtf8StringFromHeap(u,s)).toString("utf8")}"`}static diagnose(u,s){return typeof u=="string"&&(u=e.from(u,s||"hex")),new n().decodeFirst(u)}}Di=n;function i(a){return(u,s)=>u?`${u}, ${s}: ${a[s]}`:`${s}: ${a[s]}`}return Di}var Ji,_o;function yf(){if(_o)return Ji;_o=1;const{Buffer:e}=Ei(),{URL:t}=sc(),r=vi().BigNumber,n=Hs(),i=Bi(),a=i.MT,u=i.NUMBYTES,s=i.SHIFT32,p=i.SYMS,b=i.TAG,B=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.TWO,w=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.FOUR,A=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.EIGHT,_=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.TRUE,y=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.FALSE,$=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.UNDEFINED,V=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.NULL,z=new r("0x20000000000000"),j=e.from("f97e00","hex"),Y=e.from("f9fc00","hex"),ie=e.from("f97c00","hex");function R(J){return{}.toString.call(J).slice(8,-1)}class X{constructor(I){I=I||{},this.streaming=typeof I.stream=="function",this.onData=I.stream,this.semanticTypes=[[t,this._pushUrl],[r,this._pushBigNumber]];const O=I.genTypes||[],P=O.length;for(let D=0;D<P;D++)this.addSemanticType(O[D][0],O[D][1]);this._reset()}addSemanticType(I,O){const P=this.semanticTypes.length;for(let D=0;D<P;D++)if(this.semanticTypes[D][0]===I){const d=this.semanticTypes[D][1];return this.semanticTypes[D][1]=O,d}return this.semanticTypes.push([I,O]),null}push(I){return I&&(this.result[this.offset]=I,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=I.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(I,O,P){return this.result[this.offset]=I,this.resultMethod[this.offset]=O,this.resultLength[this.offset]=P,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(I){return this.pushWrite(I,1,1)}_pushUInt16BE(I){return this.pushWrite(I,2,2)}_pushUInt32BE(I){return this.pushWrite(I,3,4)}_pushDoubleBE(I){return this.pushWrite(I,4,8)}_pushNaN(){return this.push(j)}_pushInfinity(I){const O=I<0?Y:ie;return this.push(O)}_pushFloat(I){const O=e.allocUnsafe(2);if(n.writeHalf(O,I)&&n.parseHalf(O)===I)return this._pushUInt8(B)&&this.push(O);const P=e.allocUnsafe(4);return P.writeFloatBE(I,0),P.readFloatBE(0)===I?this._pushUInt8(w)&&this.push(P):this._pushUInt8(A)&&this._pushDoubleBE(I)}_pushInt(I,O,P){const D=O<<5;return I<24?this._pushUInt8(D|I):I<=255?this._pushUInt8(D|u.ONE)&&this._pushUInt8(I):I<=65535?this._pushUInt8(D|u.TWO)&&this._pushUInt16BE(I):I<=4294967295?this._pushUInt8(D|u.FOUR)&&this._pushUInt32BE(I):I<=Number.MAX_SAFE_INTEGER?this._pushUInt8(D|u.EIGHT)&&this._pushUInt32BE(Math.floor(I/s))&&this._pushUInt32BE(I%s):O===a.NEG_INT?this._pushFloat(P):this._pushFloat(I)}_pushIntNum(I){return I<0?this._pushInt(-I-1,a.NEG_INT,I):this._pushInt(I,a.POS_INT)}_pushNumber(I){switch(!1){case I===I:return this._pushNaN(I);case isFinite(I):return this._pushInfinity(I);case I%1!==0:return this._pushIntNum(I);default:return this._pushFloat(I)}}_pushString(I){const O=e.byteLength(I,"utf8");return this._pushInt(O,a.UTF8_STRING)&&this.pushWrite(I,5,O)}_pushBoolean(I){return this._pushUInt8(I?_:y)}_pushUndefined(I){return this._pushUInt8($)}_pushArray(I,O){const P=O.length;if(!I._pushInt(P,a.ARRAY))return!1;for(let D=0;D<P;D++)if(!I.pushAny(O[D]))return!1;return!0}_pushTag(I){return this._pushInt(I,a.TAG)}_pushDate(I,O){return I._pushTag(b.DATE_EPOCH)&&I.pushAny(Math.round(O/1e3))}_pushBuffer(I,O){return I._pushInt(O.length,a.BYTE_STRING)&&I.push(O)}_pushNoFilter(I,O){return I._pushBuffer(I,O.slice())}_pushRegexp(I,O){return I._pushTag(b.REGEXP)&&I.pushAny(O.source)}_pushSet(I,O){if(!I._pushInt(O.size,a.ARRAY))return!1;for(const P of O)if(!I.pushAny(P))return!1;return!0}_pushUrl(I,O){return I._pushTag(b.URI)&&I.pushAny(O.format())}_pushBigint(I){let O=b.POS_BIGINT;I.isNegative()&&(I=I.negated().minus(1),O=b.NEG_BIGINT);let P=I.toString(16);P.length%2&&(P="0"+P);const D=e.from(P,"hex");return this._pushTag(O)&&this._pushBuffer(this,D)}_pushBigNumber(I,O){if(O.isNaN())return I._pushNaN();if(!O.isFinite())return I._pushInfinity(O.isNegative()?-1/0:1/0);if(O.isInteger())return I._pushBigint(O);if(!(I._pushTag(b.DECIMAL_FRAC)&&I._pushInt(2,a.ARRAY)))return!1;const P=O.decimalPlaces(),D=O.multipliedBy(new r(10).pow(P));return I._pushIntNum(-P)?D.abs().isLessThan(z)?I._pushIntNum(D.toNumber()):I._pushBigint(D):!1}_pushMap(I,O){return I._pushInt(O.size,a.MAP)?this._pushRawMap(O.size,Array.from(O)):!1}_pushObject(I){if(!I)return this._pushUInt8(V);for(var O=this.semanticTypes.length,P=0;P<O;P++)if(I instanceof this.semanticTypes[P][0])return this.semanticTypes[P][1].call(I,this,I);var D=I.encodeCBOR;if(typeof D=="function")return D.call(I,this);var te=Object.keys(I),d=te.length;return this._pushInt(d,a.MAP)?this._pushRawMap(d,te.map(T=>[T,I[T]])):!1}_pushRawMap(I,O){O=O.map(function(D){return D[0]=X.encode(D[0]),D}).sort(n.keySorter);for(var P=0;P<I;P++)if(!this.push(O[P][0])||!this.pushAny(O[P][1]))return!1;return!0}write(I){return this.pushAny(I)}pushAny(I){var O=R(I);switch(O){case"Number":return this._pushNumber(I);case"String":return this._pushString(I);case"Boolean":return this._pushBoolean(I);case"Object":return this._pushObject(I);case"Array":return this._pushArray(this,I);case"Uint8Array":return this._pushBuffer(this,e.isBuffer(I)?I:e.from(I));case"Null":return this._pushUInt8(V);case"Undefined":return this._pushUndefined(I);case"Map":return this._pushMap(this,I);case"Set":return this._pushSet(this,I);case"URL":return this._pushUrl(this,I);case"BigNumber":return this._pushBigNumber(this,I);case"Date":return this._pushDate(this,I);case"RegExp":return this._pushRegexp(this,I);case"Symbol":switch(I){case p.NULL:return this._pushObject(null);case p.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+I.toString())}default:throw new Error("Unknown type: "+typeof I+", "+(I?I.toString():""))}}finalize(){if(this.offset===0)return null;for(var I=this.result,O=this.resultLength,P=this.resultMethod,D=this.offset,te=0,d=0;d<D;d++)te+=O[d];var T=e.allocUnsafe(te),k=0,K=0;for(d=0;d<D;d++){switch(K=O[d],P[d]){case 0:I[d].copy(T,k);break;case 1:T.writeUInt8(I[d],k,!0);break;case 2:T.writeUInt16BE(I[d],k,!0);break;case 3:T.writeUInt32BE(I[d],k,!0);break;case 4:T.writeDoubleBE(I[d],k,!0);break;case 5:T.write(I[d],k,K,"utf8");break;default:throw new Error("unkown method")}k+=K}var Q=T;return this._reset(),Q}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(I){const O=new X;if(!O.pushAny(I))throw new Error("Failed to encode input");return O.finalize()}}return Ji=X,Ji}var xo;function gf(){return xo||(xo=1,function(e){e.Diagnose=pf(),e.Decoder=oc(),e.Encoder=yf(),e.Simple=rc(),e.Tagged=nc(),e.decodeAll=e.Decoder.decodeAll,e.decodeFirst=e.Decoder.decodeFirst,e.diagnose=e.Diagnose.diagnose,e.encode=e.Encoder.encode,e.decode=e.Decoder.decode,e.leveldb={decode:e.Decoder.decodeAll,encode:e.Encoder.encode,buffer:!0,name:"cbor"}}(Vi)),Vi}var wf=gf();const ac=_u(wf);function yt(e){return an(Lu.create().update(new Uint8Array(e)).digest())}function Cn(e){if(e instanceof ac.Tagged)return Cn(e.value);if(typeof e=="string")return cc(e);if(typeof e=="number")return yt(Me(e));if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return yt(e);if(Array.isArray(e)){const t=e.map(Cn);return yt(gt(...t))}else{if(e&&typeof e=="object"&&e._isPrincipal)return yt(e.toUint8Array());if(typeof e=="object"&&e!==null&&typeof e.toHash=="function")return Cn(e.toHash());if(typeof e=="object")return oi(e);if(typeof e=="bigint")return yt(Me(e))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${e}`),{value:e})}const cc=e=>{const t=new TextEncoder().encode(e);return yt(t)};function hn(e){return oi(e)}function oi(e){const n=Object.entries(e).filter(([,u])=>u!==void 0).map(([u,s])=>{const p=cc(u),b=Cn(s);return[p,b]}).sort(([u],[s])=>wa(u,s)),i=gt(...n.map(u=>gt(...u)));return yt(i)}var mf=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const bf=new TextEncoder().encode(`
ic-request`);class Ks{getPrincipal(){return this._principal||(this._principal=_e.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:r}=t,n=mf(t,["body"]),i=hn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(gt(bf,i))}})}}class ai{getPrincipal(){return _e.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var Dr={},It={},Oe={},Eo;function uc(){if(Eo)return Oe;Eo=1,Object.defineProperty(Oe,"__esModule",{value:!0});const e=9007199254740992;function t(d,...T){const k=new Uint8Array(d.byteLength+T.reduce((Q,re)=>Q+re.byteLength,0));k.set(new Uint8Array(d),0);let K=d.byteLength;for(const Q of T)k.set(new Uint8Array(Q),K),K+=Q.byteLength;return k.buffer}function r(d,T,k){k=k.replace(/[^0-9a-fA-F]/g,"");const K=2**(T-24);k=k.slice(-K*2).padStart(K*2,"0");const Q=[(d<<5)+T].concat(k.match(/../g).map(re=>parseInt(re,16)));return new Uint8Array(Q).buffer}function n(d,T){if(T<24)return new Uint8Array([(d<<5)+T]).buffer;{const k=T<=255?24:T<=65535?25:T<=4294967295?26:27;return r(d,k,T.toString(16))}}function i(d){const T=[];for(let k=0;k<d.length;k++){let K=d.charCodeAt(k);K<128?T.push(K):K<2048?T.push(192|K>>6,128|K&63):K<55296||K>=57344?T.push(224|K>>12,128|K>>6&63,128|K&63):(k++,K=(K&1023)<<10|d.charCodeAt(k)&1023,T.push(240|K>>18,128|K>>12&63,128|K>>6&63,128|K&63))}return t(new Uint8Array(n(3,d.length)),new Uint8Array(T))}function a(d,T){if(d==14277111)return t(new Uint8Array([217,217,247]),T);if(d<24)return t(new Uint8Array([192+d]),T);{const k=d<=255?24:d<=65535?25:d<=4294967295?26:27,K=2**(k-24),Q=d.toString(16).slice(-K*2).padStart(K*2,"0"),re=[192+k].concat(Q.match(/../g).map(ue=>parseInt(ue,16)));return new Uint8Array(re).buffer}}Oe.tagged=a;function u(d){return new Uint8Array(d).buffer}Oe.raw=u;function s(d){if(isNaN(d))throw new RangeError("Invalid number.");d=Math.min(Math.max(0,d),23);const T=[0+d];return new Uint8Array(T).buffer}Oe.uSmall=s;function p(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,d),255),d=d.toString(16),r(0,24,d)}Oe.u8=p;function b(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,d),65535),d=d.toString(16),r(0,25,d)}Oe.u16=b;function B(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,d),4294967295),d=d.toString(16),r(0,26,d)}Oe.u32=B;function w(d,T){if(typeof d=="string"&&T==16){if(d.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return r(0,27,d)}if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,d),e),d=d.toString(16),r(0,27,d)}Oe.u64=w;function A(d){if(isNaN(d))throw new RangeError("Invalid number.");if(d===0)return s(0);d=Math.min(Math.max(0,-d),24)-1;const T=[32+d];return new Uint8Array(T).buffer}Oe.iSmall=A;function _(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,-d-1),255),d=d.toString(16),r(1,24,d)}Oe.i8=_;function y(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,-d-1),65535),d=d.toString(16),r(1,25,d)}Oe.i16=y;function $(d,T){if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,-d-1),4294967295),d=d.toString(16),r(1,26,d)}Oe.i32=$;function V(d,T){if(typeof d=="string"&&T==16){if(d.startsWith("-")?d=d.slice(1):d="0",d.match(/[^0-9a-fA-F]/)||d.length>16)throw new RangeError("Invalid number.");let k=!1,K=d.split("").reduceRight((Q,re)=>{if(k)return re+Q;let ue=parseInt(re,16)-1;return ue>=0?(k=!0,ue.toString(16)+Q):"f"+Q},"");return k?r(1,27,K):w(0)}if(d=parseInt(""+d,T),isNaN(d))throw new RangeError("Invalid number.");return d=Math.min(Math.max(0,-d-1),9007199254740992),d=d.toString(16),r(1,27,d)}Oe.i64=V;function z(d){return d>=0?d<24?s(d):d<=255?p(d):d<=65535?b(d):d<=4294967295?B(d):w(d):d>=-24?A(d):d>=-255?_(d):d>=-65535?y(d):d>=-4294967295?$(d):V(d)}Oe.number=z;function j(d){return t(n(2,d.byteLength),d)}Oe.bytes=j;function Y(d){return i(d)}Oe.string=Y;function ie(d){return t(n(4,d.length),...d)}Oe.array=ie;function R(d,T=!1){d instanceof Map||(d=new Map(Object.entries(d)));let k=Array.from(d.entries());return T&&(k=k.sort(([K],[Q])=>K.localeCompare(Q))),t(n(5,d.size),...k.map(([K,Q])=>t(i(K),Q)))}Oe.map=R;function X(d){const T=new Float32Array([d]);return t(new Uint8Array([250]),new Uint8Array(T.buffer))}Oe.singleFloat=X;function J(d){const T=new Float64Array([d]);return t(new Uint8Array([251]),new Uint8Array(T.buffer))}Oe.doubleFloat=J;function I(d){return d?O():P()}Oe.bool=I;function O(){return u(new Uint8Array([245]))}Oe.true_=O;function P(){return u(new Uint8Array([244]))}Oe.false_=P;function D(){return u(new Uint8Array([246]))}Oe.null_=D;function te(){return u(new Uint8Array([247]))}return Oe.undefined_=te,Oe}var vo;function _f(){if(vo)return It;vo=1;var e=It&&It.__importStar||function(s){if(s&&s.__esModule)return s;var p={};if(s!=null)for(var b in s)Object.hasOwnProperty.call(s,b)&&(p[b]=s[b]);return p.default=s,p};Object.defineProperty(It,"__esModule",{value:!0});const t=e(uc()),r=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class n{constructor(p,b=!1){this._serializer=p,this._stable=b,this.name="jsonDefault",this.priority=-100}match(p){return["undefined","boolean","number","string","object"].indexOf(typeof p)!=-1}encode(p){switch(typeof p){case"undefined":return t.undefined_();case"boolean":return t.bool(p);case"number":return Math.floor(p)===p?t.number(p):t.doubleFloat(p);case"string":return t.string(p);case"object":if(p===null)return t.null_();if(Array.isArray(p))return t.array(p.map(b=>this._serializer.serializeValue(b)));if(r.find(b=>p instanceof b))return t.bytes(p.buffer);if(Object.getOwnPropertyNames(p).indexOf("toJSON")!==-1)return this.encode(p.toJSON());if(p instanceof Map){const b=new Map;for(const[B,w]of p.entries())b.set(B,this._serializer.serializeValue(w));return t.map(b,this._stable)}else{const b=new Map;for(const[B,w]of Object.entries(p))b.set(B,this._serializer.serializeValue(w));return t.map(b,this._stable)}default:throw new Error("Invalid value.")}}}It.JsonDefaultCborEncoder=n;class i{constructor(){this.name="cborEncoder",this.priority=-90}match(p){return typeof p=="object"&&typeof p.toCBOR=="function"}encode(p){return p.toCBOR()}}It.ToCborEncoder=i;class a{constructor(){this._encoders=new Set}static withDefaultEncoders(p=!1){const b=new this;return b.addEncoder(new n(b,p)),b.addEncoder(new i),b}removeEncoder(p){for(const b of this._encoders.values())b.name==p&&this._encoders.delete(b)}addEncoder(p){this._encoders.add(p)}getEncoderFor(p){let b=null;for(const B of this._encoders)(!b||B.priority>b.priority)&&B.match(p)&&(b=B);if(b===null)throw new Error("Could not find an encoder for value.");return b}serializeValue(p){return this.getEncoderFor(p).encode(p)}serialize(p){return this.serializeValue(p)}}It.CborSerializer=a;class u extends a{serialize(p){return t.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(p))]))}}return It.SelfDescribeCborSerializer=u,It}var Bo;function xf(){return Bo||(Bo=1,function(e){function t(i){for(var a in i)e.hasOwnProperty(a)||(e[a]=i[a])}var r=Dr&&Dr.__importStar||function(i){if(i&&i.__esModule)return i;var a={};if(i!=null)for(var u in i)Object.hasOwnProperty.call(i,u)&&(a[u]=i[u]);return a.default=i,a};Object.defineProperty(e,"__esModule",{value:!0}),t(_f());const n=r(uc());e.value=n}(Dr)),Dr}var ct=xf();class Ef{get name(){return"Principal"}get priority(){return 0}match(t){return t&&t._isPrincipal===!0}encode(t){return ct.value.bytes(t.toUint8Array())}}class vf{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return ct.value.bytes(new Uint8Array(t))}}class Bf{get name(){return"BigInt"}get priority(){return 1}match(t){return typeof t=="bigint"}encode(t){return t>BigInt(0)?ct.value.tagged(2,ct.value.bytes(qt(t.toString(16)))):ct.value.tagged(3,ct.value.bytes(qt((BigInt("-1")*t).toString(16))))}}const Ai=ct.SelfDescribeCborSerializer.withDefaultEncoders(!0);Ai.addEncoder(new Ef);Ai.addEncoder(new vf);Ai.addEncoder(new Bf);var Es;(function(e){e[e.Uint64LittleEndian=71]="Uint64LittleEndian",e[e.Semantic=55799]="Semantic"})(Es||(Es={}));function Qi(e){return Ai.serialize(e)}function Ao(e){const t=e.byteLength;let r=BigInt(0);for(let n=0;n<t;n++)r=r*BigInt(256)+BigInt(e[n]);return r}class Af extends ac.Decoder{createByteString(t){return gt(...t)}createByteStringFromHeap(t,r){return t===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,r))}}function Mt(e){const t=new Uint8Array(e),r=new Af({size:t.byteLength,tags:{2:n=>Ao(n),3:n=>-Ao(n),[Es.Semantic]:n=>n}});try{return r.decodeFirst(t)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${Pe(t)}`)}}const In=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var vs;(function(e){e.Call="call"})(vs||(vs={}));function Bs(){const e=new ArrayBuffer(16),t=new DataView(e),r=In(),n=In(),i=In(),a=In();return t.setUint32(0,r),t.setUint32(4,n),t.setUint32(8,i),t.setUint32(12,a),e}const To=BigInt(1e6),Tf=60*1e3;class Rn{constructor(t){if(t<90*1e3){const s=BigInt(Date.now()+t)*To/BigInt(1e9);this._value=s*BigInt(1e9);return}const a=BigInt(Math.floor(Date.now()+t-Tf))*To/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=a}toCBOR(){return ct.value.u64(this._value.toString(16),16)}toHash(){return Me(this._value)}}function So(e=Bs){return async t=>{const r=t.request.headers;t.request.headers=r,t.endpoint==="call"&&(t.body.nonce=e())}}function Qr(e){const t=[];return e.forEach((r,n)=>{t.push([n,r])}),t}class es extends ke{constructor(t,r){super(t),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class Sf extends ke{constructor(t,r,n,i,a,u){super(t),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=u,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Nf extends ke{constructor(t,r,n,i,a,u){super(t),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=u,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class If extends ke{constructor(t,r,n,i,a,u){super(t),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=a,this.ingressExpiry=u,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const js=BigInt(0),ci=BigInt(1);function dn(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function fc(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?js:BigInt("0x"+e)}function Tt(e){return fc(Kr(e))}function pn(e){return Le(e),fc(Kr(Uint8Array.from(e).reverse()))}function Ye(e,t){return la(e.toString(16).padStart(t*2,"0"))}function Ti(e,t){return Ye(e,t).reverse()}function nt(e,t,r){let n;if(typeof t=="string")try{n=la(t)}catch(a){throw new Error(e+" must be hex string or Uint8Array, cause: "+a)}else if(Ms(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}const ts=e=>typeof e=="bigint"&&js<=e;function lc(e,t,r){return ts(e)&&ts(t)&&ts(r)&&t<=e&&e<r}function en(e,t,r,n){if(!lc(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function cn(e){let t;for(t=0;e>js;e>>=ci,t+=1);return t}function Rf(e,t){return e>>BigInt(t)&ci}const Gr=e=>(ci<<BigInt(e))-ci;function Uf(e){return typeof e=="function"&&Number.isSafeInteger(e.outputLen)}function xn(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(i,a,u){const s=e[i];if(u&&s===void 0)return;const p=typeof s;if(p!==a||s===null)throw new Error(`param "${i}" is invalid: expected ${a}, got ${p}`)}Object.entries(t).forEach(([i,a])=>n(i,a,!1)),Object.entries(r).forEach(([i,a])=>n(i,a,!0))}const No=()=>{throw new Error("not implemented")};function yn(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(i!==void 0)return i;const a=e(r,...n);return t.set(r,a),a}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ot=BigInt(0),Ze=BigInt(1),dr=BigInt(2),Of=BigInt(3),hc=BigInt(4),dc=BigInt(5),pc=BigInt(8);function Ge(e,t){const r=e%t;return r>=ot?r:t+r}function mt(e,t,r){let n=e;for(;t-- >ot;)n*=n,n%=r;return n}function Io(e,t){if(e===ot)throw new Error("invert: expected non-zero number");if(t<=ot)throw new Error("invert: expected positive modulus, got "+t);let r=Ge(e,t),n=t,i=ot,a=Ze;for(;r!==ot;){const s=n/r,p=n%r,b=i-a*s;n=r,r=p,i=a,a=b}if(n!==Ze)throw new Error("invert: does not exist");return Ge(i,t)}function yc(e,t){const r=(e.ORDER+Ze)/hc,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function Ff(e,t){const r=(e.ORDER-dc)/pc,n=e.mul(t,dr),i=e.pow(n,r),a=e.mul(t,i),u=e.mul(e.mul(a,dr),i),s=e.mul(a,e.sub(u,e.ONE));if(!e.eql(e.sqr(s),t))throw new Error("Cannot find square root");return s}function Pf(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Ze,r=0;for(;t%dr===ot;)t/=dr,r++;let n=dr;const i=vr(e);for(;ui(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return yc;let a=i.pow(n,t);const u=(t+Ze)/dr;return function(p,b){if(p.is0(b))return b;if(ui(p,b)!==1)throw new Error("Cannot find square root");let B=r,w=p.mul(p.ONE,a),A=p.pow(b,t),_=p.pow(b,u);for(;!p.eql(A,p.ONE);){if(p.is0(A))return p.ZERO;let y=1,$=p.sqr(A);for(;!p.eql($,p.ONE);)if(y++,$=p.sqr($),y===B)throw new Error("Cannot find square root");const V=Ze<<BigInt(B-y-1),z=p.pow(w,V);B=y,w=p.sqr(z),A=p.mul(A,w),_=p.mul(_,z)}return _}}function kf(e){return e%hc===Of?yc:e%pc===dc?Ff:Pf(e)}const Mf=(e,t)=>(Ge(e,t)&Ze)===Ze,Cf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function gc(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=Cf.reduce((n,i)=>(n[i]="function",n),t);return xn(e,r),e}function qn(e,t,r){if(r<ot)throw new Error("invalid exponent, negatives unsupported");if(r===ot)return e.ONE;if(r===Ze)return t;let n=e.ONE,i=t;for(;r>ot;)r&Ze&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ze;return n}function yr(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((u,s,p)=>e.is0(s)?u:(n[p]=u,e.mul(u,s)),e.ONE),a=e.inv(i);return t.reduceRight((u,s,p)=>e.is0(s)?u:(n[p]=e.mul(u,n[p]),e.mul(u,s)),a),n}function ui(e,t){const r=(e.ORDER-Ze)/dr,n=e.pow(t,r),i=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),u=e.eql(n,e.neg(e.ONE));if(!i&&!a&&!u)throw new Error("invalid Legendre symbol result");return i?1:a?0:-1}function qf(e,t){t!==void 0&&Su(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function vr(e,t,r=!1,n={}){if(e<=ot)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,a;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const B=t;B.BITS&&(i=B.BITS),B.sqrt&&(a=B.sqrt),typeof B.isLE=="boolean"&&(r=B.isLE)}else typeof t=="number"&&(i=t),n.sqrt&&(a=n.sqrt);const{nBitLength:u,nByteLength:s}=qf(e,i);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let p;const b=Object.freeze({ORDER:e,isLE:r,BITS:u,BYTES:s,MASK:Gr(u),ZERO:ot,ONE:Ze,create:B=>Ge(B,e),isValid:B=>{if(typeof B!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof B);return ot<=B&&B<e},is0:B=>B===ot,isValidNot0:B=>!b.is0(B)&&b.isValid(B),isOdd:B=>(B&Ze)===Ze,neg:B=>Ge(-B,e),eql:(B,w)=>B===w,sqr:B=>Ge(B*B,e),add:(B,w)=>Ge(B+w,e),sub:(B,w)=>Ge(B-w,e),mul:(B,w)=>Ge(B*w,e),pow:(B,w)=>qn(b,B,w),div:(B,w)=>Ge(B*Io(w,e),e),sqrN:B=>B*B,addN:(B,w)=>B+w,subN:(B,w)=>B-w,mulN:(B,w)=>B*w,inv:B=>Io(B,e),sqrt:a||(B=>(p||(p=kf(e)),p(b,B))),toBytes:B=>r?Ti(B,s):Ye(B,s),fromBytes:B=>{if(B.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+B.length);return r?pn(B):Tt(B)},invertBatch:B=>yr(b,B),cmov:(B,w,A)=>A?w:B});return Object.freeze(b)}function wc(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function mc(e){const t=wc(e);return t+Math.ceil(t/2)}function $f(e,t,r=!1){const n=e.length,i=wc(t),a=mc(t);if(n<16||n<a||n>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+n);const u=r?pn(e):Tt(e),s=Ge(u,t-Ze)+Ze;return r?Ti(s,i):Ye(s,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zr=BigInt(0),pr=BigInt(1);function un(e,t){const r=t.negate();return e?r:t}function fi(e,t,r){const n=t==="pz"?u=>u.pz:u=>u.ez,i=yr(e.Fp,r.map(n));return r.map((u,s)=>u.toAffine(i[s])).map(e.fromAffine)}function bc(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function rs(e,t){bc(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),i=2**e,a=Gr(e),u=BigInt(e);return{windows:r,windowSize:n,mask:a,maxNumber:i,shiftBy:u}}function Ro(e,t,r){const{windowSize:n,mask:i,maxNumber:a,shiftBy:u}=r;let s=Number(e&i),p=e>>u;s>n&&(s-=a,p+=pr);const b=t*n,B=b+Math.abs(s)-1,w=s===0,A=s<0,_=t%2!==0;return{nextN:p,offset:B,isZero:w,isNeg:A,isNegF:_,offsetF:b}}function Gf(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function Vf(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}const ns=new WeakMap,_c=new WeakMap;function is(e){return _c.get(e)||1}function Uo(e){if(e!==zr)throw new Error("invalid wNAF")}function xc(e,t){return{constTimeNegate:un,hasPrecomputes(r){return is(r)!==1},unsafeLadder(r,n,i=e.ZERO){let a=r;for(;n>zr;)n&pr&&(i=i.add(a)),a=a.double(),n>>=pr;return i},precomputeWindow(r,n){const{windows:i,windowSize:a}=rs(n,t),u=[];let s=r,p=s;for(let b=0;b<i;b++){p=s,u.push(p);for(let B=1;B<a;B++)p=p.add(s),u.push(p);s=p.double()}return u},wNAF(r,n,i){let a=e.ZERO,u=e.BASE;const s=rs(r,t);for(let p=0;p<s.windows;p++){const{nextN:b,offset:B,isZero:w,isNeg:A,isNegF:_,offsetF:y}=Ro(i,p,s);i=b,w?u=u.add(un(_,n[y])):a=a.add(un(A,n[B]))}return Uo(i),{p:a,f:u}},wNAFUnsafe(r,n,i,a=e.ZERO){const u=rs(r,t);for(let s=0;s<u.windows&&i!==zr;s++){const{nextN:p,offset:b,isZero:B,isNeg:w}=Ro(i,s,u);if(i=p,!B){const A=n[b];a=a.add(w?A.negate():A)}}return Uo(i),a},getPrecomputes(r,n,i){let a=ns.get(n);return a||(a=this.precomputeWindow(n,r),r!==1&&(typeof i=="function"&&(a=i(a)),ns.set(n,a))),a},wNAFCached(r,n,i){const a=is(r);return this.wNAF(a,this.getPrecomputes(a,r,i),n)},wNAFCachedUnsafe(r,n,i,a){const u=is(r);return u===1?this.unsafeLadder(r,n,a):this.wNAFUnsafe(u,this.getPrecomputes(u,r,i),n,a)},setWindowSize(r,n){bc(n,t),_c.set(r,n),ns.delete(r)}}}function Hf(e,t,r,n){let i=t,a=e.ZERO,u=e.ZERO;for(;r>zr||n>zr;)r&pr&&(a=a.add(i)),n&pr&&(u=u.add(i)),i=i.double(),r>>=pr,n>>=pr;return{p1:a,p2:u}}function Ec(e,t,r,n){Gf(r,e),Vf(n,t);const i=r.length,a=n.length;if(i!==a)throw new Error("arrays of points and scalars must have equal length");const u=e.ZERO,s=cn(BigInt(i));let p=1;s>12?p=s-3:s>4?p=s-2:s>0&&(p=2);const b=Gr(p),B=new Array(Number(b)+1).fill(u),w=Math.floor((t.BITS-1)/p)*p;let A=u;for(let _=w;_>=0;_-=p){B.fill(u);for(let $=0;$<a;$++){const V=n[$],z=Number(V>>BigInt(_)&b);B[z]=B[z].add(r[$])}let y=u;for(let $=B.length-1,V=u;$>0;$--)V=V.add(B[$]),y=y.add(V);if(A=A.add(y),_!==0)for(let $=0;$<p;$++)A=A.double()}return A}function Oo(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return gc(t),t}else return vr(e)}function vc(e,t,r={}){if(!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const s of["p","n","h"]){const p=t[s];if(!(typeof p=="bigint"&&p>zr))throw new Error(`CURVE.${s} must be positive bigint`)}const n=Oo(t.p,r.Fp),i=Oo(t.n,r.Fn),u=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const s of u)if(!n.isValid(t[s]))throw new Error(`CURVE.${s} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}const Kf=Tt;function Lt(e,t){if(gn(e),gn(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}function jf(e,t){const r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function gn(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function zf(e,t,r,n){Le(e),Le(t),gn(r),t.length>255&&(t=n(Ce(wi("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:a}=n,u=Math.ceil(r/i);if(r>65535||u>255)throw new Error("expand_message_xmd: invalid lenInBytes");const s=Ce(t,Lt(t.length,1)),p=Lt(0,a),b=Lt(r,2),B=new Array(u),w=n(Ce(p,e,b,Lt(0,1),s));B[0]=n(Ce(w,Lt(1,1),s));for(let _=1;_<=u;_++){const y=[jf(w,B[_-1]),Lt(_+1,1),s];B[_]=n(Ce(...y))}return Ce(...B).slice(0,r)}function Wf(e,t,r,n,i){if(Le(e),Le(t),gn(r),t.length>255){const a=Math.ceil(2*n/8);t=i.create({dkLen:a}).update(wi("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Lt(r,2)).update(t).update(Lt(t.length,1)).digest()}function Fo(e,t,r){xn(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:n,k:i,m:a,hash:u,expand:s,DST:p}=r;if(!Ms(p)&&typeof p!="string")throw new Error("DST must be string or uint8array");if(!Uf(r.hash))throw new Error("expected valid hash");Le(e),gn(t);const b=typeof p=="string"?wi(p):p,B=n.toString(2).length,w=Math.ceil((B+i)/8),A=t*a*w;let _;if(s==="xmd")_=zf(e,b,A,u);else if(s==="xof")_=Wf(e,b,A,i,u);else if(s==="_internal_pass")_=e;else throw new Error('expand must be "xmd" or "xof"');const y=new Array(t);for(let $=0;$<t;$++){const V=new Array(a);for(let z=0;z<a;z++){const j=w*(z+$*a),Y=_.subarray(j,j+w);V[z]=Ge(Kf(Y),n)}y[$]=V}return y}function Bc(e,t){const r=t.map(n=>Array.from(n).reverse());return(n,i)=>{const[a,u,s,p]=r.map(w=>w.reduce((A,_)=>e.add(e.mul(A,n),_))),[b,B]=yr(e,[u,p],!0);return n=e.mul(a,b),i=e.mul(i,e.mul(s,B)),{x:n,y:i}}}function Po(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function n(a){return e.fromAffine(t(a))}function i(a){const u=a.clearCofactor();return u.equals(e.ZERO)?e.ZERO:(u.assertValidity(),u)}return{defaults:r,hashToCurve(a,u){const s=r.DST?r.DST:{},p=Object.assign({},r,s,u),b=Fo(a,2,p),B=n(b[0]),w=n(b[1]);return i(B.add(w))},encodeToCurve(a,u){const s=r.encodeDST?r.encodeDST:{},p=Object.assign({},r,s,u),b=Fo(a,1,p);return i(n(b[0]))},mapToCurve(a){if(!Array.isArray(a))throw new Error("expected array of bigints");for(const u of a)if(typeof u!="bigint")throw new Error("expected array of bigints");return i(n(a))}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const As=BigInt(0),st=BigInt(1),Yt=BigInt(2),Mr=BigInt(3),Ts=BigInt(4);function Ac(e,t,r){function n(i){const a=e.sqr(i),u=e.mul(a,i);return e.add(e.add(u,e.mul(i,t)),r)}return n}function Tc(e,t,r){const{BYTES:n}=e;function i(a){let u;if(typeof a=="bigint")u=a;else{let s=nt("private key",a);if(t){if(!t.includes(s.length*2))throw new Error("invalid private key");const p=new Uint8Array(n);p.set(s,p.length-s.length),s=p}try{u=e.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof a}`)}}if(r&&(u=e.create(u)),!e.isValidNot0(u))throw new Error("invalid private key: out of range [1..N-1]");return u}return i}function Yf(e,t={}){const{Fp:r,Fn:n}=vc("weierstrass",e,t),{h:i,n:a}=e;xn(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:u}=t;if(u&&(!r.is0(e.a)||typeof u.beta!="bigint"||typeof u.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function s(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function p(I,O,P){const{x:D,y:te}=O.toAffine(),d=r.toBytes(D);if(dn("isCompressed",P),P){s();const T=!r.isOdd(te);return Ce(Zf(T),d)}else return Ce(Uint8Array.of(4),d,r.toBytes(te))}function b(I){Le(I);const O=r.BYTES,P=O+1,D=2*O+1,te=I.length,d=I[0],T=I.subarray(1);if(te===P&&(d===2||d===3)){const k=r.fromBytes(T);if(!r.isValid(k))throw new Error("bad point: is not on curve, wrong x");const K=A(k);let Q;try{Q=r.sqrt(K)}catch(ye){const oe=ye instanceof Error?": "+ye.message:"";throw new Error("bad point: is not on curve, sqrt error"+oe)}s();const re=r.isOdd(Q);return(d&1)===1!==re&&(Q=r.neg(Q)),{x:k,y:Q}}else if(te===D&&d===4){const k=r.fromBytes(T.subarray(O*0,O*1)),K=r.fromBytes(T.subarray(O*1,O*2));if(!_(k,K))throw new Error("bad point: is not on curve");return{x:k,y:K}}else throw new Error(`bad point: got length ${te}, expected compressed=${P} or uncompressed=${D}`)}const B=t.toBytes||p,w=t.fromBytes||b,A=Ac(r,e.a,e.b);function _(I,O){const P=r.sqr(O),D=A(I);return r.eql(P,D)}if(!_(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const y=r.mul(r.pow(e.a,Mr),Ts),$=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(y,$)))throw new Error("bad curve params: a or b");function V(I,O,P=!1){if(!r.isValid(O)||P&&r.is0(O))throw new Error(`bad point coordinate ${I}`);return O}function z(I){if(!(I instanceof R))throw new Error("ProjectivePoint expected")}const j=yn((I,O)=>{const{px:P,py:D,pz:te}=I;if(r.eql(te,r.ONE))return{x:P,y:D};const d=I.is0();O==null&&(O=d?r.ONE:r.inv(te));const T=r.mul(P,O),k=r.mul(D,O),K=r.mul(te,O);if(d)return{x:r.ZERO,y:r.ZERO};if(!r.eql(K,r.ONE))throw new Error("invZ was invalid");return{x:T,y:k}}),Y=yn(I=>{if(I.is0()){if(t.allowInfinityPoint&&!r.is0(I.py))return;throw new Error("bad point: ZERO")}const{x:O,y:P}=I.toAffine();if(!r.isValid(O)||!r.isValid(P))throw new Error("bad point: x or y not field elements");if(!_(O,P))throw new Error("bad point: equation left != right");if(!I.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function ie(I,O,P,D,te){return P=new R(r.mul(P.px,I),P.py,P.pz),O=un(D,O),P=un(te,P),O.add(P)}class R{constructor(O,P,D){this.px=V("x",O),this.py=V("y",P,!0),this.pz=V("z",D),Object.freeze(this)}static fromAffine(O){const{x:P,y:D}=O||{};if(!O||!r.isValid(P)||!r.isValid(D))throw new Error("invalid affine point");if(O instanceof R)throw new Error("projective point not allowed");return r.is0(P)&&r.is0(D)?R.ZERO:new R(P,D,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(O){return fi(R,"pz",O)}static fromBytes(O){return Le(O),R.fromHex(O)}static fromHex(O){const P=R.fromAffine(w(nt("pointHex",O)));return P.assertValidity(),P}static fromPrivateKey(O){const P=Tc(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return R.BASE.multiply(P(O))}static msm(O,P){return Ec(R,n,O,P)}precompute(O=8,P=!0){return J.setWindowSize(this,O),P||this.multiply(Mr),this}_setWindowSize(O){this.precompute(O)}assertValidity(){Y(this)}hasEvenY(){const{y:O}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(O)}equals(O){z(O);const{px:P,py:D,pz:te}=this,{px:d,py:T,pz:k}=O,K=r.eql(r.mul(P,k),r.mul(d,te)),Q=r.eql(r.mul(D,k),r.mul(T,te));return K&&Q}negate(){return new R(this.px,r.neg(this.py),this.pz)}double(){const{a:O,b:P}=e,D=r.mul(P,Mr),{px:te,py:d,pz:T}=this;let k=r.ZERO,K=r.ZERO,Q=r.ZERO,re=r.mul(te,te),ue=r.mul(d,d),ye=r.mul(T,T),oe=r.mul(te,d);return oe=r.add(oe,oe),Q=r.mul(te,T),Q=r.add(Q,Q),k=r.mul(O,Q),K=r.mul(D,ye),K=r.add(k,K),k=r.sub(ue,K),K=r.add(ue,K),K=r.mul(k,K),k=r.mul(oe,k),Q=r.mul(D,Q),ye=r.mul(O,ye),oe=r.sub(re,ye),oe=r.mul(O,oe),oe=r.add(oe,Q),Q=r.add(re,re),re=r.add(Q,re),re=r.add(re,ye),re=r.mul(re,oe),K=r.add(K,re),ye=r.mul(d,T),ye=r.add(ye,ye),re=r.mul(ye,oe),k=r.sub(k,re),Q=r.mul(ye,ue),Q=r.add(Q,Q),Q=r.add(Q,Q),new R(k,K,Q)}add(O){z(O);const{px:P,py:D,pz:te}=this,{px:d,py:T,pz:k}=O;let K=r.ZERO,Q=r.ZERO,re=r.ZERO;const ue=e.a,ye=r.mul(e.b,Mr);let oe=r.mul(P,d),le=r.mul(D,T),Ne=r.mul(te,k),S=r.add(P,D),Be=r.add(d,T);S=r.mul(S,Be),Be=r.add(oe,le),S=r.sub(S,Be),Be=r.add(P,te);let Ie=r.add(d,k);return Be=r.mul(Be,Ie),Ie=r.add(oe,Ne),Be=r.sub(Be,Ie),Ie=r.add(D,te),K=r.add(T,k),Ie=r.mul(Ie,K),K=r.add(le,Ne),Ie=r.sub(Ie,K),re=r.mul(ue,Be),K=r.mul(ye,Ne),re=r.add(K,re),K=r.sub(le,re),re=r.add(le,re),Q=r.mul(K,re),le=r.add(oe,oe),le=r.add(le,oe),Ne=r.mul(ue,Ne),Be=r.mul(ye,Be),le=r.add(le,Ne),Ne=r.sub(oe,Ne),Ne=r.mul(ue,Ne),Be=r.add(Be,Ne),oe=r.mul(le,Be),Q=r.add(Q,oe),oe=r.mul(Ie,Be),K=r.mul(S,K),K=r.sub(K,oe),oe=r.mul(S,le),re=r.mul(Ie,re),re=r.add(re,oe),new R(K,Q,re)}subtract(O){return this.add(O.negate())}is0(){return this.equals(R.ZERO)}multiply(O){const{endo:P}=t;if(!n.isValidNot0(O))throw new Error("invalid scalar: out of range");let D,te;const d=T=>J.wNAFCached(this,T,R.normalizeZ);if(P){const{k1neg:T,k1:k,k2neg:K,k2:Q}=P.splitScalar(O),{p:re,f:ue}=d(k),{p:ye,f:oe}=d(Q);te=ue.add(oe),D=ie(P.beta,re,ye,T,K)}else{const{p:T,f:k}=d(O);D=T,te=k}return R.normalizeZ([D,te])[0]}multiplyUnsafe(O){const{endo:P}=t,D=this;if(!n.isValid(O))throw new Error("invalid scalar: out of range");if(O===As||D.is0())return R.ZERO;if(O===st)return D;if(J.hasPrecomputes(this))return this.multiply(O);if(P){const{k1neg:te,k1:d,k2neg:T,k2:k}=P.splitScalar(O),{p1:K,p2:Q}=Hf(R,D,d,k);return ie(P.beta,K,Q,te,T)}else return J.wNAFCachedUnsafe(D,O)}multiplyAndAddUnsafe(O,P,D){const te=this.multiplyUnsafe(P).add(O.multiplyUnsafe(D));return te.is0()?void 0:te}toAffine(O){return j(this,O)}isTorsionFree(){const{isTorsionFree:O}=t;return i===st?!0:O?O(R,this):J.wNAFCachedUnsafe(this,a).is0()}clearCofactor(){const{clearCofactor:O}=t;return i===st?this:O?O(R,this):this.multiplyUnsafe(i)}toBytes(O=!0){return dn("isCompressed",O),this.assertValidity(),B(R,this,O)}toRawBytes(O=!0){return this.toBytes(O)}toHex(O=!0){return Kr(this.toBytes(O))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}R.BASE=new R(e.Gx,e.Gy,r.ONE),R.ZERO=new R(r.ZERO,r.ONE,r.ZERO),R.Fp=r,R.Fn=n;const X=n.BITS,J=xc(R,t.endo?Math.ceil(X/2):X);return R}function ko(e){const{CURVE:t,curveOpts:r}=Lf(e),n=Yf(t,r);return Xf(e,n)}function Zf(e){return Uint8Array.of(e?2:3)}function Lf(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=vr(t.n,e.nBitLength),i={Fp:r,Fn:n,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}function Xf(e,t){const{Fp:r,Fn:n}=t;function i(s){return lc(s,st,n.ORDER)}const a=Ac(r,e.a,e.b),u=Tc(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:u,weierstrassEquation:a,isWithinCurveOrder:i})}function Df(e,t){const r=e.ORDER;let n=As;for(let y=r-st;y%Yt===As;y/=Yt)n+=st;const i=n,a=Yt<<i-st-st,u=a*Yt,s=(r-st)/u,p=(s-st)/Yt,b=u-st,B=a,w=e.pow(t,s),A=e.pow(t,(s+st)/Yt);let _=(y,$)=>{let V=w,z=e.pow($,b),j=e.sqr(z);j=e.mul(j,$);let Y=e.mul(y,j);Y=e.pow(Y,p),Y=e.mul(Y,z),z=e.mul(Y,$),j=e.mul(Y,y);let ie=e.mul(j,z);Y=e.pow(ie,B);let R=e.eql(Y,e.ONE);z=e.mul(j,A),Y=e.mul(ie,V),j=e.cmov(z,j,R),ie=e.cmov(Y,ie,R);for(let X=i;X>st;X--){let J=X-Yt;J=Yt<<J-st;let I=e.pow(ie,J);const O=e.eql(I,e.ONE);z=e.mul(j,V),V=e.mul(V,V),I=e.mul(ie,V),j=e.cmov(z,j,O),ie=e.cmov(I,ie,O)}return{isValid:R,value:j}};if(e.ORDER%Ts===Mr){const y=(e.ORDER-Mr)/Ts,$=e.sqrt(e.neg(t));_=(V,z)=>{let j=e.sqr(z);const Y=e.mul(V,z);j=e.mul(j,Y);let ie=e.pow(j,y);ie=e.mul(ie,Y);const R=e.mul(ie,$),X=e.mul(e.sqr(ie),z),J=e.eql(X,V);let I=e.cmov(R,ie,J);return{isValid:J,value:I}}}return _}function Sc(e,t){gc(e);const{A:r,B:n,Z:i}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const a=Df(e,i);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return u=>{let s,p,b,B,w,A,_,y;s=e.sqr(u),s=e.mul(s,i),p=e.sqr(s),p=e.add(p,s),b=e.add(p,e.ONE),b=e.mul(b,n),B=e.cmov(i,e.neg(p),!e.eql(p,e.ZERO)),B=e.mul(B,r),p=e.sqr(b),A=e.sqr(B),w=e.mul(A,r),p=e.add(p,w),p=e.mul(p,b),A=e.mul(A,B),w=e.mul(A,n),p=e.add(p,w),_=e.mul(s,b);const{isValid:$,value:V}=a(p,A);y=e.mul(s,u),y=e.mul(y,V),_=e.cmov(_,b,$),y=e.cmov(y,V,$);const z=e.isOdd(u)===e.isOdd(y);y=e.cmov(e.neg(y),y,z);const j=yr(e,[B],!0)[0];return _=e.mul(_,j),{x:_,y}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jf=BigInt(0),Un=BigInt(1),Mo=BigInt(2),Cr=BigInt(3);function Qf(e){const t=[];for(;e>Un;e>>=Un)(e&Un)===Jf?t.unshift(0):(e&Cr)===Cr?(t.unshift(-1),e+=Un):t.unshift(1);return t}function el(e){const{Fp:t,Fr:r,Fp2:n,Fp6:i,Fp12:a}=e.fields,u=e.params.xNegative,s=e.params.twistType,p=ko(e.G1),b=Object.assign(p,Po(p.Point,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),B=ko(e.G2),w=Object.assign(B,Po(B.Point,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let A;if(s==="multiplicative")A=(ae,ee,ne,x,v,U)=>a.mul014(x,ae,n.mul(ee,v),n.mul(ne,U));else if(s==="divisive")A=(ae,ee,ne,x,v,U)=>a.mul034(x,n.mul(ne,U),n.mul(ee,v),ae);else throw new Error("bls: unknown twist type");const _=n.div(n.ONE,n.mul(n.ONE,Mo));function y(ae,ee,ne,x){const v=n.sqr(ne),U=n.sqr(x),C=n.mulByB(n.mul(U,Cr)),M=n.mul(C,Cr),G=n.sub(n.sub(n.sqr(n.add(ne,x)),U),v),h=n.sub(C,v),o=n.mul(n.sqr(ee),Cr),c=n.neg(G);return ae.push([h,o,c]),ee=n.mul(n.mul(n.mul(n.sub(v,M),ee),ne),_),ne=n.sub(n.sqr(n.mul(n.add(v,M),_)),n.mul(n.sqr(C),Cr)),x=n.mul(v,G),{Rx:ee,Ry:ne,Rz:x}}function $(ae,ee,ne,x,v,U){const C=n.sub(ne,n.mul(U,x)),M=n.sub(ee,n.mul(v,x)),G=n.sub(n.mul(C,v),n.mul(M,U)),h=n.neg(C),o=M;ae.push([G,h,o]);const c=n.sqr(M),m=n.mul(c,M),E=n.mul(c,ee),F=n.add(n.sub(m,n.mul(E,Mo)),n.mul(n.sqr(C),x));return ee=n.mul(M,F),ne=n.sub(n.mul(n.sub(E,F),C),n.mul(m,ne)),x=n.mul(x,m),{Rx:ee,Ry:ne,Rz:x}}const V=Qf(e.params.ateLoopSize),z=yn(ae=>{const ee=ae,{x:ne,y:x}=ee.toAffine(),v=ne,U=x,C=n.neg(x);let M=v,G=U,h=n.ONE;const o=[];for(const c of V){const m=[];({Rx:M,Ry:G,Rz:h}=y(m,M,G,h)),c&&({Rx:M,Ry:G,Rz:h}=$(m,M,G,h,v,c===-1?C:U)),o.push(m)}if(e.postPrecompute){const c=o[o.length-1];e.postPrecompute(M,G,h,v,U,$.bind(null,c))}return o});function j(ae,ee=!1){let ne=a.ONE;if(ae.length){const x=ae[0][0].length;for(let v=0;v<x;v++){ne=a.sqr(ne);for(const[U,C,M]of ae)for(const[G,h,o]of U[v])ne=A(G,h,o,ne,C,M)}}return u&&(ne=a.conjugate(ne)),ee?a.finalExponentiate(ne):ne}function Y(ae,ee=!0){const ne=[];fi(b.Point,"pz",ae.map(({g1:x})=>x)),fi(w.Point,"pz",ae.map(({g2:x})=>x));for(const{g1:x,g2:v}of ae){if(x.is0()||v.is0())throw new Error("pairing is not available for ZERO point");x.assertValidity(),v.assertValidity();const U=x.toAffine();ne.push([z(v),U.x,U.y])}return j(ne,ee)}function ie(ae,ee,ne=!0){return Y([{g1:ae,g2:ee}],ne)}const R=e.randomBytes||da,X={randomPrivateKey:()=>{const ae=mc(r.ORDER);return $f(R(ae),r.ORDER)},calcPairingPrecomputes:z};function J(ae){if(!Array.isArray(ae)||ae.length===0)throw new Error("expected non-empty array")}function I(ae){return ae instanceof b.Point?ae:b.Point.fromHex(ae)}function O(ae){return ae instanceof w.Point?ae:T.fromHex(ae)}function P(ae,ee){function ne(C){return C instanceof ae.Point?C:ae.Point.fromHex(C)}function x(C){return C instanceof ee.Point?C:ee.Point.fromHex(C)}function v(C){if(!(C instanceof ee.Point))throw new Error(`expected valid message hashed to ${U?"G2":"G1"} curve`);return C}const U=ee.Point.Fp.BYTES>ae.Point.Fp.BYTES;return{getPublicKey(C){return ae.Point.fromPrivateKey(C)},sign(C,M,G){if(G!=null)throw new Error("sign() expects 2 arguments");return v(C).assertValidity(),C.multiply(ae.normPrivateKeyToScalar(M))},verify(C,M,G,h){if(h!=null)throw new Error("verify() expects 3 arguments");C=x(C),G=ne(G);const o=G.negate(),c=ae.Point.BASE,m=v(M),E=C,W=Y(U?[{g1:o,g2:m},{g1:c,g2:E}]:[{g1:m,g2:o},{g1:E,g2:c}]);return a.eql(W,a.ONE)},aggregatePublicKeys(C){J(C),C=C.map(G=>ne(G));const M=C.reduce((G,h)=>G.add(h),ae.Point.ZERO);return M.assertValidity(),M},aggregateSignatures(C){J(C),C=C.map(G=>x(G));const M=C.reduce((G,h)=>G.add(h),ee.Point.ZERO);return M.assertValidity(),M},hash(C,M){Le(C);const G=M?{DST:M}:void 0;return ee.hashToCurve(C,G)},Signature:U?e.G2.Signature:e.G1.ShortSignature}}const D=P(b,w),te=P(w,b),{ShortSignature:d}=e.G1,{Signature:T}=e.G2;function k(ae,ee){return ae instanceof b.Point?ae:te.hash(nt("point",ae),ee==null?void 0:ee.DST)}function K(ae,ee){return ae instanceof w.Point?ae:D.hash(nt("point",ae),ee==null?void 0:ee.DST)}function Q(ae){return D.getPublicKey(ae).toBytes(!0)}function re(ae){return te.getPublicKey(ae).toBytes(!0)}function ue(ae,ee,ne){const x=K(ae,ne),v=D.sign(x,ee);return ae instanceof w.Point?v:T.toBytes(v)}function ye(ae,ee,ne){const x=k(ae,ne),v=te.sign(x,ee);return ae instanceof b.Point?v:d.toBytes(v)}function oe(ae,ee,ne,x){const v=K(ee,x);return D.verify(ae,v,ne)}function le(ae,ee,ne,x){const v=k(ee,x);return te.verify(ae,v,ne)}function Ne(ae){const ee=D.aggregatePublicKeys(ae);return ae[0]instanceof b.Point?ee:ee.toBytes(!0)}function S(ae){const ee=D.aggregateSignatures(ae);return ae[0]instanceof w.Point?ee:T.toBytes(ee)}function Be(ae){const ee=te.aggregateSignatures(ae);return ae[0]instanceof b.Point?ee:d.toBytes(ee)}function Ie(ae,ee,ne,x){if(J(ee),ne.length!==ee.length)throw new Error("amount of public keys and messages should be equal");const v=O(ae),U=ee.map(h=>K(h,x)),C=ne.map(I),M=new Map;for(let h=0;h<C.length;h++){const o=C[h],c=U[h];let m=M.get(c);m===void 0&&(m=[],M.set(c,m)),m.push(o)}const G=[];try{for(const[h,o]of M){const c=o.reduce((m,E)=>m.add(E));G.push({g1:c,g2:h})}return G.push({g1:b.Point.BASE.negate(),g2:v}),a.eql(Y(G),a.ONE)}catch{return!1}}return b.Point.BASE.precompute(4),{longSignatures:D,shortSignatures:te,millerLoopBatch:j,pairing:ie,pairingBatch:Y,verifyBatch:Ie,curves:{G1:p.Point,G2:B.Point},fields:{Fr:r,Fp:t,Fp2:n,Fp6:i,Fp12:a},params:{ateLoopSize:e.params.ateLoopSize,twistType:e.params.twistType,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:X,getPublicKey:Q,getPublicKeyForShortSignatures:re,sign:ue,signShortSignature:ye,verify:oe,verifyShortSignature:le,aggregatePublicKeys:Ne,aggregateSignatures:S,aggregateShortSignatures:Be,G1:b,G2:w,Signature:T,ShortSignature:d}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Co=BigInt(0),qr=BigInt(1),Ft=BigInt(2),qo=BigInt(3);function ss(e,t,r,n,i=1,a){const u=BigInt(a===void 0?n:a),s=r**BigInt(n),p=[];for(let b=0;b<i;b++){const B=BigInt(b+1),w=[];for(let A=0,_=qr;A<n;A++){const y=(B*_-B)/u%s;w.push(e.pow(t,y)),_*=r}p.push(w)}return p}function tl(e,t,r){const n=t.pow(r,(e.ORDER-qr)/qo),i=t.pow(r,(e.ORDER-qr)/Ft);function a(A,_){const y=t.mul(t.frobeniusMap(A,1),n),$=t.mul(t.frobeniusMap(_,1),i);return[y,$]}const u=t.pow(r,(e.ORDER**Ft-qr)/qo),s=t.pow(r,(e.ORDER**Ft-qr)/Ft);if(!t.eql(s,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function p(A,_){return[t.mul(A,u),t.neg(_)]}const b=A=>(_,y)=>{const $=y.toAffine(),V=A($.x,$.y);return _.fromAffine({x:V[0],y:V[1]})},B=b(a),w=b(p);return{psi:a,psi2:p,G2psi:B,G2psi2:w,PSI_X:n,PSI_Y:i,PSI2_X:u,PSI2_Y:s}}function rl(e){const{ORDER:t}=e,r=vr(t),n=r.create(e.NONRESIDUE||BigInt(-1)),i=r.div(r.ONE,Ft),a=ss(r,n,r.ORDER,2)[0],u=({c0:d,c1:T},{c0:k,c1:K})=>({c0:r.add(d,k),c1:r.add(T,K)}),s=({c0:d,c1:T},{c0:k,c1:K})=>({c0:r.sub(d,k),c1:r.sub(T,K)}),p=({c0:d,c1:T},k)=>{if(typeof k=="bigint")return{c0:r.mul(d,k),c1:r.mul(T,k)};const{c0:K,c1:Q}=k;let re=r.mul(d,K),ue=r.mul(T,Q);const ye=r.sub(re,ue),oe=r.sub(r.mul(r.add(d,T),r.add(K,Q)),r.add(re,ue));return{c0:ye,c1:oe}},b=({c0:d,c1:T})=>{const k=r.add(d,T),K=r.sub(d,T),Q=r.add(d,d);return{c0:r.mul(k,K),c1:r.mul(Q,T)}},B=d=>{if(d.length!==2)throw new Error("invalid tuple");const T=d.map(k=>r.create(k));return{c0:T[0],c1:T[1]}};function w(d,T){return typeof d=="bigint"&&Co<=d&&d<T}const A=t*t,_=B(e.FP2_NONRESIDUE),y={ORDER:A,isLE:r.isLE,NONRESIDUE:_,BITS:cn(A),BYTES:Math.ceil(cn(A)/8),MASK:Gr(cn(A)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:d=>d,isValid:({c0:d,c1:T})=>w(d,A)&&w(T,A),is0:({c0:d,c1:T})=>r.is0(d)&&r.is0(T),isValidNot0:d=>!y.is0(d)&&y.isValid(d),eql:({c0:d,c1:T},{c0:k,c1:K})=>r.eql(d,k)&&r.eql(T,K),neg:({c0:d,c1:T})=>({c0:r.neg(d),c1:r.neg(T)}),pow:(d,T)=>qn(y,d,T),invertBatch:d=>yr(y,d),add:u,sub:s,mul:p,sqr:b,addN:u,subN:s,mulN:p,sqrN:b,div:(d,T)=>y.mul(d,typeof T=="bigint"?r.inv(r.create(T)):y.inv(T)),inv:({c0:d,c1:T})=>{const k=r.inv(r.create(d*d+T*T));return{c0:r.mul(k,r.create(d)),c1:r.mul(k,r.create(-T))}},sqrt:d=>{if(e.Fp2sqrt)return e.Fp2sqrt(d);const{c0:T,c1:k}=d;if(r.is0(k))return ui(r,T)===1?y.create({c0:r.sqrt(T),c1:r.ZERO}):y.create({c0:r.ZERO,c1:r.sqrt(r.div(T,n))});const K=r.sqrt(r.sub(r.sqr(T),r.mul(r.sqr(k),n)));let Q=r.mul(r.add(K,T),i);ui(r,Q)===-1&&(Q=r.sub(Q,K));const ue=r.sqrt(Q),ye=y.create({c0:ue,c1:r.div(r.mul(k,i),ue)});if(!y.eql(y.sqr(ye),d))throw new Error("Cannot find square root");const oe=ye,le=y.neg(oe),{re:Ne,im:S}=y.reim(oe),{re:Be,im:Ie}=y.reim(le);return S>Ie||S===Ie&&Ne>Be?oe:le},isOdd:d=>{const{re:T,im:k}=y.reim(d),K=T%Ft,Q=T===Co,re=k%Ft;return BigInt(K||Q&&re)==qr},fromBytes(d){if(d.length!==y.BYTES)throw new Error("fromBytes invalid length="+d.length);return{c0:r.fromBytes(d.subarray(0,r.BYTES)),c1:r.fromBytes(d.subarray(r.BYTES))}},toBytes:({c0:d,c1:T})=>Ce(r.toBytes(d),r.toBytes(T)),cmov:({c0:d,c1:T},{c0:k,c1:K},Q)=>({c0:r.cmov(d,k,Q),c1:r.cmov(T,K,Q)}),reim:({c0:d,c1:T})=>({re:d,im:T}),mulByNonresidue:({c0:d,c1:T})=>y.mul({c0:d,c1:T},_),mulByB:e.Fp2mulByB,fromBigTuple:B,frobeniusMap:({c0:d,c1:T},k)=>({c0:d,c1:r.mul(T,a[k%2])})},$=({c0:d,c1:T,c2:k},{c0:K,c1:Q,c2:re})=>({c0:y.add(d,K),c1:y.add(T,Q),c2:y.add(k,re)}),V=({c0:d,c1:T,c2:k},{c0:K,c1:Q,c2:re})=>({c0:y.sub(d,K),c1:y.sub(T,Q),c2:y.sub(k,re)}),z=({c0:d,c1:T,c2:k},K)=>{if(typeof K=="bigint")return{c0:y.mul(d,K),c1:y.mul(T,K),c2:y.mul(k,K)};const{c0:Q,c1:re,c2:ue}=K,ye=y.mul(d,Q),oe=y.mul(T,re),le=y.mul(k,ue);return{c0:y.add(ye,y.mulByNonresidue(y.sub(y.mul(y.add(T,k),y.add(re,ue)),y.add(oe,le)))),c1:y.add(y.sub(y.mul(y.add(d,T),y.add(Q,re)),y.add(ye,oe)),y.mulByNonresidue(le)),c2:y.sub(y.add(oe,y.mul(y.add(d,k),y.add(Q,ue))),y.add(ye,le))}},j=({c0:d,c1:T,c2:k})=>{let K=y.sqr(d),Q=y.mul(y.mul(d,T),Ft),re=y.mul(y.mul(T,k),Ft),ue=y.sqr(k);return{c0:y.add(y.mulByNonresidue(re),K),c1:y.add(y.mulByNonresidue(ue),Q),c2:y.sub(y.sub(y.add(y.add(Q,y.sqr(y.add(y.sub(d,T),k))),re),K),ue)}},[Y,ie]=ss(y,_,r.ORDER,6,2,3),R={ORDER:y.ORDER,isLE:y.isLE,BITS:3*y.BITS,BYTES:3*y.BYTES,MASK:Gr(3*y.BITS),ZERO:{c0:y.ZERO,c1:y.ZERO,c2:y.ZERO},ONE:{c0:y.ONE,c1:y.ZERO,c2:y.ZERO},create:d=>d,isValid:({c0:d,c1:T,c2:k})=>y.isValid(d)&&y.isValid(T)&&y.isValid(k),is0:({c0:d,c1:T,c2:k})=>y.is0(d)&&y.is0(T)&&y.is0(k),isValidNot0:d=>!R.is0(d)&&R.isValid(d),neg:({c0:d,c1:T,c2:k})=>({c0:y.neg(d),c1:y.neg(T),c2:y.neg(k)}),eql:({c0:d,c1:T,c2:k},{c0:K,c1:Q,c2:re})=>y.eql(d,K)&&y.eql(T,Q)&&y.eql(k,re),sqrt:No,div:(d,T)=>R.mul(d,typeof T=="bigint"?r.inv(r.create(T)):R.inv(T)),pow:(d,T)=>qn(R,d,T),invertBatch:d=>yr(R,d),add:$,sub:V,mul:z,sqr:j,addN:$,subN:V,mulN:z,sqrN:j,inv:({c0:d,c1:T,c2:k})=>{let K=y.sub(y.sqr(d),y.mulByNonresidue(y.mul(k,T))),Q=y.sub(y.mulByNonresidue(y.sqr(k)),y.mul(d,T)),re=y.sub(y.sqr(T),y.mul(d,k)),ue=y.inv(y.add(y.mulByNonresidue(y.add(y.mul(k,Q),y.mul(T,re))),y.mul(d,K)));return{c0:y.mul(ue,K),c1:y.mul(ue,Q),c2:y.mul(ue,re)}},fromBytes:d=>{if(d.length!==R.BYTES)throw new Error("fromBytes invalid length="+d.length);return{c0:y.fromBytes(d.subarray(0,y.BYTES)),c1:y.fromBytes(d.subarray(y.BYTES,2*y.BYTES)),c2:y.fromBytes(d.subarray(2*y.BYTES))}},toBytes:({c0:d,c1:T,c2:k})=>Ce(y.toBytes(d),y.toBytes(T),y.toBytes(k)),cmov:({c0:d,c1:T,c2:k},{c0:K,c1:Q,c2:re},ue)=>({c0:y.cmov(d,K,ue),c1:y.cmov(T,Q,ue),c2:y.cmov(k,re,ue)}),fromBigSix:d=>{if(!Array.isArray(d)||d.length!==6)throw new Error("invalid Fp6 usage");return{c0:y.fromBigTuple(d.slice(0,2)),c1:y.fromBigTuple(d.slice(2,4)),c2:y.fromBigTuple(d.slice(4,6))}},frobeniusMap:({c0:d,c1:T,c2:k},K)=>({c0:y.frobeniusMap(d,K),c1:y.mul(y.frobeniusMap(T,K),Y[K%6]),c2:y.mul(y.frobeniusMap(k,K),ie[K%6])}),mulByFp2:({c0:d,c1:T,c2:k},K)=>({c0:y.mul(d,K),c1:y.mul(T,K),c2:y.mul(k,K)}),mulByNonresidue:({c0:d,c1:T,c2:k})=>({c0:y.mulByNonresidue(k),c1:d,c2:T}),mul1:({c0:d,c1:T,c2:k},K)=>({c0:y.mulByNonresidue(y.mul(k,K)),c1:y.mul(d,K),c2:y.mul(T,K)}),mul01({c0:d,c1:T,c2:k},K,Q){let re=y.mul(d,K),ue=y.mul(T,Q);return{c0:y.add(y.mulByNonresidue(y.sub(y.mul(y.add(T,k),Q),ue)),re),c1:y.sub(y.sub(y.mul(y.add(K,Q),y.add(d,T)),re),ue),c2:y.add(y.sub(y.mul(y.add(d,k),K),re),ue)}}},X=ss(y,_,r.ORDER,12,1,6)[0],J=({c0:d,c1:T},{c0:k,c1:K})=>({c0:R.add(d,k),c1:R.add(T,K)}),I=({c0:d,c1:T},{c0:k,c1:K})=>({c0:R.sub(d,k),c1:R.sub(T,K)}),O=({c0:d,c1:T},k)=>{if(typeof k=="bigint")return{c0:R.mul(d,k),c1:R.mul(T,k)};let{c0:K,c1:Q}=k,re=R.mul(d,K),ue=R.mul(T,Q);return{c0:R.add(re,R.mulByNonresidue(ue)),c1:R.sub(R.mul(R.add(d,T),R.add(K,Q)),R.add(re,ue))}},P=({c0:d,c1:T})=>{let k=R.mul(d,T);return{c0:R.sub(R.sub(R.mul(R.add(R.mulByNonresidue(T),d),R.add(d,T)),k),R.mulByNonresidue(k)),c1:R.add(k,k)}};function D(d,T){const k=y.sqr(d),K=y.sqr(T);return{first:y.add(y.mulByNonresidue(K),k),second:y.sub(y.sub(y.sqr(y.add(d,T)),k),K)}}const te={ORDER:y.ORDER,isLE:R.isLE,BITS:2*R.BITS,BYTES:2*R.BYTES,MASK:Gr(2*R.BITS),ZERO:{c0:R.ZERO,c1:R.ZERO},ONE:{c0:R.ONE,c1:R.ZERO},create:d=>d,isValid:({c0:d,c1:T})=>R.isValid(d)&&R.isValid(T),is0:({c0:d,c1:T})=>R.is0(d)&&R.is0(T),isValidNot0:d=>!te.is0(d)&&te.isValid(d),neg:({c0:d,c1:T})=>({c0:R.neg(d),c1:R.neg(T)}),eql:({c0:d,c1:T},{c0:k,c1:K})=>R.eql(d,k)&&R.eql(T,K),sqrt:No,inv:({c0:d,c1:T})=>{let k=R.inv(R.sub(R.sqr(d),R.mulByNonresidue(R.sqr(T))));return{c0:R.mul(d,k),c1:R.neg(R.mul(T,k))}},div:(d,T)=>te.mul(d,typeof T=="bigint"?r.inv(r.create(T)):te.inv(T)),pow:(d,T)=>qn(te,d,T),invertBatch:d=>yr(te,d),add:J,sub:I,mul:O,sqr:P,addN:J,subN:I,mulN:O,sqrN:P,fromBytes:d=>{if(d.length!==te.BYTES)throw new Error("fromBytes invalid length="+d.length);return{c0:R.fromBytes(d.subarray(0,R.BYTES)),c1:R.fromBytes(d.subarray(R.BYTES))}},toBytes:({c0:d,c1:T})=>Ce(R.toBytes(d),R.toBytes(T)),cmov:({c0:d,c1:T},{c0:k,c1:K},Q)=>({c0:R.cmov(d,k,Q),c1:R.cmov(T,K,Q)}),fromBigTwelve:d=>({c0:R.fromBigSix(d.slice(0,6)),c1:R.fromBigSix(d.slice(6,12))}),frobeniusMap(d,T){const{c0:k,c1:K,c2:Q}=R.frobeniusMap(d.c1,T),re=X[T%12];return{c0:R.frobeniusMap(d.c0,T),c1:R.create({c0:y.mul(k,re),c1:y.mul(K,re),c2:y.mul(Q,re)})}},mulByFp2:({c0:d,c1:T},k)=>({c0:R.mulByFp2(d,k),c1:R.mulByFp2(T,k)}),conjugate:({c0:d,c1:T})=>({c0:d,c1:R.neg(T)}),mul014:({c0:d,c1:T},k,K,Q)=>{let re=R.mul01(d,k,K),ue=R.mul1(T,Q);return{c0:R.add(R.mulByNonresidue(ue),re),c1:R.sub(R.sub(R.mul01(R.add(T,d),k,y.add(K,Q)),re),ue)}},mul034:({c0:d,c1:T},k,K,Q)=>{const re=R.create({c0:y.mul(d.c0,k),c1:y.mul(d.c1,k),c2:y.mul(d.c2,k)}),ue=R.mul01(T,K,Q),ye=R.mul01(R.add(d,T),y.add(k,K),Q);return{c0:R.add(R.mulByNonresidue(ue),re),c1:R.sub(ye,R.add(re,ue))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:r,Fp2:y,Fp6:R,Fp12:te,Fp4Square:D}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const et=BigInt(0),li=BigInt(1),ze=BigInt(2),Si=BigInt(3),wn=BigInt(4),Xt=BigInt("0xd201000000010000"),nl=cn(Xt),Er={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:et,b:wn,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},il=vr(Er.n),{Fp:pe,Fp2:de,Fp6:Ss,Fp4Square:os,Fp12:ve}=rl({ORDER:Er.p,FP2_NONRESIDUE:[li,li],Fp2mulByB:({c0:e,c1:t})=>{const r=pe.mul(e,wn),n=pe.mul(t,wn);return{c0:pe.sub(r,n),c1:pe.add(r,n)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:r,c1:n,c2:i}=e,{c0:a,c1:u,c2:s}=t,{first:p,second:b}=os(r,u),{first:B,second:w}=os(a,i),{first:A,second:_}=os(n,s),y=de.mulByNonresidue(_);return{c0:Ss.create({c0:de.add(de.mul(de.sub(p,r),ze),p),c1:de.add(de.mul(de.sub(B,n),ze),B),c2:de.add(de.mul(de.sub(A,i),ze),A)}),c1:Ss.create({c0:de.add(de.mul(de.add(y,a),ze),y),c1:de.add(de.mul(de.add(b,u),ze),b),c2:de.add(de.mul(de.add(w,s),ze),w)})}},Fp12cyclotomicExp(e,t){let r=ve.ONE;for(let n=nl-1;n>=0;n--)r=ve._cyclotomicSquare(r),Rf(t,n)&&(r=ve.mul(r,e));return r},Fp12finalExponentiate:e=>{const t=Xt,r=ve.div(ve.frobeniusMap(e,6),e),n=ve.mul(ve.frobeniusMap(r,2),r),i=ve.conjugate(ve._cyclotomicExp(n,t)),a=ve.mul(ve.conjugate(ve._cyclotomicSquare(n)),i),u=ve.conjugate(ve._cyclotomicExp(a,t)),s=ve.conjugate(ve._cyclotomicExp(u,t)),p=ve.mul(ve.conjugate(ve._cyclotomicExp(s,t)),ve._cyclotomicSquare(i)),b=ve.conjugate(ve._cyclotomicExp(p,t)),B=ve.frobeniusMap(ve.mul(i,s),2),w=ve.frobeniusMap(ve.mul(u,n),3),A=ve.frobeniusMap(ve.mul(p,ve.conjugate(n)),1),_=ve.mul(ve.mul(b,ve.conjugate(a)),n);return ve.mul(ve.mul(ve.mul(B,w),A),_)}}),{G2psi:$o,G2psi2:sl}=tl(pe,de,de.div(de.ONE,de.NONRESIDUE)),as=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:pe.ORDER,m:2,k:128,expand:"xmd",hash:qs}),zs={p:de.ORDER,n:Er.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:de.ZERO,b:de.fromBigTuple([wn,wn]),Gx:de.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:de.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Ni=En(pe.toBytes(et),{infinity:!0,compressed:!0});function Ii(e){e=e.slice();const t=e[0]&224,r=!!(t>>7&1),n=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:r,infinity:n,sort:i,value:e}}function En(e,t){if(e[0]&224)throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function ol(e,t,r){const{BYTES:n,ORDER:i}=pe,a=t.is0(),{x:u,y:s}=t.toAffine();if(r){if(a)return Ni.slice();const p=!!(s*ze/i);return En(Ye(u,n),{compressed:!0,sort:p})}else return a?Ce(Uint8Array.of(64),new Uint8Array(2*n-1)):Ce(Ye(u,n),Ye(s,n))}function cs(e){e.assertValidity();const{BYTES:t,ORDER:r}=pe,{x:n,y:i}=e.toAffine();if(e.is0())return Ni.slice();const a=!!(i*ze/r);return En(Ye(n,t),{compressed:!0,sort:a})}function al(e){const{compressed:t,infinity:r,sort:n,value:i}=Ii(e),{BYTES:a,ORDER:u}=pe;if(i.length===48&&t){const s=Tt(i),p=pe.create(s&pe.MASK);if(r){if(p!==et)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:et,y:et}}const b=pe.add(pe.pow(p,Si),pe.create(Er.b));let B=pe.sqrt(b);if(!B)throw new Error("invalid G1 point: compressed point");return B*ze/u!==BigInt(n)&&(B=pe.neg(B)),{x:pe.create(p),y:pe.create(B)}}else if(i.length===96&&!t){const s=Tt(i.subarray(0,a)),p=Tt(i.subarray(a));if(r){if(s!==et||p!==et)throw new Error("G1: non-empty point at infinity");return Ri.G1.Point.ZERO.toAffine()}return{x:pe.create(s),y:pe.create(p)}}else throw new Error("invalid G1 point: expected 48/96 bytes")}function Go(e){const{infinity:t,sort:r,value:n}=Ii(nt("signatureHex",e,48)),i=pe.ORDER,a=Ri.G1.Point,u=Tt(n);if(t)return a.ZERO;const s=pe.create(u&pe.MASK),p=pe.add(pe.pow(s,Si),pe.create(Er.b));let b=pe.sqrt(p);if(!b)throw new Error("invalid G1 point: compressed");const B=BigInt(r);b*ze/i!==B&&(b=pe.neg(b));const w=a.fromAffine({x:s,y:b});return w.assertValidity(),w}function cl(e,t,r){const{BYTES:n,ORDER:i}=pe,a=t.is0(),{x:u,y:s}=t.toAffine();if(r){if(a)return Ce(Ni,Ye(et,n));const p=!!(s.c1===et?s.c0*ze/i:s.c1*ze/i);return Ce(En(Ye(u.c1,n),{compressed:!0,sort:p}),Ye(u.c0,n))}else{if(a)return Ce(Uint8Array.of(64),new Uint8Array(4*n-1));const{re:p,im:b}=de.reim(u),{re:B,im:w}=de.reim(s);return Ce(Ye(b,n),Ye(p,n),Ye(w,n),Ye(B,n))}}function us(e){e.assertValidity();const{BYTES:t}=pe;if(e.is0())return Ce(Ni,Ye(et,t));const{x:r,y:n}=e.toAffine(),{re:i,im:a}=de.reim(r),{re:u,im:s}=de.reim(n),b=!!((s>et?s*ze:u*ze)/pe.ORDER&li),B=i;return Ce(En(Ye(a,t),{sort:b,compressed:!0}),Ye(B,t))}function ul(e){const{BYTES:t,ORDER:r}=pe,{compressed:n,infinity:i,sort:a,value:u}=Ii(e);if(!n&&!i&&a||!n&&i&&a||a&&i&&n)throw new Error("invalid encoding flag: "+(e[0]&224));const s=(p,b,B)=>Tt(p.slice(b,B));if(u.length===96&&n){if(i){if(u.reduce((y,$)=>y!==0?$+1:$,0)>0)throw new Error("invalid G2 point: compressed");return{x:de.ZERO,y:de.ZERO}}const p=s(u,0,t),b=s(u,t,2*t),B=de.create({c0:pe.create(b),c1:pe.create(p)}),w=de.add(de.pow(B,Si),zs.b);let A=de.sqrt(w);const _=A.c1===et?A.c0*ze/r:A.c1*ze/r?li:et;return A=a&&_>0?A:de.neg(A),{x:B,y:A}}else if(u.length===192&&!n){if(i){if(u.reduce((A,_)=>A!==0?_+1:_,0)>0)throw new Error("invalid G2 point: uncompressed");return{x:de.ZERO,y:de.ZERO}}const p=s(u,0*t,1*t),b=s(u,1*t,2*t),B=s(u,2*t,3*t),w=s(u,3*t,4*t);return{x:de.fromBigTuple([b,p]),y:de.fromBigTuple([w,B])}}else throw new Error("invalid G2 point: expected 96/192 bytes")}function Vo(e){const{ORDER:t}=pe,{infinity:r,sort:n,value:i}=Ii(nt("signatureHex",e)),a=Ri.G2.Point,u=i.length/2;if(u!==48&&u!==96)throw new Error("invalid compressed signature length, expected 96/192 bytes");const s=Tt(i.slice(0,u)),p=Tt(i.slice(u));if(r)return a.ZERO;const b=pe.create(s&pe.MASK),B=pe.create(p),w=de.create({c0:B,c1:b}),A=de.add(de.pow(w,Si),zs.b);let _=de.sqrt(A);if(!_)throw new Error("Failed to find a square root");const{re:y,im:$}=de.reim(_),V=BigInt(n),z=$>et&&$*ze/t!==V,j=$===et&&y*ze/t!==V;(z||j)&&(_=de.neg(_));const Y=a.fromAffine({x:w,y:_});return Y.assertValidity(),Y}const Ri=el({fields:{Fp:pe,Fp2:de,Fp6:Ss,Fp12:ve,Fr:il},G1:{...Er,Fp:pe,htfDefaults:{...as,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new e(pe.mul(t.px,r),t.py,t.pz);return t.multiplyUnsafe(Xt).negate().multiplyUnsafe(Xt).equals(n)},clearCofactor:(e,t)=>t.multiplyUnsafe(Xt).add(t),mapToCurve:pl,fromBytes:al,toBytes:ol,ShortSignature:{fromBytes(e){return Le(e),Go(e)},fromHex(e){return Go(e)},toBytes(e){return cs(e)},toRawBytes(e){return cs(e)},toHex(e){return Kr(cs(e))}}},G2:{...zs,Fp:de,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...as},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:yl,isTorsionFree:(e,t)=>t.multiplyUnsafe(Xt).negate().equals($o(e,t)),clearCofactor:(e,t)=>{const r=Xt;let n=t.multiplyUnsafe(r).negate(),i=$o(e,t),a=t.double();return a=sl(e,a),a=a.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),a=a.add(i),a=a.subtract(n),a.subtract(t)},fromBytes:ul,toBytes:cl,Signature:{fromBytes(e){return Le(e),Vo(e)},fromHex(e){return Vo(e)},toBytes(e){return us(e)},toRawBytes(e){return us(e)},toHex(e){return Kr(us(e))}}},params:{ateLoopSize:Xt,r:Er.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:as,hash:qs}),fl=Bc(de,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(e=>e.map(t=>de.fromBigTuple(t.map(BigInt))))),ll=Bc(pe,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),hl=Sc(pe,{A:pe.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:pe.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:pe.create(BigInt(11))}),dl=Sc(de,{A:de.create({c0:pe.create(et),c1:pe.create(BigInt(240))}),B:de.create({c0:pe.create(BigInt(1012)),c1:pe.create(BigInt(1012))}),Z:de.create({c0:pe.create(BigInt(-2)),c1:pe.create(BigInt(-1))})});function pl(e){const{x:t,y:r}=hl(pe.create(e[0]));return ll(t,r)}function yl(e){const{x:t,y:r}=dl(de.fromBigTuple(e));return fl(t,r)}function gl(e,t,r){const n=typeof e=="string"?e:Pe(e),i=typeof t=="string"?t:Pe(t),a=typeof r=="string"?r:Pe(r);return Ri.verifyShortSignature(i,a,n)}const Nc=e=>je(new Yr(e)),Ws=e=>{const t=Nc(e);return new Date(Number(t)/1e6)};var wl=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},ml=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},$n;class vt extends ke{constructor(t){super(`Invalid certificate: ${t}`)}}var ut;(function(e){e[e.Empty=0]="Empty",e[e.Fork=1]="Fork",e[e.Labeled=2]="Labeled",e[e.Leaf=3]="Leaf",e[e.Pruned=4]="Pruned"})(ut||(ut={}));function bl(e,t){const r=new Uint8Array(e),n=new Uint8Array(t);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class gr{constructor(t,r,n,i,a=5,u=!1){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=a,$n.set(this,!1),wl(this,$n,u,"f"),this.cert=Mt(new Uint8Array(t))}static async create(t){const r=gr.createUnverified(t);return await r.verify(),r}static createUnverified(t){let r=t.blsVerify;return r||(r=gl),new gr(t.certificate,t.rootKey,t.canisterId,r,t.maxAgeInMinutes,t.disableTimeVerification)}lookup(t){return Wr(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await Gn(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=xl(r),a=gt(tn("ic-state-root"),t);let u=!1;const s=lt(this.lookup(["time"]));if(!s)throw new vt("Certificate does not contain a time");if(!ml(this,$n,"f")){const b=this._maxAgeInMinutes*60*1e3,B=Date.now(),w=B-b,A=B+3e5,_=Ws(s);if(_.getTime()<w)throw new vt(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+_.toISOString()+" Current time: "+new Date(B).toISOString());if(_.getTime()>A)throw new vt("Certificate is signed more than 5 minutes in the future. Certificate time: "+_.toISOString()+" Current time: "+new Date(B).toISOString())}try{u=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(a))}catch{u=!1}if(!u)throw new vt("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const r=await gr.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new vt("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==Yl&&!Ic({canisterId:this._canisterId,subnetId:_e.fromUint8Array(new Uint8Array(t.subnet_id)),tree:r.cert.tree}))throw new vt(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Pe(t.subnet_id)}`);const n=lt(r.lookup(["subnet",t.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${Pe(t.subnet_id)}`);return n}}$n=new WeakMap;const Jr=qt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),_l=96;function xl(e){const t=Jr.byteLength+_l;if(e.byteLength!==t)throw new TypeError(`BLS DER-encoded public key must be ${t} bytes long`);const r=e.slice(0,Jr.byteLength);if(!bn(r,Jr))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Jr}, but get ${r}`);return e.slice(Jr.byteLength)}function lt(e){if(e.status===Ve.Found){if(e.value instanceof ArrayBuffer)return e.value;if(e.value instanceof Uint8Array)return e.value.buffer}}async function Gn(e){switch(e[0]){case ut.Empty:return yt(tn("ic-hashtree-empty"));case ut.Pruned:return e[1];case ut.Leaf:return yt(gt(tn("ic-hashtree-leaf"),e[1]));case ut.Labeled:return yt(gt(tn("ic-hashtree-labeled"),e[1],await Gn(e[2])));case ut.Fork:return yt(gt(tn("ic-hashtree-fork"),await Gn(e[1]),await Gn(e[2])));default:throw new Error("unreachable")}}function tn(e){const t=new Uint8Array([e.length]),r=new TextEncoder().encode(e);return gt(t,r)}var Ve;(function(e){e.Unknown="unknown",e.Absent="absent",e.Found="found"})(Ve||(Ve={}));var Pt;(function(e){e.Less="less",e.Greater="greater"})(Pt||(Pt={}));function Wr(e,t){if(e.length===0)switch(t[0]){case ut.Leaf:{if(!t[1])throw new Error("Invalid tree structure for leaf");return t[1]instanceof ArrayBuffer?{status:Ve.Found,value:t[1]}:t[1]instanceof Uint8Array?{status:Ve.Found,value:t[1].buffer}:{status:Ve.Found,value:t[1]}}default:return{status:Ve.Found,value:t}}const r=typeof e[0]=="string"?new TextEncoder().encode(e[0]):e[0],n=Vn(r,t);switch(n.status){case Ve.Found:return Wr(e.slice(1),n.value);case Pt.Greater:case Pt.Less:return{status:Ve.Absent};default:return n}}function Ns(e){switch(e[0]){case ut.Empty:return[];case ut.Fork:return Ns(e[1]).concat(Ns(e[2]));default:return[e]}}function Vn(e,t){switch(t[0]){case ut.Labeled:return bl(e,t[1])?{status:Pt.Greater}:bn(e,t[1])?{status:Ve.Found,value:t[2]}:{status:Pt.Less};case ut.Fork:const r=Vn(e,t[1]);switch(r.status){case Pt.Greater:{const n=Vn(e,t[2]);return n.status===Pt.Less?{status:Ve.Absent}:n}case Ve.Unknown:{let n=Vn(e,t[2]);return n.status===Pt.Less?{status:Ve.Unknown}:n}default:return r}case ut.Pruned:return{status:Ve.Unknown};default:return{status:Ve.Absent}}}function Ic(e){const{canisterId:t,subnetId:r,tree:n}=e,i=Wr(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Ve.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return Mt(i.value).map(p=>[_e.fromUint8Array(p[0]),_e.fromUint8Array(p[1])]).some(p=>p[0].ltEq(t)&&p[1].gtEq(t))}class El{constructor(t,r,n){this.key=t,this.path=r,this.decodeStrategy=n}}const Rc=async e=>{const{agent:t,paths:r}=e,n=_e.from(e.canisterId),i=[...new Set(r)],a=i.map(p=>Is(p,n)),u=new Map,s=i.map((p,b)=>(async()=>{var B;try{const w=await t.readState(n,{paths:[a[b]]});if(t.rootKey==null)throw new Error("Agent is missing root key");const A=await gr.create({certificate:w.certificate,rootKey:t.rootKey,canisterId:n,disableTimeVerification:!0}),_=(V,z)=>{if(z==="subnet"){if(t.rootKey==null)throw new Error("Agent is missing root key");const j=Uc(w.certificate,n,t.rootKey);return{path:z,data:j}}else return{path:z,data:lt(V.lookup(Is(z,n)))}},{path:y,data:$}=_(A,i[b]);if(!$)console.warn(`Expected to find result for path ${y}, but instead found nothing.`),typeof y=="string"?u.set(y,null):u.set(y.key,null);else switch(y){case"time":{u.set(y,Ws($));break}case"controllers":{u.set(y,Bl($));break}case"module_hash":{u.set(y,Ho($));break}case"subnet":{u.set(y,$);break}case"candid":{u.set(y,new TextDecoder().decode($));break}default:if(typeof y!="string"&&"key"in y&&"path"in y)switch(y.decodeStrategy){case"raw":u.set(y.key,$);break;case"leb128":{u.set(y.key,Nc($));break}case"cbor":{u.set(y.key,Oc($));break}case"hex":{u.set(y.key,Ho($));break}case"utf-8":u.set(y.key,vl($))}}}catch(w){if(!((B=w==null?void 0:w.message)===null||B===void 0)&&B.includes("Invalid certificate"))throw new ke(w.message);typeof p!="string"&&"key"in p&&"path"in p?u.set(p.key,null):u.set(p,null),console.group(),console.warn(`Expected to find result for path ${p}, but instead found nothing.`),console.warn(w),console.groupEnd()}})());return await Promise.all(s),u},Uc=(e,t,r)=>{if(!t._isPrincipal)throw new Error("Invalid canisterId");const n=Mt(new Uint8Array(e)),i=n.tree;let a=n.delegation,u;if(a&&a.subnet_id?u=_e.fromUint8Array(new Uint8Array(a.subnet_id)):!a&&typeof r<"u"?(u=_e.selfAuthenticating(new Uint8Array(r)),a={subnet_id:u.toUint8Array(),certificate:new ArrayBuffer(0)}):(u=_e.selfAuthenticating(_e.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),a={subnet_id:u.toUint8Array(),certificate:new ArrayBuffer(0)}),!Ic({canisterId:t,subnetId:u,tree:i}))throw new Error("Canister not in range");const p=Wr(["subnet",a.subnet_id,"node"],i);if(p.status!==Ve.Found)throw new Error("Node not found");if(p.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const b=Ns(p.value),B=new Map;return b.forEach(w=>{const A=_e.from(new Uint8Array(w[1])).toText(),_=Wr(["public_key"],w[2]);if(_.status!==Ve.Found)throw new Error("Public key not found");const y=_.value;if(y.byteLength!==44)throw new Error("Invalid public key length");B.set(A,y)}),{subnetId:_e.fromUint8Array(new Uint8Array(a.subnet_id)).toText(),nodeKeys:B}},Is=(e,t)=>{const r=new TextEncoder,n=a=>new DataView(r.encode(a).buffer).buffer,i=new DataView(t.toUint8Array().buffer).buffer;switch(e){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in e&&"path"in e)if(typeof e.path=="string"||e.path instanceof ArrayBuffer){const a=e.path,u=typeof a=="string"?n(a):a;return[n("canister"),i,n("metadata"),u]}else return e.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${e} was formatted correctly.`)},Ho=e=>Pe(e),Oc=e=>Mt(e),vl=e=>new TextDecoder().decode(e),Bl=e=>Oc(e).map(r=>_e.fromUint8Array(new Uint8Array(r))),Al=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:El,encodePath:Is,fetchNodeKeys:Uc,request:Rc},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),tt=BigInt(1),fs=BigInt(2),Tl=BigInt(8),Sl={zip215:!0};function Nl(e,t,r,n){const i=e.sqr(r),a=e.sqr(n),u=e.add(e.mul(t.a,i),a),s=e.add(e.ONE,e.mul(t.d,e.mul(i,a)));return e.eql(u,s)}function Il(e,t={}){const{Fp:r,Fn:n}=vc("edwards",e,t),{h:i,n:a}=e;xn(t,{},{uvRatio:"function"});const u=fs<<BigInt(n.BYTES*8)-tt,s=$=>r.create($),p=t.uvRatio||(($,V)=>{try{return{isValid:!0,value:r.sqrt(r.div($,V))}}catch{return{isValid:!1,value:_t}}});if(!Nl(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function b($,V,z=!1){const j=z?tt:_t;return en("coordinate "+$,V,j,u),V}function B($){if(!($ instanceof _))throw new Error("ExtendedPoint expected")}const w=yn(($,V)=>{const{ex:z,ey:j,ez:Y}=$,ie=$.is0();V==null&&(V=ie?Tl:r.inv(Y));const R=s(z*V),X=s(j*V),J=s(Y*V);if(ie)return{x:_t,y:tt};if(J!==tt)throw new Error("invZ was invalid");return{x:R,y:X}}),A=yn($=>{const{a:V,d:z}=e;if($.is0())throw new Error("bad point: ZERO");const{ex:j,ey:Y,ez:ie,et:R}=$,X=s(j*j),J=s(Y*Y),I=s(ie*ie),O=s(I*I),P=s(X*V),D=s(I*s(P+J)),te=s(O+s(z*s(X*J)));if(D!==te)throw new Error("bad point: equation left != right (1)");const d=s(j*Y),T=s(ie*R);if(d!==T)throw new Error("bad point: equation left != right (2)");return!0});class _{constructor(V,z,j,Y){this.ex=b("x",V),this.ey=b("y",z),this.ez=b("z",j,!0),this.et=b("t",Y),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(V){if(V instanceof _)throw new Error("extended point not allowed");const{x:z,y:j}=V||{};return b("x",z),b("y",j),new _(z,j,tt,s(z*j))}static normalizeZ(V){return fi(_,"ez",V)}static msm(V,z){return Ec(_,n,V,z)}_setWindowSize(V){this.precompute(V)}precompute(V=8,z=!0){return y.setWindowSize(this,V),z||this.multiply(fs),this}assertValidity(){A(this)}equals(V){B(V);const{ex:z,ey:j,ez:Y}=this,{ex:ie,ey:R,ez:X}=V,J=s(z*X),I=s(ie*Y),O=s(j*X),P=s(R*Y);return J===I&&O===P}is0(){return this.equals(_.ZERO)}negate(){return new _(s(-this.ex),this.ey,this.ez,s(-this.et))}double(){const{a:V}=e,{ex:z,ey:j,ez:Y}=this,ie=s(z*z),R=s(j*j),X=s(fs*s(Y*Y)),J=s(V*ie),I=z+j,O=s(s(I*I)-ie-R),P=J+R,D=P-X,te=J-R,d=s(O*D),T=s(P*te),k=s(O*te),K=s(D*P);return new _(d,T,K,k)}add(V){B(V);const{a:z,d:j}=e,{ex:Y,ey:ie,ez:R,et:X}=this,{ex:J,ey:I,ez:O,et:P}=V,D=s(Y*J),te=s(ie*I),d=s(X*j*P),T=s(R*O),k=s((Y+ie)*(J+I)-D-te),K=T-d,Q=T+d,re=s(te-z*D),ue=s(k*K),ye=s(Q*re),oe=s(k*re),le=s(K*Q);return new _(ue,ye,le,oe)}subtract(V){return this.add(V.negate())}multiply(V){const z=V;en("scalar",z,tt,a);const{p:j,f:Y}=y.wNAFCached(this,z,_.normalizeZ);return _.normalizeZ([j,Y])[0]}multiplyUnsafe(V,z=_.ZERO){const j=V;return en("scalar",j,_t,a),j===_t?_.ZERO:this.is0()||j===tt?this:y.wNAFCachedUnsafe(this,j,_.normalizeZ,z)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return y.wNAFCachedUnsafe(this,a).is0()}toAffine(V){return w(this,V)}clearCofactor(){return i===tt?this:this.multiplyUnsafe(i)}static fromBytes(V,z=!1){return Le(V),this.fromHex(V,z)}static fromHex(V,z=!1){const{d:j,a:Y}=e,ie=r.BYTES;V=nt("pointHex",V,ie),dn("zip215",z);const R=V.slice(),X=V[ie-1];R[ie-1]=X&-129;const J=pn(R),I=z?u:r.ORDER;en("pointHex.y",J,_t,I);const O=s(J*J),P=s(O-tt),D=s(j*O-Y);let{isValid:te,value:d}=p(P,D);if(!te)throw new Error("Point.fromHex: invalid y coordinate");const T=(d&tt)===tt,k=(X&128)!==0;if(!z&&d===_t&&k)throw new Error("Point.fromHex: x=0 and x_0=1");return k!==T&&(d=s(-d)),_.fromAffine({x:d,y:J})}static fromPrivateScalar(V){return _.BASE.multiply(V)}toBytes(){const{x:V,y:z}=this.toAffine(),j=Ti(z,r.BYTES);return j[j.length-1]|=V&tt?128:0,j}toRawBytes(){return this.toBytes()}toHex(){return Kr(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(e.Gx,e.Gy,tt,s(e.Gx*e.Gy)),_.ZERO=new _(_t,tt,tt,_t),_.Fp=r,_.Fn=n;const y=xc(_,n.BYTES*8);return _}function Rl(e,t){xn(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r,hash:n}=t,{BASE:i,Fp:a,Fn:u}=e,s=u.ORDER,p=t.randomBytes||da,b=t.adjustScalarBytes||(R=>R),B=t.domain||((R,X,J)=>{if(dn("phflag",J),X.length||J)throw new Error("Contexts/pre-hash are not supported");return R});function w(R){return u.create(R)}function A(R){return w(pn(R))}function _(R){const X=a.BYTES;R=nt("private key",R,X);const J=nt("hashed private key",n(R),2*X),I=b(J.slice(0,X)),O=J.slice(X,2*X),P=A(I);return{head:I,prefix:O,scalar:P}}function y(R){const{head:X,prefix:J,scalar:I}=_(R),O=i.multiply(I),P=O.toBytes();return{head:X,prefix:J,scalar:I,point:O,pointBytes:P}}function $(R){return y(R).pointBytes}function V(R=Uint8Array.of(),...X){const J=Ce(...X);return A(n(B(J,nt("context",R),!!r)))}function z(R,X,J={}){R=nt("message",R),r&&(R=r(R));const{prefix:I,scalar:O,pointBytes:P}=y(X),D=V(J.context,I,R),te=i.multiply(D).toBytes(),d=V(J.context,te,P,R),T=w(D+d*O);en("signature.s",T,_t,s);const k=a.BYTES,K=Ce(te,Ti(T,k));return nt("result",K,k*2)}const j=Sl;function Y(R,X,J,I=j){const{context:O,zip215:P}=I,D=a.BYTES;R=nt("signature",R,2*D),X=nt("message",X),J=nt("publicKey",J,D),P!==void 0&&dn("zip215",P),r&&(X=r(X));const te=pn(R.slice(D,2*D));let d,T,k;try{d=e.fromHex(J,P),T=e.fromHex(R.slice(0,D),P),k=i.multiplyUnsafe(te)}catch{return!1}if(!P&&d.isSmallOrder())return!1;const K=V(O,T.toBytes(),d.toBytes(),X);return T.add(d.multiplyUnsafe(K)).subtract(k).clearCofactor().is0()}return i.precompute(8),{getPublicKey:$,sign:z,verify:Y,utils:{getExtendedPublicKey:y,randomPrivateKey:()=>p(a.BYTES),precompute(R=8,X=e.BASE){return X.precompute(R,!1)}},Point:e}}function Ul(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=vr(t.n,e.nBitLength,!0),i={Fp:r,Fn:n,uvRatio:e.uvRatio},a={hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:i,eddsaOpts:a}}function Ol(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}function Fl(e){const{CURVE:t,curveOpts:r,eddsaOpts:n}=Ul(e),i=Il(t,r),a=Rl(i,n);return Ol(e,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(0);const Pl=BigInt(1),Ko=BigInt(2);BigInt(3);const kl=BigInt(5),Ml=BigInt(8),Ui={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Ml,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Cl(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),a=Ui.p,s=e*e%a*e%a,p=mt(s,Ko,a)*s%a,b=mt(p,Pl,a)*e%a,B=mt(b,kl,a)*b%a,w=mt(B,t,a)*B%a,A=mt(w,r,a)*w%a,_=mt(A,n,a)*A%a,y=mt(_,i,a)*_%a,$=mt(y,i,a)*_%a,V=mt($,t,a)*B%a;return{pow_p_5_8:mt(V,Ko,a)*e%a,b2:s}}function ql(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const jo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function $l(e,t){const r=Ui.p,n=Ge(t*t*t,r),i=Ge(n*n*t,r),a=Cl(e*i).pow_p_5_8;let u=Ge(e*n*a,r);const s=Ge(t*u*u,r),p=u,b=Ge(u*jo,r),B=s===e,w=s===Ge(-e,r),A=s===Ge(-e*jo,r);return B&&(u=p),(w||A)&&(u=b),Mf(u,r)&&(u=Ge(-u,r)),{isValid:B||w,value:u}}const Gl=vr(Ui.p,void 0,!0),Vl={...Ui,Fp:Gl,hash:Zu,adjustScalarBytes:ql,uvRatio:$l},Ir=Fl(Vl);var zo=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},rt=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Je,rn,Fc,Pc;class Hl{constructor(t={}){Je.set(this,void 0),rn.set(this,void 0),this[Fc]=this.entries.bind(this),this[Pc]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=t,i=Date.now();zo(this,Je,new Map([...r].map(([a,u])=>[a,{value:u,timestamp:i}])),"f"),zo(this,rn,n,"f")}prune(){const t=Date.now();for(const[r,n]of rt(this,Je,"f").entries())t-n.timestamp>rt(this,rn,"f")&&rt(this,Je,"f").delete(r);return this}set(t,r){this.prune();const n={value:r,timestamp:Date.now()};return rt(this,Je,"f").set(t,n),this}get(t){const r=rt(this,Je,"f").get(t);if(r!==void 0){if(Date.now()-r.timestamp>rt(this,rn,"f")){rt(this,Je,"f").delete(t);return}return r.value}}clear(){rt(this,Je,"f").clear()}entries(){const t=rt(this,Je,"f").entries();return function*(){for(const[n,i]of t)yield[n,i.value]}()}values(){const t=rt(this,Je,"f").values();return function*(){for(const n of t)yield n.value}()}keys(){return rt(this,Je,"f").keys()}forEach(t,r){for(const[n,i]of rt(this,Je,"f").entries())t.call(r,i.value,n,this)}has(t){return rt(this,Je,"f").has(t)}delete(t){return rt(this,Je,"f").delete(t)}get size(){return rt(this,Je,"f").size}}Je=new WeakMap,rn=new WeakMap,Fc=Symbol.iterator,Pc=Symbol.toStringTag;const Wo=e=>{if(e<=127)return 1;if(e<=255)return 2;if(e<=65535)return 3;if(e<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Yo=(e,t,r)=>{if(r<=127)return e[t]=r,1;if(r<=255)return e[t]=129,e[t+1]=r,2;if(r<=65535)return e[t]=130,e[t+1]=r>>8,e[t+2]=r,3;if(r<=16777215)return e[t]=131,e[t+1]=r>>16,e[t+2]=r>>8,e[t+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Rs=(e,t)=>{if(e[t]<128)return 1;if(e[t]===128)throw new Error("Invalid length 0");if(e[t]===129)return 2;if(e[t]===130)return 3;if(e[t]===131)return 4;throw new Error("Length too long (> 4 bytes)")},Kl=(e,t)=>{const r=Rs(e,t);if(r===1)return e[t];if(r===2)return e[t+1];if(r===3)return(e[t+1]<<8)+e[t+2];if(r===4)return(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const hi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function kc(e,t){const r=2+Wo(e.byteLength+1),n=t.byteLength+r+e.byteLength;let i=0;const a=new Uint8Array(1+Wo(n)+n);return a[i++]=48,i+=Yo(a,i,n),a.set(t,i),i+=t.byteLength,a[i++]=3,i+=Yo(a,i,e.byteLength+1),a[i++]=0,a.set(new Uint8Array(e),i),a}const Mc=(e,t)=>{let r=0;const n=(s,p)=>{if(i[r++]!==s)throw new Error("Expected: "+p)},i=new Uint8Array(e);if(n(48,"sequence"),r+=Rs(i,r),!bn(i.slice(r,r+t.byteLength),t))throw new Error("Not the expected OID.");r+=t.byteLength,n(3,"bit string");const a=Kl(i,r)-1;r+=Rs(i,r),n(0,"0 padding");const u=i.slice(r);if(a!==u.length)throw new Error(`DER payload mismatch: Expected length ${a} actual length ${u.length}`);return u};var Zo=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Lo=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Hn,Kn;let Cc=class nn{constructor(t){if(Hn.set(this,void 0),Kn.set(this,void 0),t.byteLength!==nn.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Zo(this,Hn,t,"f"),Zo(this,Kn,nn.derEncode(t),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(t){return new nn(t)}static fromDer(t){return new nn(this.derDecode(t))}static derEncode(t){return kc(t,hi).buffer}static derDecode(t){const r=Mc(t,hi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return Lo(this,Hn,"f")}get derKey(){return Lo(this,Kn,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Hn=new WeakMap,Kn=new WeakMap;Cc.RAW_KEY_LENGTH=32;class jl{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter(r=>r!==t)}notify(t,...r){this.observers.forEach(n=>n(t,...r))}}class zl extends jl{constructor(){super()}print(t,...r){this.notify({message:t,level:"info"},...r)}warn(t,...r){this.notify({message:t,level:"warn"},...r)}error(t,r,...n){this.notify({message:t,level:"error",error:r},...n)}}var bt=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},De=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},xt,jn,zn,Wn,Yn,Zn,Ln,Xn,Rr;const qc=.5,$c=1.5,Gc=500,Vc=6e4,Hc=9e5,Kc=10;class Oi{constructor(t=Oi.default){xt.set(this,void 0),jn.set(this,void 0),zn.set(this,void 0),Wn.set(this,void 0),Yn.set(this,void 0),Zn.set(this,void 0),Ln.set(this,void 0),Xn.set(this,void 0),Rr.set(this,0);const{initialInterval:r=Gc,randomizationFactor:n=qc,multiplier:i=$c,maxInterval:a=Vc,maxElapsedTime:u=Hc,maxIterations:s=Kc,date:p=Date}=t;bt(this,xt,r,"f"),bt(this,jn,n,"f"),bt(this,zn,i,"f"),bt(this,Wn,a,"f"),bt(this,Xn,p,"f"),bt(this,Yn,p.now(),"f"),bt(this,Zn,u,"f"),bt(this,Ln,s,"f")}get ellapsedTimeInMsec(){return De(this,Xn,"f").now()-De(this,Yn,"f")}get currentInterval(){return De(this,xt,"f")}get count(){return De(this,Rr,"f")}get randomValueFromInterval(){const t=De(this,jn,"f")*De(this,xt,"f"),r=De(this,xt,"f")-t,n=De(this,xt,"f")+t;return Math.random()*(n-r)+r}incrementCurrentInterval(){var t;return bt(this,xt,Math.min(De(this,xt,"f")*De(this,zn,"f"),De(this,Wn,"f")),"f"),bt(this,Rr,(t=De(this,Rr,"f"),t++,t),"f"),De(this,xt,"f")}next(){return this.ellapsedTimeInMsec>=De(this,Zn,"f")||De(this,Rr,"f")>=De(this,Ln,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}xt=new WeakMap,jn=new WeakMap,zn=new WeakMap,Wn=new WeakMap,Yn=new WeakMap,Zn=new WeakMap,Ln=new WeakMap,Xn=new WeakMap,Rr=new WeakMap;Oi.default={initialInterval:Gc,randomizationFactor:qc,multiplier:$c,maxInterval:Vc,maxElapsedTime:Hc,maxIterations:Kc,date:Date};var We=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},ce=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Qe,ar,Vr,Et,Ut,$r,sn,Ur,dt,pt,cr,ur,on,Or,Fr,fr,hr,jc,Dn,Jn,lr,Ot;(function(e){e.Received="received",e.Processing="processing",e.Replied="replied",e.Rejected="rejected",e.Unknown="unknown",e.Done="done"})(Ot||(Ot={}));const On=60*1e3,Wl="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",Yl="aaaaa-aa",Zl="ic0.app",Ll=".ic0.app",Xl="icp0.io",Dl=".icp0.io",Jl="icp-api.io",Ql=".icp-api.io";class ls extends ke{constructor(t){super(t),this.message=t}}class Fn extends ke{constructor(t){super(t),this.message=t}}function e0(){let e;if(typeof window<"u")if(window.fetch)e=window.fetch.bind(window);else throw new ls("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)e=global.fetch.bind(global);else throw new ls("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(e=self.fetch.bind(self));if(e)return e;throw new ls("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function t0(e){let t;if(e!==void 0)!e.match(/^[a-z]+:/)&&typeof window<"u"?t=new URL(window.location.protocol+"//"+e):t=new URL(e);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,a=i==null?void 0:i.hostname;let u;a&&typeof a=="string"&&(n.some(s=>a.endsWith(s))?u=a:u=r.find(s=>a.endsWith(s))),i&&u?t=new URL(`${i.protocol}//${u}${i.port?":"+i.port:""}`):t=new URL("https://icp-api.io")}return t.toString()}class er{constructor(t={}){var r,n;Qe.add(this),ar.set(this,null),Vr.set(this,!1),Et.set(this,void 0),Ut.set(this,void 0),$r.set(this,void 0),sn.set(this,void 0),Ur.set(this,0),dt.set(this,void 0),pt.set(this,void 0),cr.set(this,void 0),ur.set(this,void 0),this._isAgent=!0,this.config={},on.set(this,0),this.log=new zl,Or.set(this,[]),Fr.set(this,[]),fr.set(this,new Hl({expirationTime:5*60*1e3})),hr.set(this,!0),Jn.set(this,(u,s)=>{if(ce(this,hr,"f")===!1)return u;if(!s)throw new vt("Invalid signature from replica signed query: no matching node key found.");const{status:p,signatures:b=[],requestId:B}=u,w=kt(new TextEncoder().encode("\vic-response"));for(const A of b){const{timestamp:_,identity:y}=A,$=_e.fromUint8Array(y).toText();let V;if(p==="replied"){const{reply:R}=u;V=oi({status:p,reply:R,timestamp:BigInt(_),request_id:B})}else if(p==="rejected"){const{reject_code:R,reject_message:X,error_code:J}=u;V=oi({status:p,reject_code:R,reject_message:X,error_code:J,timestamp:BigInt(_),request_id:B})}else throw new Error(`Unknown status: ${p}`);const z=gt(w,kt(new Uint8Array(V))),j=s==null?void 0:s.nodeKeys.get($);if(!j)throw new vt("Invalid signature from replica signed query: no matching node key found.");const Y=Cc.fromDer(j).rawKey;if(Ir.verify(A.signature,new Uint8Array(z),new Uint8Array(Y)))return u;throw new vt(`Invalid signature from replica ${$} signed query.`)}return u}),this.config=t,We(this,Ut,t.fetch||e0()||fetch.bind(global),"f"),We(this,$r,t.fetchOptions,"f"),We(this,sn,t.callOptions,"f"),We(this,Vr,(r=t.shouldFetchRootKey)!==null&&r!==void 0?r:!1,"f"),t.rootKey?this.rootKey=t.rootKey:ce(this,Vr,"f")?this.rootKey=null:this.rootKey=qt(Wl);const i=t0(t.host);this.host=new URL(i),t.verifyQuerySignatures!==void 0&&We(this,hr,t.verifyQuerySignatures,"f"),We(this,pt,(n=t.retryTimes)!==null&&n!==void 0?n:3,"f");const a=()=>new Oi({maxIterations:ce(this,pt,"f")});if(We(this,cr,t.backoffStrategy||a,"f"),this.host.hostname.endsWith(Ll)?this.host.hostname=Zl:this.host.hostname.endsWith(Dl)?this.host.hostname=Xl:this.host.hostname.endsWith(Ql)&&(this.host.hostname=Jl),t.credentials){const{name:u,password:s}=t.credentials;We(this,dt,`${u}${s?":"+s:""}`,"f")}if(We(this,Et,Promise.resolve(t.identity||new ai),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new ke(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new ke(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);We(this,ur,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",So(Bs)),t.useQueryNonces&&this.addTransform("query",So(Bs)),t.logToConsole&&this.log.subscribe(u=>{u.level==="error"?console.error(u.message):u.level==="warn"?console.warn(u.message):console.log(u.message)})}get waterMark(){return ce(this,on,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const r=er.createSync(t),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&t.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(t){var r;try{return"config"in t?await er.create(t.config):await er.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:(r=t._identity)!==null&&r!==void 0?r:void 0})}catch{throw new ke("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return t==="127.0.0.1"||t.endsWith("127.0.0.1")}addTransform(t,r,n=r.priority||0){if(t==="update"){const i=ce(this,Fr,"f").findIndex(a=>(a.priority||0)<n);ce(this,Fr,"f").splice(i>=0?i:ce(this,Fr,"f").length,0,Object.assign(r,{priority:n}))}else if(t==="query"){const i=ce(this,Or,"f").findIndex(a=>(a.priority||0)<n);ce(this,Or,"f").splice(i>=0?i:ce(this,Or,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!ce(this,Et,"f"))throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ce(this,Et,"f")).getPrincipal()}async call(t,r,n){var i,a;await ce(this,Qe,"m",lr).call(this);const u=(i=r.callSync)!==null&&i!==void 0?i:!0,s=await(n!==void 0?await n:await ce(this,Et,"f"));if(!s)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const p=_e.from(t),b=r.effectiveCanisterId?_e.from(r.effectiveCanisterId):p,B=s.getPrincipal()||_e.anonymous();let w=new Rn(ce(this,ur,"f")*On);Math.abs(ce(this,Ur,"f"))>1e3*30&&(w=new Rn(ce(this,ur,"f")*On+ce(this,Ur,"f")));const A={request_type:vs.Call,canister_id:p,method_name:r.methodName,arg:r.arg,sender:B,ingress_expiry:w};let _=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,dt,"f")?{Authorization:"Basic "+btoa(ce(this,dt,"f"))}:{})},endpoint:"call",body:A}),y;r!=null&&r.nonce?y=$(r.nonce):_.body.nonce?y=$(_.body.nonce):y=void 0,A.nonce=y;function $(Y){return new Uint8Array(Y)}_=await s.transformRequest(_);const V=Qi(_.body),z=ce(this,cr,"f").call(this),j=hn(A);try{const Y=()=>(this.log.print(`fetching "/api/v3/canister/${b.toText()}/call" with request:`,_),ce(this,Ut,"f").call(this,""+new URL(`/api/v3/canister/${b.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,sn,"f")),_.request),{body:V}))),ie=()=>(this.log.print(`fetching "/api/v2/canister/${b.toText()}/call" with request:`,_),ce(this,Ut,"f").call(this,""+new URL(`/api/v2/canister/${b.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,sn,"f")),_.request),{body:V}))),X=await ce(this,Qe,"m",Dn).call(this,{request:u?Y:ie,backoff:z,tries:0}),J=await X.arrayBuffer(),I=X.status===200&&J.byteLength>0?Mt(J):null;if(I&&"certificate"in I){const O=await this.parseTimeFromResponse({certificate:I.certificate});We(this,on,O,"f")}return{requestId:j,response:{ok:X.ok,status:X.status,statusText:X.statusText,body:I,headers:Qr(X.headers)},requestDetails:A}}catch(Y){if(Y.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},r),{callSync:!1}),n);const ie=`Error while making call: ${(a=Y.message)!==null&&a!==void 0?a:String(Y)}`,R=new Sf(ie,Y,Pe(j),Pe(_.body.sender_pubkey),Pe(_.body.sender_sig),String(_.body.content.ingress_expiry._value));throw this.log.error(ie,R),R}}async query(t,r,n){var i,a,u,s;await ce(this,Qe,"m",lr).call(this);const p=ce(this,cr,"f").call(this),b=r.effectiveCanisterId?_e.from(r.effectiveCanisterId):_e.from(t);this.log.print(`ecid ${b.toString()}`),this.log.print(`canisterId ${t.toString()}`);let B,w;const A=await(n!==void 0?n:ce(this,Et,"f"));if(!A)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const _=_e.from(t),y=(A==null?void 0:A.getPrincipal())||_e.anonymous(),$={request_type:"query",canister_id:_,method_name:r.methodName,arg:r.arg,sender:y,ingress_expiry:new Rn(ce(this,ur,"f")*On)},V=hn($);B=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,dt,"f")?{Authorization:"Basic "+btoa(ce(this,dt,"f"))}:{})},endpoint:"read",body:$}),B=await(A==null?void 0:A.transformRequest(B));const z=Qi(B.body),j={canister:_.toText(),ecid:b,transformedRequest:B,body:z,requestId:V,backoff:p,tries:0},Y=async()=>({requestDetails:$,query:await ce(this,Qe,"m",jc).call(this,j)}),ie=async()=>{if(!ce(this,hr,"f"))return;const R=ce(this,fr,"f").get(b.toString());return R||(await this.fetchSubnetKeys(b.toString()),ce(this,fr,"f").get(b.toString()))};try{const[R,X]=await Promise.all([Y(),ie()]);w=R;const{requestDetails:J,query:I}=w,O=Object.assign(Object.assign({},I),{requestDetails:J});if(this.log.print("Query response:",O),!ce(this,hr,"f"))return O;try{return ce(this,Jn,"f").call(this,O,X)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ce(this,fr,"f").delete(t.toString()),await this.fetchSubnetKeys(b.toString());const D=ce(this,fr,"f").get(t.toString());if(!D)throw new vt("Invalid signature from replica signed query: no matching node key found.");return ce(this,Jn,"f").call(this,O,D)}}catch(R){const X=`Error while making call: ${(i=R.message)!==null&&i!==void 0?i:String(R)}`,J=new Nf(X,R,String(V),Pe((a=B==null?void 0:B.body)===null||a===void 0?void 0:a.sender_pubkey),Pe((u=B==null?void 0:B.body)===null||u===void 0?void 0:u.sender_sig),String((s=B==null?void 0:B.body)===null||s===void 0?void 0:s.content.ingress_expiry._value));throw this.log.error(X,J),J}}async createReadStateRequest(t,r){await ce(this,Qe,"m",lr).call(this);const n=await(r!==void 0?await r:await ce(this,Et,"f"));if(!n)throw new Fn("This identity has expired due this application's security policy. Please refresh your authentication.");const i=(n==null?void 0:n.getPrincipal())||_e.anonymous(),a=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,dt,"f")?{Authorization:"Basic "+btoa(ce(this,dt,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:i,ingress_expiry:new Rn(ce(this,ur,"f")*On)}});return n==null?void 0:n.transformRequest(a)}async readState(t,r,n,i){var a,u,s,p;function b($){for(const V of $.paths){const[z,j]=V,Y=kt(new TextEncoder().encode("request_status"));if(bn(z,Y))return j}}const B=b(r);await ce(this,Qe,"m",lr).call(this);const w=typeof t=="string"?_e.fromText(t):t,A=i??await this.createReadStateRequest(r,n),_=Qi(A.body);this.log.print(`fetching "/api/v2/canister/${w}/read_state" with request:`,A);const y=ce(this,cr,"f").call(this);try{const $=await ce(this,Qe,"m",Dn).call(this,{request:()=>ce(this,Ut,"f").call(this,""+new URL(`/api/v2/canister/${w.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,$r,"f")),A.request),{body:_})),backoff:y,tries:0});if(!$.ok)throw new Error(`Server returned an error:
  Code: ${$.status} (${$.statusText})
  Body: ${await $.text()}
`);const V=Mt(await $.arrayBuffer());this.log.print("Read state response:",V);const z=await this.parseTimeFromResponse(V);return z>0&&(this.log.print("Read state response time:",z),We(this,on,z,"f")),V}catch($){const V=`Caught exception while attempting to read state: ${(a=$.message)!==null&&a!==void 0?a:String($)}`,z=new If(V,$,String(B),Pe((u=A==null?void 0:A.body)===null||u===void 0?void 0:u.sender_pubkey),Pe((s=A==null?void 0:A.body)===null||s===void 0?void 0:s.sender_sig),String((p=A==null?void 0:A.body)===null||p===void 0?void 0:p.content.ingress_expiry._value));throw this.log.error(V,z),z}}async parseTimeFromResponse(t){let r;if(t.certificate){const n=Mt(t.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=Wr(["time"],r);if(i.status!==Ve.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const a=Ws(kt(i.value));return this.log.print("Time from response:",a),this.log.print("Time from response in milliseconds:",Number(a)),Number(a)}else this.log.warn("No certificate found in response");return 0}async syncTime(t){await ce(this,Qe,"m",lr).call(this);const r=await mu(()=>Promise.resolve().then(()=>Al),void 0,import.meta.url),n=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=er.createSync({identity:new ai,host:this.host.toString(),fetch:ce(this,Ut,"f"),retryTimes:0}),u=(await r.request({canisterId:t??_e.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");u&&(We(this,Ur,Number(u)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${ce(this,Ur,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const t=ce(this,dt,"f")?{Authorization:"Basic "+btoa(ce(this,dt,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=ce(this,cr,"f").call(this),n=await ce(this,Qe,"m",Dn).call(this,{backoff:r,request:()=>ce(this,Ut,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},ce(this,$r,"f"))),tries:0});return Mt(await n.arrayBuffer())}async fetchRootKey(){let t;return ce(this,ar,"f")?t=await ce(this,ar,"f"):(We(this,ar,new Promise((r,n)=>{this.status().then(i=>{const a=i.root_key;this.rootKey=a,r(a)}).catch(n)}),"f"),t=await ce(this,ar,"f")),We(this,ar,null,"f"),t}invalidateIdentity(){We(this,Et,null,"f")}replaceIdentity(t){We(this,Et,Promise.resolve(t),"f")}async fetchSubnetKeys(t){await ce(this,Qe,"m",lr).call(this);const r=_e.from(t),i=(await Rc({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ce(this,fr,"f").set(r.toText(),i),i}_transform(t){let r=Promise.resolve(t);if(t.endpoint==="call")for(const n of ce(this,Fr,"f"))r=r.then(i=>n(i).then(a=>a||i));else for(const n of ce(this,Or,"f"))r=r.then(i=>n(i).then(a=>a||i));return r}}ar=new WeakMap,Vr=new WeakMap,Et=new WeakMap,Ut=new WeakMap,$r=new WeakMap,sn=new WeakMap,Ur=new WeakMap,dt=new WeakMap,pt=new WeakMap,cr=new WeakMap,ur=new WeakMap,on=new WeakMap,Or=new WeakMap,Fr=new WeakMap,fr=new WeakMap,hr=new WeakMap,Jn=new WeakMap,Qe=new WeakSet,jc=async function e(t){var r,n;const{ecid:i,transformedRequest:a,body:u,requestId:s,backoff:p,tries:b}=t,B=b===0?0:p.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:b,backoff:p,delay:B}),B===null)throw new ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,pt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);B>0&&await new Promise(y=>setTimeout(y,B));let w;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,a);const y=await ce(this,Ut,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,$r,"f")),a.request),{body:u}));if(y.status===200){const $=Mt(await y.arrayBuffer());w=Object.assign(Object.assign({},$),{httpDetails:{ok:y.ok,status:y.status,statusText:y.statusText,headers:Qr(y.headers)},requestId:s})}else throw new es(`Gateway returned an error:
  Code: ${y.status} (${y.statusText})
  Body: ${await y.text()}
`,{ok:y.ok,status:y.status,statusText:y.statusText,headers:Qr(y.headers)})}catch(y){if(b<ce(this,pt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${y}
  Retrying query.`),await ce(this,Qe,"m",e).call(this,Object.assign(Object.assign({},t),{tries:b+1}));throw y}const A=(n=(r=w.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!ce(this,hr,"f"))return w;if(!A)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const _=Number(BigInt(A)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:_}),Number(this.waterMark)>_){const y=new ke("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",y,{timestamp:A,waterMark:this.waterMark}),b<ce(this,pt,"f"))return await ce(this,Qe,"m",e).call(this,Object.assign(Object.assign({},t),{tries:b+1}));throw new ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,pt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return w},Dn=async function e(t){const{request:r,backoff:n,tries:i}=t,a=i===0?0:n.next();if(a===null)throw new ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,pt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);a>0&&await new Promise(b=>setTimeout(b,a));let u;try{u=await r()}catch(b){if(ce(this,pt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${b}
  Retrying request.`),await ce(this,Qe,"m",e).call(this,{request:r,backoff:n,tries:i+1});throw b}if(u.ok)return u;const s=await u.clone().text(),p=`Server returned an error:
  Code: ${u.status} (${u.statusText})
  Body: ${s}
`;if(u.status===404&&u.url.includes("api/v3"))throw new es("v3 api not supported. Fall back to v2",{ok:u.ok,status:u.status,statusText:u.statusText,headers:Qr(u.headers)});if(i<ce(this,pt,"f"))return await ce(this,Qe,"m",e).call(this,{request:r,backoff:n,tries:i+1});throw new es(p,{ok:u.ok,status:u.status,statusText:u.statusText,headers:Qr(u.headers)})},lr=async function(){if(!this.rootKey)if(this.rootKey===null&&ce(this,Vr,"f"))await this.fetchRootKey();else throw new ke(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ce(this,Vr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Xo;(function(e){e.Error="err",e.GetPrincipal="gp",e.GetPrincipalResponse="gpr",e.Query="q",e.QueryResponse="qr",e.Call="c",e.CallResponse="cr",e.ReadState="rs",e.ReadStateResponse="rsr",e.Status="s",e.StatusResponse="sr"})(Xo||(Xo={}));function Do(){const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!e)throw new Error("No Agent could be found.");return e}const r0=5*60*1e3;function zc(){return a0(i0(n0(),1e3),o0(1e3,1.2),s0(r0))}function n0(){let e=!0;return async()=>e?(e=!1,!0):!1}function i0(e,t){return async(r,n,i)=>{if(await e(r,n,i))return new Promise(a=>setTimeout(a,t))}}function s0(e){const t=Date.now()+e;return async(r,n,i)=>{if(Date.now()>t)throw new Error(`Request timed out after ${e} msec:
  Request ID: ${Pe(n)}
  Request status: ${i}
`)}}function o0(e,t){let r=e;return()=>new Promise(n=>setTimeout(()=>{r*=t,n()},r))}function a0(...e){return async(t,r,n)=>{for(const i of e)await i(t,r,n)}}async function Wc(e,t,r,n=zc(),i,a){var u;const s=[new TextEncoder().encode("request_status"),r],p=i??await((u=e.createReadStateRequest)===null||u===void 0?void 0:u.call(e,{paths:[s]})),b=await e.readState(t,{paths:[s]},void 0,p);if(e.rootKey==null)throw new Error("Agent root key not initialized before polling");const B=await gr.create({certificate:b.certificate,rootKey:e.rootKey,canisterId:t,blsVerify:a}),w=lt(B.lookup([...s,new TextEncoder().encode("status")]));let A;switch(typeof w>"u"?A=Ot.Unknown:A=new TextDecoder().decode(w),A){case Ot.Replied:return{reply:lt(B.lookup([...s,"reply"])),certificate:B};case Ot.Received:case Ot.Unknown:case Ot.Processing:return await n(t,r,A),Wc(e,t,r,n,p,a);case Ot.Rejected:{const _=new Uint8Array(lt(B.lookup([...s,"reject_code"])))[0],y=new TextDecoder().decode(lt(B.lookup([...s,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${Pe(r)}
  Reject code: ${_}
  Reject text: ${y}
`)}case Ot.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${Pe(r)}
`)}throw new Error("unreachable")}const c0=({IDL:e})=>{const t=e.Variant({mainnet:e.Null,testnet:e.Null}),r=e.Text,n=e.Record({network:t,address:r,min_confirmations:e.Opt(e.Nat32)}),i=e.Nat64,a=i,u=e.Nat32,s=e.Record({start_height:u,end_height:e.Opt(u),network:t}),p=e.Vec(e.Nat8),b=e.Record({tip_height:u,block_headers:e.Vec(p)}),B=e.Record({network:t}),w=e.Nat64,A=e.Vec(w),_=e.Record({network:t,filter:e.Opt(e.Variant({page:e.Vec(e.Nat8),min_confirmations:e.Nat32})),address:r}),y=e.Vec(e.Nat8),$=e.Record({txid:e.Vec(e.Nat8),vout:e.Nat32}),V=e.Record({height:e.Nat32,value:i,outpoint:$}),z=e.Record({next_page:e.Opt(e.Vec(e.Nat8)),tip_height:u,tip_block_hash:y,utxos:e.Vec(V)}),j=e.Record({transaction:e.Vec(e.Nat8),network:t}),Y=e.Principal,ie=e.Record({canister_id:Y,num_requested_changes:e.Opt(e.Nat64)}),R=e.Variant({from_user:e.Record({user_id:e.Principal}),from_canister:e.Record({canister_version:e.Opt(e.Nat64),canister_id:e.Principal})}),X=e.Vec(e.Nat8),J=e.Variant({creation:e.Record({controllers:e.Vec(e.Principal)}),code_deployment:e.Record({mode:e.Variant({reinstall:e.Null,upgrade:e.Null,install:e.Null}),module_hash:e.Vec(e.Nat8)}),load_snapshot:e.Record({canister_version:e.Nat64,taken_at_timestamp:e.Nat64,snapshot_id:X}),controllers_change:e.Record({controllers:e.Vec(e.Principal)}),code_uninstall:e.Null}),I=e.Record({timestamp_nanos:e.Nat64,canister_version:e.Nat64,origin:R,details:J}),O=e.Record({controllers:e.Vec(e.Principal),module_hash:e.Opt(e.Vec(e.Nat8)),recent_changes:e.Vec(I),total_num_changes:e.Nat64}),P=e.Record({canister_id:Y}),D=e.Variant({controllers:e.Null,public:e.Null,allowed_viewers:e.Vec(e.Principal)}),te=e.Record({freezing_threshold:e.Nat,controllers:e.Vec(e.Principal),reserved_cycles_limit:e.Nat,log_visibility:D,wasm_memory_limit:e.Nat,memory_allocation:e.Nat,compute_allocation:e.Nat}),d=e.Record({status:e.Variant({stopped:e.Null,stopping:e.Null,running:e.Null}),memory_size:e.Nat,cycles:e.Nat,settings:te,query_stats:e.Record({response_payload_bytes_total:e.Nat,num_instructions_total:e.Nat,num_calls_total:e.Nat,request_payload_bytes_total:e.Nat}),idle_cycles_burned_per_day:e.Nat,module_hash:e.Opt(e.Vec(e.Nat8)),reserved_cycles:e.Nat}),T=e.Record({canister_id:Y}),k=e.Record({freezing_threshold:e.Opt(e.Nat),controllers:e.Opt(e.Vec(e.Principal)),reserved_cycles_limit:e.Opt(e.Nat),log_visibility:e.Opt(D),wasm_memory_limit:e.Opt(e.Nat),memory_allocation:e.Opt(e.Nat),compute_allocation:e.Opt(e.Nat)}),K=e.Record({settings:e.Opt(k),sender_canister_version:e.Opt(e.Nat64)}),Q=e.Record({canister_id:Y}),re=e.Record({canister_id:Y}),ue=e.Record({canister_id:Y,snapshot_id:X}),ye=e.Record({canister_id:Y}),oe=e.Variant({secp256k1:e.Null}),le=e.Record({key_id:e.Record({name:e.Text,curve:oe}),canister_id:e.Opt(Y),derivation_path:e.Vec(e.Vec(e.Nat8))}),Ne=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),S=e.Record({canister_id:Y}),Be=e.Record({idx:e.Nat64,timestamp_nanos:e.Nat64,content:e.Vec(e.Nat8)}),Ie=e.Record({canister_log_records:e.Vec(Be)}),ae=e.Record({value:e.Text,name:e.Text}),ee=e.Record({status:e.Nat,body:e.Vec(e.Nat8),headers:e.Vec(ae)}),ne=e.Record({url:e.Text,method:e.Variant({get:e.Null,head:e.Null,post:e.Null}),max_response_bytes:e.Opt(e.Nat64),body:e.Opt(e.Vec(e.Nat8)),transform:e.Opt(e.Record({function:e.Func([e.Record({context:e.Vec(e.Nat8),response:ee})],[ee],["query"]),context:e.Vec(e.Nat8)})),headers:e.Vec(ae)}),x=e.Variant({reinstall:e.Null,upgrade:e.Opt(e.Record({wasm_memory_persistence:e.Opt(e.Variant({keep:e.Null,replace:e.Null})),skip_pre_upgrade:e.Opt(e.Bool)})),install:e.Null}),v=e.Record({hash:e.Vec(e.Nat8)}),U=e.Record({arg:e.Vec(e.Nat8),wasm_module_hash:e.Vec(e.Nat8),mode:x,chunk_hashes_list:e.Vec(v),target_canister:Y,store_canister:e.Opt(Y),sender_canister_version:e.Opt(e.Nat64)}),C=e.Vec(e.Nat8),M=e.Record({arg:e.Vec(e.Nat8),wasm_module:C,mode:x,canister_id:Y,sender_canister_version:e.Opt(e.Nat64)}),G=e.Record({canister_id:Y}),h=e.Record({id:X,total_size:e.Nat64,taken_at_timestamp:e.Nat64}),o=e.Vec(h),c=e.Record({canister_id:Y,sender_canister_version:e.Opt(e.Nat64),snapshot_id:X}),m=e.Record({start_at_timestamp_nanos:e.Nat64,subnet_id:e.Principal}),E=e.Record({num_block_failures_total:e.Nat64,node_id:e.Principal,num_blocks_proposed_total:e.Nat64}),F=e.Vec(e.Record({timestamp_nanos:e.Nat64,node_metrics:e.Vec(E)})),W=e.Record({settings:e.Opt(k),specified_id:e.Opt(Y),amount:e.Opt(e.Nat),sender_canister_version:e.Opt(e.Nat64)}),se=e.Record({canister_id:Y}),fe=e.Record({canister_id:Y,amount:e.Nat}),he=e.Vec(e.Nat8),be=e.Variant({ed25519:e.Null,bip340secp256k1:e.Null}),g=e.Record({key_id:e.Record({algorithm:be,name:e.Text}),canister_id:e.Opt(Y),derivation_path:e.Vec(e.Vec(e.Nat8))}),f=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),l=e.Record({key_id:e.Record({name:e.Text,curve:oe}),derivation_path:e.Vec(e.Vec(e.Nat8)),message_hash:e.Vec(e.Nat8)}),N=e.Record({signature:e.Vec(e.Nat8)}),H=e.Variant({bip341:e.Record({merkle_root_hash:e.Vec(e.Nat8)})}),L=e.Record({aux:e.Opt(H),key_id:e.Record({algorithm:be,name:e.Text}),derivation_path:e.Vec(e.Vec(e.Nat8)),message:e.Vec(e.Nat8)}),Z=e.Record({signature:e.Vec(e.Nat8)}),we=e.Record({canister_id:Y}),xe=e.Record({canister_id:Y}),me=e.Record({canister_id:Y}),ge=e.Vec(v),Se=e.Record({subnet_id:e.Principal}),Fe=e.Record({replica_version:e.Text}),Fi=e.Record({replace_snapshot:e.Opt(X),canister_id:Y}),Pi=h,ki=e.Record({canister_id:Y,sender_canister_version:e.Opt(e.Nat64)}),Mi=e.Record({canister_id:e.Principal,settings:k,sender_canister_version:e.Opt(e.Nat64)}),Ci=e.Record({chunk:e.Vec(e.Nat8),canister_id:e.Principal}),Vt=v;return e.Service({bitcoin_get_balance:e.Func([n],[a],[]),bitcoin_get_block_headers:e.Func([s],[b],[]),bitcoin_get_current_fee_percentiles:e.Func([B],[A],[]),bitcoin_get_utxos:e.Func([_],[z],[]),bitcoin_send_transaction:e.Func([j],[],[]),canister_info:e.Func([ie],[O],[]),canister_status:e.Func([P],[d],[]),clear_chunk_store:e.Func([T],[],[]),create_canister:e.Func([K],[Q],[]),delete_canister:e.Func([re],[],[]),delete_canister_snapshot:e.Func([ue],[],[]),deposit_cycles:e.Func([ye],[],[]),ecdsa_public_key:e.Func([le],[Ne],[]),fetch_canister_logs:e.Func([S],[Ie],["query"]),http_request:e.Func([ne],[ee],[]),install_chunked_code:e.Func([U],[],[]),install_code:e.Func([M],[],[]),list_canister_snapshots:e.Func([G],[o],[]),load_canister_snapshot:e.Func([c],[],[]),node_metrics_history:e.Func([m],[F],[]),provisional_create_canister_with_cycles:e.Func([W],[se],[]),provisional_top_up_canister:e.Func([fe],[],[]),raw_rand:e.Func([],[he],[]),schnorr_public_key:e.Func([g],[f],[]),sign_with_ecdsa:e.Func([l],[N],[]),sign_with_schnorr:e.Func([L],[Z],[]),start_canister:e.Func([we],[],[]),stop_canister:e.Func([xe],[],[]),stored_chunks:e.Func([me],[ge],[]),subnet_info:e.Func([Se],[Fe],[]),take_canister_snapshot:e.Func([Fi],[Pi],[]),uninstall_code:e.Func([ki],[],[]),update_settings:e.Func([Mi],[],[]),upload_chunk:e.Func([Ci],[Vt],[])})};class Yc extends ke{constructor(t,r,n,i){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(a=>`  "${a}": ${JSON.stringify(i[a])}`)].join(`
`)),this.canisterId=t,this.methodName=r,this.type=n,this.props=i}}class u0 extends Yc{constructor(t,r,n){var i;super(t,r,"query",{Status:n.status,Code:(i=bs[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class Jo extends Yc{constructor(t,r,n,i,a,u,s){super(t,r,"update",Object.assign({"Request ID":Pe(n)},i.body?Object.assign(Object.assign({},s?{"Error code":s}:{}),{"Reject code":String(a),"Reject message":u}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=a,this.reject_message=u,this.error_code=s}}const ft=Symbol.for("ic-agent-metadata");class Zr{constructor(t){this[ft]=Object.freeze(t)}static agentOf(t){return t[ft].config.agent}static interfaceOf(t){return t[ft].service}static canisterIdOf(t){return _e.from(t[ft].config.canisterId)}static async install(t,r){const n=t.mode===void 0?{install:null}:t.mode,i=t.arg?[...new Uint8Array(t.arg)]:[],a=[...new Uint8Array(t.module)],u=typeof r.canisterId=="string"?_e.fromText(r.canisterId):r.canisterId;await Qo(r).install_code({mode:n,arg:i,wasm_module:a,canister_id:u,sender_canister_version:[]})}static async createCanister(t,r){function n(a){return[{controllers:a.controllers?[a.controllers]:[],compute_allocation:a.compute_allocation?[a.compute_allocation]:[],freezing_threshold:a.freezing_threshold?[a.freezing_threshold]:[],memory_allocation:a.memory_allocation?[a.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await Qo(t||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(t,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(t,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(t,r){const n=t({IDL:ff});class i extends Zr{constructor(u){if(!u.canisterId)throw new ke(`Canister ID is required, but received ${typeof u.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const s=typeof u.canisterId=="string"?_e.fromText(u.canisterId):u.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Zc),u),{canisterId:s}),service:n});for(const[p,b]of n._fields)r!=null&&r.httpDetails&&b.annotations.push(Us),r!=null&&r.certificate&&b.annotations.push(Lc),this[p]=f0(this,p,b,u.blsVerify)}}return i}static createActor(t,r){if(!r.canisterId)throw new ke(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(r)}static createActorWithHttpDetails(t,r){return new(this.createActorClass(t,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(t,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,n))(r)}}function Sr(e,t){const r=Ia(e,Eu.Buffer.from(t));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Zc={pollingStrategyFactory:zc},Us="http-details",Lc="certificate";function f0(e,t,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(u,...s)=>{var p,b;u=Object.assign(Object.assign({},u),(b=(p=e[ft].config).queryTransform)===null||b===void 0?void 0:b.call(p,t,s,Object.assign(Object.assign({},e[ft].config),u)));const B=u.agent||e[ft].config.agent||Do(),w=_e.from(u.canisterId||e[ft].config.canisterId),A=xs(r.argTypes,s),_=await B.query(w,{methodName:t,arg:A,effectiveCanisterId:u.effectiveCanisterId}),y=Object.assign(Object.assign({},_.httpDetails),{requestDetails:_.requestDetails});switch(_.status){case"rejected":throw new u0(w,t,_);case"replied":return r.annotations.includes(Us)?{httpDetails:y,result:Sr(r.retTypes,_.reply.arg)}:Sr(r.retTypes,_.reply.arg)}}:i=async(u,...s)=>{var p,b;u=Object.assign(Object.assign({},u),(b=(p=e[ft].config).callTransform)===null||b===void 0?void 0:b.call(p,t,s,Object.assign(Object.assign({},e[ft].config),u)));const B=u.agent||e[ft].config.agent||Do(),{canisterId:w,effectiveCanisterId:A,pollingStrategyFactory:_}=Object.assign(Object.assign(Object.assign({},Zc),e[ft].config),u),y=_e.from(w),$=A!==void 0?_e.from(A):y,V=xs(r.argTypes,s),{requestId:z,response:j,requestDetails:Y}=await B.call(y,{methodName:t,arg:V,effectiveCanisterId:$});let ie,R;if(j.body&&j.body.certificate){if(B.rootKey==null)throw new Error("Agent is missing root key");const O=j.body.certificate;R=await gr.create({certificate:wr(O),rootKey:B.rootKey,canisterId:_e.from(w),blsVerify:n});const P=[new TextEncoder().encode("request_status"),z];switch(new TextDecoder().decode(lt(R.lookup([...P,"status"])))){case"replied":ie=lt(R.lookup([...P,"reply"]));break;case"rejected":{const te=new Uint8Array(lt(R.lookup([...P,"reject_code"])))[0],d=new TextDecoder().decode(lt(R.lookup([...P,"reject_message"]))),T=lt(R.lookup([...P,"error_code"])),k=T?new TextDecoder().decode(T):void 0;throw new Jo(y,t,z,j,te,d,k)}}}else if(j.body&&"reject_message"in j.body){const{reject_code:O,reject_message:P,error_code:D}=j.body;throw new Jo(y,t,z,j,O,P,D)}if(j.status===202){const O=_(),P=await Wc(B,$,z,O,n);R=P.certificate,ie=P.reply}const X=r.annotations.includes(Us),J=r.annotations.includes(Lc),I=Object.assign(Object.assign({},j),{requestDetails:Y});if(ie!==void 0)return X&&J?{httpDetails:I,certificate:R,result:Sr(r.retTypes,ie)}:J?{certificate:R,result:Sr(r.retTypes,ie)}:X?{httpDetails:I,result:Sr(r.retTypes,ie)}:Sr(r.retTypes,ie);if(r.retTypes.length===0)return X?{httpDetails:j,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const a=(...u)=>i({},...u);return a.withOptions=u=>(...s)=>i(u,...s),a}function Qo(e){function t(r,n){if(e.effectiveCanisterId)return{effectiveCanisterId:_e.from(e.effectiveCanisterId)};const i=n[0];let a=_e.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(a=_e.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(a=_e.from(i.canister_id)),{effectiveCanisterId:a}}return Zr.createActor(c0,Object.assign(Object.assign(Object.assign({},e),{canisterId:_e.fromHex("")}),{callTransform:t,queryTransform:t}))}var di=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Dt=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Qn,ei,Pr,kr;function ea(e){return e!==null&&typeof e=="object"}class Ct{constructor(t){if(Qn.set(this,void 0),ei.set(this,void 0),t.byteLength!==Ct.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");di(this,Qn,kt(t),"f"),di(this,ei,Ct.derEncode(t),"f")}static from(t){if(typeof t=="string"){const r=qt(t);return this.fromRaw(r)}else if(ea(t)){const r=t;if(ea(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw(kt(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new Ct(t)}static fromDer(t){return new Ct(this.derDecode(t))}static derEncode(t){const r=kc(t,hi).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(t){const r=Mc(t,hi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return kt(r)}get rawKey(){return Dt(this,Qn,"f")}get derKey(){return Dt(this,ei,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Qn=new WeakMap,ei=new WeakMap;Ct.RAW_KEY_LENGTH=32;class tr extends Ks{constructor(t,r){super(),Pr.set(this,void 0),kr.set(this,void 0),di(this,Pr,Ct.from(t),"f"),di(this,kr,new Uint8Array(r),"f")}static generate(t){if(t&&t.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=Ir.utils.randomPrivateKey()),bn(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(t)[i];const n=Ir.getPublicKey(r);return tr.fromKeyPair(n,r)}static fromParsedJson(t){const[r,n]=t;return new tr(Ct.fromDer(qt(r)),qt(n))}static fromJSON(t){const r=JSON.parse(t);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,r){return new tr(Ct.fromRaw(t),r)}static fromSecretKey(t){const r=Ir.getPublicKey(new Uint8Array(t));return tr.fromKeyPair(r,t)}toJSON(){return[Pe(Dt(this,Pr,"f").toDer()),Pe(Dt(this,kr,"f"))]}getKeyPair(){return{secretKey:Dt(this,kr,"f"),publicKey:Dt(this,Pr,"f")}}getPublicKey(){return Dt(this,Pr,"f")}async sign(t){const r=new Uint8Array(t),n=an(Ir.sign(r,Dt(this,kr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(t,r,n){const[i,a,u]=[t,r,n].map(s=>(typeof s=="string"&&(s=qt(s)),s instanceof Uint8Array&&(s=kt(s.buffer)),new Uint8Array(s)));return Ir.verify(i,a,u)}}Pr=new WeakMap,kr=new WeakMap;class Ys extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,Ys.prototype)}}function ta(e){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(e)return e;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new Ys("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class pi extends Ks{constructor(t,r,n){super(),this._keyPair=t,this._derKey=r,this._subtleCrypto=n}static async generate(t){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=t??{},a=ta(i),u=await a.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),s=await a.exportKey("spki",u.publicKey);return new this(u,s,a)}static async fromKeyPair(t,r){const n=ta(r),i=await n.exportKey("spki",t.publicKey);return new pi(t,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return t},r}async sign(t){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,t)}}var l0=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Nr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Rt;class h0{constructor(t){Rt.set(this,void 0),l0(this,Rt,t,"f")}get rawKey(){return Nr(this,Rt,"f").rawKey}get derKey(){return Nr(this,Rt,"f").derKey}toDer(){return Nr(this,Rt,"f").toDer()}getPublicKey(){return Nr(this,Rt,"f")}getPrincipal(){if(!Nr(this,Rt,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return _e.fromUint8Array(new Uint8Array(Nr(this,Rt,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Rt=new WeakMap;var d0=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},p0=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},y0=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},ti;const g0=new TextEncoder().encode("ic-request-auth-delegation"),w0=new TextEncoder().encode(`
ic-request`);function hs(e){if(typeof e!="string"||e.length<64)throw new Error("Invalid public key.");return qt(e)}class Zs{constructor(t,r,n){this.pubkey=t,this.expiration=r,this.targets=n}toCBOR(){return ct.value.map(Object.assign({pubkey:ct.value.bytes(this.pubkey),expiration:ct.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ct.value.array(this.targets.map(t=>ct.value.bytes(wr(t.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Pe(this.pubkey)},this.targets&&{targets:this.targets.map(t=>t.toHex())})}}async function m0(e,t,r,n){const i=new Zs(t.toDer(),BigInt(+r)*BigInt(1e6),n),a=new Uint8Array([...g0,...new Uint8Array(hn(Object.assign({},i)))]),u=await e.sign(wr(a));return{delegation:i,signature:u}}class yi{constructor(t,r){this.delegations=t,this.publicKey=r}static async create(t,r,n=new Date(Date.now()+15*60*1e3),i={}){var a,u;const s=await m0(t,r,n,i.targets);return new yi([...((a=i.previous)===null||a===void 0?void 0:a.delegations)||[],s],((u=i.previous)===null||u===void 0?void 0:u.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:r,delegations:n}=typeof t=="string"?JSON.parse(t):t;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(a=>{const{delegation:u,signature:s}=a,{pubkey:p,expiration:b,targets:B}=u;if(B!==void 0&&!Array.isArray(B))throw new Error("Invalid targets.");return{delegation:new Zs(hs(p),BigInt("0x"+b),B&&B.map(w=>{if(typeof w!="string")throw new Error("Invalid target.");return _e.fromHex(w)})),signature:hs(s)}});return new this(i,hs(r))}static fromDelegations(t,r){return new this(t,r)}toJSON(){return{delegations:this.delegations.map(t=>{const{delegation:r,signature:n}=t,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:Pe(r.pubkey)},i&&{targets:i.map(a=>a.toHex())}),signature:Pe(n)}}),publicKey:Pe(this.publicKey)}}}class ra extends Ks{constructor(t,r){super(),this._inner=t,this._delegation=r}static fromDelegation(t,r){return new this(t,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:r}=t,n=y0(t,["body"]),i=await hn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(wr(new Uint8Array([...w0,...new Uint8Array(i)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class gi extends h0{constructor(t,r){super(t),ti.set(this,void 0),d0(this,ti,r,"f")}get delegation(){return p0(this,ti,"f")}static fromDelegation(t,r){return new gi(t,r)}}ti=new WeakMap;function b0(e,t){for(const{delegation:n}of e.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[];for(const n of r){const i=n.toText();for(const{delegation:a}of e.delegations){if(a.targets===void 0)continue;let u=!0;for(const s of a.targets)if(s.toText()===i){u=!1;break}if(u)return!1}}return!0}var na;(function(e){e[e.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(na||(na={}));const ia=["mousedown","mousemove","keydown","touchstart","wheel"];class sa{constructor(t={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=t||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const a=this._resetTimer.bind(this);window.addEventListener("load",a,!0),ia.forEach(function(s){document.addEventListener(s,a,!0)});const u=(s,p)=>{let b;return(...B)=>{const w=this,A=function(){b=void 0,s.apply(w,B)};clearTimeout(b),b=window.setTimeout(A,p)}};if(t!=null&&t.captureScroll){const s=u(a,(r=t==null?void 0:t.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",s,!0)}a()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);ia.forEach(function(r){document.removeEventListener(r,t,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}const _0=(e,t)=>t.some(r=>e instanceof r);let oa,aa;function x0(){return oa||(oa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E0(){return aa||(aa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Xc=new WeakMap,Os=new WeakMap,Dc=new WeakMap,ds=new WeakMap,Ls=new WeakMap;function v0(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",a),e.removeEventListener("error",u)},a=()=>{r(nr(e.result)),i()},u=()=>{n(e.error),i()};e.addEventListener("success",a),e.addEventListener("error",u)});return t.then(r=>{r instanceof IDBCursor&&Xc.set(r,e)}).catch(()=>{}),Ls.set(t,e),t}function B0(e){if(Os.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",u),e.removeEventListener("abort",u)},a=()=>{r(),i()},u=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",a),e.addEventListener("error",u),e.addEventListener("abort",u)});Os.set(e,t)}let Fs={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Os.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Dc.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return nr(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function A0(e){Fs=e(Fs)}function T0(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(ps(this),t,...r);return Dc.set(n,t.sort?t.sort():[t]),nr(n)}:E0().includes(e)?function(...t){return e.apply(ps(this),t),nr(Xc.get(this))}:function(...t){return nr(e.apply(ps(this),t))}}function S0(e){return typeof e=="function"?T0(e):(e instanceof IDBTransaction&&B0(e),_0(e,x0())?new Proxy(e,Fs):e)}function nr(e){if(e instanceof IDBRequest)return v0(e);if(ds.has(e))return ds.get(e);const t=S0(e);return t!==e&&(ds.set(e,t),Ls.set(t,e)),t}const ps=e=>Ls.get(e);function N0(e,t,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const u=indexedDB.open(e,t),s=nr(u);return n&&u.addEventListener("upgradeneeded",p=>{n(nr(u.result),p.oldVersion,p.newVersion,nr(u.transaction),p)}),r&&u.addEventListener("blocked",p=>r(p.oldVersion,p.newVersion,p)),s.then(p=>{a&&p.addEventListener("close",()=>a()),i&&p.addEventListener("versionchange",b=>i(b.oldVersion,b.newVersion,b))}).catch(()=>{}),s}const I0=["get","getKey","getAll","getAllKeys","count"],R0=["put","add","delete","clear"],ys=new Map;function ca(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ys.get(t))return ys.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=R0.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||I0.includes(r)))return;const a=async function(u,...s){const p=this.transaction(u,i?"readwrite":"readonly");let b=p.store;return n&&(b=b.index(s.shift())),(await Promise.all([b[r](...s),i&&p.done]))[0]};return ys.set(t,a),a}A0(e=>({...e,get:(t,r,n)=>ca(t,r)||e.get(t,r,n),has:(t,r)=>!!ca(t,r)||e.has(t,r)}));const Jc="auth-client-db",Qc="ic-keyval",U0=async(e=Jc,t=Qc,r)=>(eu&&(localStorage!=null&&localStorage.getItem(Qt))&&(localStorage.removeItem(Qt),localStorage.removeItem(Jt)),await N0(e,r,{upgrade:n=>{n.objectStoreNames.contains(t)&&n.clear(t),n.createObjectStore(t)}}));async function O0(e,t,r){return await e.get(t,r)}async function F0(e,t,r,n){return await e.put(t,n,r)}async function P0(e,t,r){return await e.delete(t,r)}class Xs{constructor(t,r){this._db=t,this._storeName=r}static async create(t){const{dbName:r=Jc,storeName:n=Qc,version:i=q0}=t??{},a=await U0(r,n,i);return new Xs(a,n)}async set(t,r){return await F0(this._db,this._storeName,t,r)}async get(t){var r;return(r=await O0(this._db,this._storeName,t))!==null&&r!==void 0?r:null}async remove(t){return await P0(this._db,this._storeName,t)}}var k0=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},M0=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},ri;const Jt="identity",Qt="delegation",C0="iv",q0=1,eu=typeof window<"u";class $0{constructor(t="ic-",r){this.prefix=t,this._localStorage=r}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,r){return this._getLocalStorage().setItem(this.prefix+t,r),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class G0{constructor(t){ri.set(this,void 0),k0(this,ri,t??{},"f")}get _db(){return new Promise(t=>{if(this.initializedDb){t(this.initializedDb);return}Xs.create(M0(this,ri,"f")).then(r=>{this.initializedDb=r,t(r)})})}async get(t){return await(await this._db).get(t)}async set(t,r){await(await this._db).set(t,r)}async remove(t){await(await this._db).remove(t)}}ri=new WeakMap;const V0="https://identity.internetcomputer.org",H0="#authorize",gs="ECDSA",ws="Ed25519",K0=500,j0="UserInterrupt";class z0{constructor(t,r,n,i,a,u,s,p){this._identity=t,this._key=r,this._chain=n,this._storage=i,this.idleManager=a,this._createOptions=u,this._idpWindow=s,this._eventHandler=p,this._registerDefaultIdleCallback()}static async create(t={}){var r,n,i;const a=(r=t.storage)!==null&&r!==void 0?r:new G0,u=(n=t.keyType)!==null&&n!==void 0?n:gs;let s=null;if(t.identity)s=t.identity;else{let w=await a.get(Jt);if(!w&&eu)try{const A=new $0,_=await A.get(Qt),y=await A.get(Jt);_&&y&&u===gs&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await a.set(Qt,_),await a.set(Jt,y),w=_,await A.remove(Qt),await A.remove(Jt))}catch(A){console.error("error while attempting to recover localstorage: "+A)}if(w)try{typeof w=="object"?u===ws&&typeof w=="string"?s=await tr.fromJSON(w):s=await pi.fromKeyPair(w):typeof w=="string"&&(s=tr.fromJSON(w))}catch{}}let p=new ai,b=null;if(s)try{const w=await a.get(Qt);if(typeof w=="object"&&w!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?p=t.identity:w&&(b=yi.fromJSON(w),b0(b)?"toDer"in s?p=gi.fromDelegation(s,b):p=ra.fromDelegation(s,b):(await ms(a),s=null))}catch(w){console.error(w),await ms(a),s=null}let B;return!((i=t.idleOptions)===null||i===void 0)&&i.disableIdle?B=void 0:(b||t.identity)&&(B=sa.create(t.idleOptions)),s||(u===ws?(s=await tr.generate(),await a.set(Jt,JSON.stringify(s.toJSON()))):(t.storage&&u===gs&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${ws}' as the key type, as it can serialize to a string`),s=await pi.generate(),await a.set(Jt,s.getKeyPair()))),new this(p,s,b,a,B,t)}_registerDefaultIdleCallback(){var t,r;const n=(t=this._createOptions)===null||t===void 0?void 0:t.idleOptions;!(n!=null&&n.onIdle)&&!(n!=null&&n.disableDefaultIdleCallback)&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(t,r){var n,i;const a=t.delegations.map(b=>({delegation:new Zs(b.delegation.pubkey,b.delegation.expiration,b.delegation.targets),signature:b.signature.buffer})),u=yi.fromDelegations(a,t.userPublicKey.buffer),s=this._key;if(!s)return;this._chain=u,"toDer"in s?this._identity=gi.fromDelegation(s,this._chain):this._identity=ra.fromDelegation(s,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const p=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!(p!=null&&p.disableIdle)&&(this.idleManager=sa.create(p),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Qt,JSON.stringify(this._chain.toJSON())),r==null||r(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(t){var r,n,i,a;const u=BigInt(8)*BigInt(36e11),s=new URL(((r=t==null?void 0:t.identityProvider)===null||r===void 0?void 0:r.toString())||V0);s.hash=H0,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(s,Object.assign({maxTimeToLive:(i=t==null?void 0:t.maxTimeToLive)!==null&&i!==void 0?i:u},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=(a=window.open(s.toString(),"idpWindow",t==null?void 0:t.windowOpenerFeatures))!==null&&a!==void 0?a:void 0;const p=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(j0,t==null?void 0:t.onError):setTimeout(p,K0))};p()}_getEventHandler(t,r){return async n=>{var i,a,u;if(n.origin!==t.origin)return;const s=n.data;switch(s.kind){case"authorize-ready":{const p=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r==null?void 0:r.maxTimeToLive,allowPinAuthentication:r==null?void 0:r.allowPinAuthentication,derivationOrigin:(a=r==null?void 0:r.derivationOrigin)===null||a===void 0?void 0:a.toString()},r==null?void 0:r.customValues);(u=this._idpWindow)===null||u===void 0||u.postMessage(p,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(s,r==null?void 0:r.onSuccess)}catch(p){this._handleFailure(p.message,r==null?void 0:r.onError)}break;case"authorize-client-failure":this._handleFailure(s.text,r==null?void 0:r.onError);break}}}_handleFailure(t,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r==null||r(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await ms(this._storage),this._identity=new ai,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch{window.location.href=t.returnTo}}}async function ms(e){await e.remove(Jt),await e.remove(Qt),await e.remove(C0)}const tu=({IDL:e})=>{const t=e.Nat,r=e.Principal,n=e.Record({id:t,owner:r,name:e.Text,color:e.Text}),i=e.Record({principal:r,name:e.Text});return e.Service({create_calendar:e.Func([e.Text,e.Text],[n],[]),get_my_calendars:e.Func([],[e.Vec(n)],[]),get_my_profile:e.Func([],[e.Opt(i)],["query"]),register:e.Func([e.Text],[i],[])})},ru="ulvla-h7777-77774-qaacq-cai",W0=(e,t={})=>{const r=t.agent||new er({...t.agentOptions});return t.agent&&t.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),r.fetchRootKey().catch(n=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(n)}),Zr.createActor(tu,{agent:r,canisterId:e,...t.actorOptions})};W0(ru);const Y0=({IDL:e})=>{const t=e.Nat,r=e.Principal,n=e.Record({id:t,owner:r,name:e.Text,color:e.Text}),i=e.Int,a=e.Nat,u=e.Record({id:a,startTime:i,title:e.Text,endTime:i,color:e.Text,description:e.Text,calendarId:t});return e.Service({create_calendar_internal:e.Func([e.Principal,e.Text,e.Text],[n],[]),create_event:e.Func([t,e.Text,e.Text,i,i,e.Text],[u],[]),delete_event:e.Func([a],[e.Bool],[]),get_event:e.Func([a],[e.Opt(u)],[]),get_events_for_range:e.Func([t,i,i],[e.Vec(u)],[]),update_event:e.Func([a,e.Opt(e.Text),e.Opt(e.Text),e.Opt(i),e.Opt(i),e.Opt(e.Text)],[e.Opt(u)],[])})},Z0="uxrrr-q7777-77774-qaaaq-cai",L0=(e,t={})=>{const r=t.agent||new er({...t.agentOptions});return t.agent&&t.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),r.fetchRootKey().catch(n=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(n)}),Zr.createActor(Y0,{agent:r,canisterId:e,...t.actorOptions})};L0(Z0);const X0=async(e,t,r,n)=>{const i="http://127.0.0.1:8000",a=new er({host:i,identity:r||void 0});try{await a.fetchRootKey()}catch(s){console.warn('Unable to fetch root key. Ensure local replica is running or network is "ic".',s)}return Zr.createActor(t,{agent:a,canisterId:e})},D0=async e=>{const t="ucwa4-rx777-77774-qaada-cai";return console.log("getUserRegistryActor called with:",{envUserRegistry:"ucwa4-rx777-77774-qaada-cai",userRegistryCanisterId:ru,identity:e?"present":"null",finalCanisterId:t}),X0(t,tu,e)};console.log("actors.ts updated with specific canister imports and actor creation functions.");const ir=mn(!1),$t=mn(null),sr=mn(null),ni=mn(null),at=mn(null);let At=null;const Ps=async()=>{const e=wu($t);if(!e){at.set(null),console.log("No identity found, cannot fetch profile.");return}try{console.log("Fetching user profile...");const t=await D0(e),r=await t.get_my_profile();if(Array.isArray(r)&&r.length>0)at.set(r[0]||null),console.log("User profile fetched and set:",r[0]);else if(r&&!Array.isArray(r))at.set(r),console.log("User profile fetched and set:",r);else{console.log("No profile found, attempting to register user...");try{const a=`User-${e.getPrincipal().toString().slice(-8)}`,u=await t.register(a);at.set(u),console.log("User registered successfully:",u)}catch(n){console.error("Failed to auto-register user:",n),at.set(null)}}}catch(t){console.error("Error fetching user profile:",t),at.set(null)}},J0=async()=>{if(At){console.log("AuthClient already initialized, checking authentication status...");const e=await At.isAuthenticated(),t=e?At.getIdentity():null;ir.set(e),$t.set(t),sr.set(t?t.getPrincipal():null),ni.set(At),e?(console.log("User is already authenticated, fetching profile..."),await Ps()):at.set(null);return}try{console.log("Creating AuthClient...");const e=await z0.create();At=e,ni.set(e);const t=await e.isAuthenticated();if(ir.set(t),t){console.log("User is authenticated, setting up identity...");const r=e.getIdentity();$t.set(r),sr.set(r.getPrincipal()),console.log("Principal:",r.getPrincipal().toString()),await Ps()}else console.log("User is not authenticated"),at.set(null)}catch(e){throw console.error("Error initializing auth client:",e),ir.set(!1),$t.set(null),sr.set(null),ni.set(null),at.set(null),e}},Q0=()=>"http://127.0.0.1:8000/?canisterId=uzt4z-lp777-77774-qaabq-cai",lh=async()=>{if(!At&&(await J0(),!At)){console.error("AuthClient not initialized, cannot login.");return}const e=At;try{const t=Q0();console.log("Attempting to login with Internet Identity URL:",t),await new Promise((r,n)=>{e.login({identityProvider:t,onSuccess:async()=>{console.log("Login successful");const i=e.getIdentity();$t.set(i),sr.set(i.getPrincipal()),ir.set(!0),ni.set(e),await Ps(),r()},onError:i=>{console.error("Login failed:",i),ir.set(!1),$t.set(null),sr.set(null),at.set(null),n(i)}})})}catch(t){throw console.error("Error during login process:",t),ir.set(!1),$t.set(null),sr.set(null),at.set(null),t}},hh=async()=>{if(!At){console.error("AuthClient not initialized, cannot logout.");return}try{console.log("Logging out..."),await At.logout(),ir.set(!1),$t.set(null),sr.set(null),at.set(null),console.log("Logout successful")}catch(e){throw console.error("Error during logout:",e),ir.set(!1),$t.set(null),sr.set(null),at.set(null),e}};export{J0 as a,hh as b,$t as c,X0 as d,Z0 as e,Ps as f,Y0 as g,D0 as h,ir as i,lh as l,at as u};
