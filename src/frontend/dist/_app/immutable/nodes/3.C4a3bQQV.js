import"../chunks/CWj6FrbW.js";import{i as z}from"../chunks/Dj7YT8ao.js";import{q as B,r as D,t as F,v as G,w as g,x as L,y as Y,z as o,A as H,s as n,B as P,C as l,D as f,a as d,E as c,F as J,G as K}from"../chunks/BXLc-fqL.js";import{i as v,s as N,a as C}from"../chunks/DZIK79hL.js";import{i as O,l as Q}from"../chunks/DGpHpxxE.js";import{g as y}from"../chunks/Bl39gt54.js";import{p as T}from"../chunks/C08iBmnE.js";var V=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert"><strong class="font-bold">Error:</strong> <span class="block sm:inline"> </span></div>'),W=g("<span>Logging in...</span>"),X=g("<span>Already Logged In</span>"),Z=g('<p class="text-xs text-gray-600 mt-4 text-center">You will be redirected to the Internet Identity service.</p>'),ee=g('<div class="flex items-center justify-center min-h-screen bg-gray-200"><div class="p-8 bg-white shadow-xl rounded-lg max-w-md w-full"><h1 class="text-3xl font-bold text-center text-blue-600 mb-6">ICP Calendar Login</h1> <!> <p class="text-gray-700 mb-6 text-center">Please log in using your Internet Identity to access the calendar.</p> <button class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline transition duration-150 ease-in-out disabled:opacity-50"><!></button> <!></div></div>');function le(U,$){B($,!1);const[h,k]=N(),r=()=>C(O,"$isLoggedIn",h),m=()=>C(T,"$page",h);let a=P(!1),p=P(null);D(()=>{if(r()){console.log("User already logged in on mount, redirecting..."),n(a,!1);const e=m().url.searchParams.get("redirect"),t=e?decodeURIComponent(e):"/";y(t,{replaceState:!0})}});const E=async()=>{n(a,!0),n(p,null);try{console.log("Starting login process..."),await Q(),console.log("Login process completed")}catch(e){console.error("Login attempt failed:",e),n(p,"Login failed. Please try again. Ensure your Internet Identity is set up and pop-ups are allowed."),n(a,!1)}};F(()=>(r(),m(),y),()=>{if(r()){console.log("User is logged in, redirecting..."),n(a,!1);const e=m().url.searchParams.get("redirect"),t=e?decodeURIComponent(e):"/";y(t,{replaceState:!0})}}),G(),z();var b=ee(),I=l(b),w=f(l(I),2);{var S=e=>{var t=V(),u=f(l(t),2),_=l(u,!0);c(u),c(t),L(()=>J(_,d(p))),o(e,t)};v(w,e=>{d(p)&&e(S)})}var i=f(w,4),A=l(i);{var M=e=>{var t=W();o(e,t)},R=(e,t)=>{{var u=s=>{var x=X();o(s,x)},_=s=>{var x=K("Log In with Internet Identity");o(s,x)};v(e,s=>{r()?s(u):s(_,!1)},t)}};v(A,e=>{d(a)?e(M):e(R,!1)})}c(i);var j=f(i,2);{var q=e=>{var t=Z();o(e,t)};v(j,e=>{!r()&&!d(a)&&e(q)})}c(I),c(b),L(()=>i.disabled=d(a)||r()),Y("click",i,E),o(U,b),H(),k()}export{le as component};
