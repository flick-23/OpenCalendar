import"../chunks/CWj6FrbW.js";import{i as Ye}from"../chunks/Dj7YT8ao.js";import{Y as et,n as J,aj as Vt,ak as Ht,o as Et,R as ut,a as t,b as he,U as la,W as da,X as At,Z as Ve,a2 as Ie,al as ca,am as ua,_ as $t,$ as st,a0 as qt,an as Bt,ao as jt,ap as Wt,B as V,j as Nt,aq as mt,ab as va,ar as Ct,as as Mt,at as fa,au as kt,av as Lt,aw as ga,ax as ha,ay as ma,az as at,aA as ba,aB as pa,aC as ya,T as _a,aD as wa,aE as xa,aF as Da,a9 as vt,u as I,aG as Gt,aH as Ea,aI as Ca,a3 as Ta,aJ as $a,aK as Ma,aL as ka,aM as Sa,d as Aa,aN as Na,aO as La,aP as Fa,aQ as Ia,aR as Ya,aS as Pa,aT as za,aU as Oa,aV as Ra,aW as Ua,aa as Va,aX as Ha,a7 as dt,q as Pe,aY as qa,C as p,D as M,E as h,z as A,A as ze,N as ge,a8 as be,Q as fe,ai as Ba,aZ as ja,a_ as it,t as qe,s as _,v as Ge,w as H,x as W,a$ as Wa,F as ee,y as Q,r as ft,G as Ue,b0 as Ga,b1 as Kt,b2 as Ka,b3 as Xa}from"../chunks/BXLc-fqL.js";import{i as j,s as Qa,a as bt}from"../chunks/DZIK79hL.js";import{c as ct,f as Tt,d as Za,e as Ja,g as er,h as Xt,i as Qt,u as tr}from"../chunks/DGpHpxxE.js";import{l as ve,p as se,s as Ce}from"../chunks/CtnXckHE.js";import{s as pe}from"../chunks/COUQgzWd.js";function He(e,a){return a}function ar(e,a,r,n){for(var o=[],c=a.length,i=0;i<c;i++)ga(a[i].e,o,!0);var s=c>0&&o.length===0&&r!==null;if(s){var u=r.parentNode;ha(u),u.append(r),n.clear(),Fe(e,a[0].prev,a[c-1].next)}ma(o,()=>{for(var d=0;d<c;d++){var v=a[d];s||(n.delete(v.k),Fe(e,v.prev,v.next)),at(v.e,!s)}})}function me(e,a,r,n,o,c=null){var i=e,s={flags:a,items:new Map,first:null},u=(a&Bt)!==0;if(u){var d=e;i=J?et(Vt(d)):d.appendChild(Ht())}J&&Et();var v=null,f=!1,l=he(()=>{var x=r();return Wt(x)?x:x==null?[]:jt(x)});ut(()=>{var x=t(l),b=x.length;if(f&&b===0)return;f=b===0;let C=!1;if(J){var w=la(i)===da;w!==(b===0)&&(i=At(),et(i),Ve(!1),C=!0)}if(J){for(var T=null,L,D=0;D<b;D++){if(Ie.nodeType===ca&&Ie.data===ua){i=Ie,C=!0,Ve(!1);break}var m=x[D],E=n(m,D);L=Zt(Ie,s,T,null,m,E,D,o,a,r),s.items.set(E,L),T=L}b>0&&et(At())}J||rr(x,s,i,o,a,n,r),c!==null&&(b===0?v?$t(v):v=st(()=>c(i)):v!==null&&qt(v,()=>{v=null})),C&&Ve(!0),t(l)}),J&&(i=Ie)}function rr(e,a,r,n,o,c,i){var R,B,q,Y;var s=(o&fa)!==0,u=(o&(kt|Mt))!==0,d=e.length,v=a.items,f=a.first,l=f,x,b=null,C,w=[],T=[],L,D,m,E;if(s)for(E=0;E<d;E+=1)L=e[E],D=c(L,E),m=v.get(D),m!==void 0&&((R=m.a)==null||R.measure(),(C??(C=new Set)).add(m));for(E=0;E<d;E+=1){if(L=e[E],D=c(L,E),m=v.get(D),m===void 0){var z=l?l.e.nodes_start:r;b=Zt(z,a,b,b===null?a.first:b.next,L,D,E,n,o,i),v.set(D,b),w=[],T=[],l=b.next;continue}if(u&&nr(m,L,E,o),(m.e.f&mt)!==0&&($t(m.e),s&&((B=m.a)==null||B.unfix(),(C??(C=new Set)).delete(m))),m!==l){if(x!==void 0&&x.has(m)){if(w.length<T.length){var k=T[0],$;b=k.prev;var O=w[0],F=w[w.length-1];for($=0;$<w.length;$+=1)Ft(w[$],k,r);for($=0;$<T.length;$+=1)x.delete(T[$]);Fe(a,O.prev,F.next),Fe(a,b,O),Fe(a,F,k),l=k,b=F,E-=1,w=[],T=[]}else x.delete(m),Ft(m,l,r),Fe(a,m.prev,m.next),Fe(a,m,b===null?a.first:b.next),Fe(a,b,m),b=m;continue}for(w=[],T=[];l!==null&&l.k!==D;)(l.e.f&mt)===0&&(x??(x=new Set)).add(l),T.push(l),l=l.next;if(l===null)continue;m=l}w.push(m),b=m,l=m.next}if(l!==null||x!==void 0){for(var g=x===void 0?[]:jt(x);l!==null;)(l.e.f&mt)===0&&g.push(l),l=l.next;var y=g.length;if(y>0){var N=(o&Bt)!==0&&d===0?r:null;if(s){for(E=0;E<y;E+=1)(q=g[E].a)==null||q.measure();for(E=0;E<y;E+=1)(Y=g[E].a)==null||Y.fix()}ar(a,g,N,v)}}s&&va(()=>{var U;if(C!==void 0)for(m of C)(U=m.a)==null||U.apply()}),Ct.first=a.first&&a.first.e,Ct.last=b&&b.e}function nr(e,a,r,n){(n&kt)!==0&&Lt(e.v,a),(n&Mt)!==0?Lt(e.i,r):e.i=r}function Zt(e,a,r,n,o,c,i,s,u,d){var v=(u&kt)!==0,f=(u&ba)===0,l=v?f?V(o,!1,!1):Nt(o):o,x=(u&Mt)===0?i:Nt(i),b={i:x,v:l,k:c,a:null,e:null,prev:r,next:n};try{return b.e=st(()=>s(e,l,x,d),J),b.e.prev=r&&r.e,b.e.next=n&&n.e,r===null?a.first=b:(r.next=b,r.e.next=b.e),n!==null&&(n.prev=b,n.e.prev=b.e),b}finally{}}function Ft(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,o=a?a.e.nodes_start:r,c=e.e.nodes_start;c!==n;){var i=pa(c);o.before(c),c=i}}function Fe(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function sr(e,a,r,n,o,c){let i=J;J&&Et();var s,u,d=null;J&&Ie.nodeType===ya&&(d=Ie,Et());var v=J?Ie:e,f;ut(()=>{const l=a()||null;var x=wa;l!==s&&(f&&(l===null?qt(f,()=>{f=null,u=null}):l===u?$t(f):at(f)),l&&l!==u&&(f=st(()=>{if(d=J?d:document.createElementNS(x,l),xa(d,d),n){J&&Da(l)&&d.append(document.createComment(""));var b=J?Vt(d):d.appendChild(Ht());J&&(b===null?Ve(!1):et(b)),n(d,b)}Ct.nodes_end=d,v.before(d)})),s=l,s&&(u=s))},_a),i&&(Ve(!0),et(v))}function ir(e,a,r){vt(()=>{var n=I(()=>a(e,r==null?void 0:r())||{});if(n!=null&&n.destroy)return()=>n.destroy()})}function or(e,a){var r=void 0,n;ut(()=>{r!==(r=a())&&(n&&(at(n),n=null),r&&(n=st(()=>{vt(()=>r(e))})))})}function Jt(e){var a,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(a=0;a<o;a++)e[a]&&(r=Jt(e[a]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lr(){for(var e,a,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(a=Jt(e))&&(n&&(n+=" "),n+=a);return n}function dr(e){return typeof e=="object"?lr(e):e??""}const It=[...` 	
\r\f \v\uFEFF`];function cr(e,a,r){var n=e==null?"":""+e;if(a&&(n=n?n+" "+a:a),r){for(var o in r)if(r[o])n=n?n+" "+o:o;else if(n.length)for(var c=o.length,i=0;(i=n.indexOf(o,i))>=0;){var s=i+c;(i===0||It.includes(n[i-1]))&&(s===n.length||It.includes(n[s]))?n=(i===0?"":n.substring(0,i))+n.substring(s+1):i=s}}return n===""?null:n}function Yt(e,a=!1){var r=a?" !important;":";",n="";for(var o in e){var c=e[o];c!=null&&c!==""&&(n+=" "+o+": "+c+r)}return n}function pt(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function ur(e,a){if(a){var r="",n,o;if(Array.isArray(a)?(n=a[0],o=a[1]):n=a,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var c=!1,i=0,s=!1,u=[];n&&u.push(...Object.keys(n).map(pt)),o&&u.push(...Object.keys(o).map(pt));var d=0,v=-1;const C=e.length;for(var f=0;f<C;f++){var l=e[f];if(s?l==="/"&&e[f-1]==="*"&&(s=!1):c?c===l&&(c=!1):l==="/"&&e[f+1]==="*"?s=!0:l==='"'||l==="'"?c=l:l==="("?i++:l===")"&&i--,!s&&c===!1&&i===0){if(l===":"&&v===-1)v=f;else if(l===";"||f===C-1){if(v!==-1){var x=pt(e.substring(d,v).trim());if(!u.includes(x)){l!==";"&&f++;var b=e.substring(d,f).trim();r+=" "+b+";"}}d=f+1,v=-1}}}}return n&&(r+=Yt(n)),o&&(r+=Yt(o,!0)),r=r.trim(),r===""?null:r}return e==null?null:String(e)}function rt(e,a,r,n,o,c){var i=e.__className;if(J||i!==r||i===void 0){var s=cr(r,n,c);(!J||s!==e.getAttribute("class"))&&(s==null?e.removeAttribute("class"):a?e.className=s:e.setAttribute("class",s)),e.__className=r}else if(c&&o!==c)for(var u in c){var d=!!c[u];(o==null||d!==!!o[u])&&e.classList.toggle(u,d)}return c}function yt(e,a={},r,n){for(var o in r){var c=r[o];a[o]!==c&&(r[o]==null?e.style.removeProperty(o):e.style.setProperty(o,c,n))}}function We(e,a,r,n){var o=e.__style;if(J||o!==a){var c=ur(a,n);(!J||c!==e.getAttribute("style"))&&(c==null?e.removeAttribute("style"):e.style.cssText=c),e.__style=a}else n&&(Array.isArray(n)?(yt(e,r==null?void 0:r[0],n[0]),yt(e,r==null?void 0:r[1],n[1],"important")):yt(e,r,n));return n}function nt(e,a,r){if(e.multiple){if(a==null)return;if(!Wt(a))return Ea();for(var n of e.options)n.selected=a.includes(tt(n));return}for(n of e.options){var o=tt(n);if(Ca(o,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function St(e){var a=new MutationObserver(()=>{nt(e,e.__value)});a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ta(()=>{a.disconnect()})}function vr(e,a,r=a){var n=!0;Gt(e,"change",o=>{var c=o?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(c),tt);else{var s=e.querySelector(c)??e.querySelector("option:not([disabled])");i=s&&tt(s)}r(i)}),vt(()=>{var o=a();if(nt(e,o,n),n&&o===void 0){var c=e.querySelector(":checked");c!==null&&(o=tt(c),r(o))}e.__value=o,n=!1}),St(e)}function tt(e){return"__value"in e?e.__value:e.value}const Ze=Symbol("class"),Je=Symbol("style"),ea=Symbol("is custom element"),ta=Symbol("is html");function Me(e){if(J){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;ke(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var o=e.checked;ke(e,"checked",null),e.checked=o}}};e.__on_r=r,$a(r),Ma()}}function fr(e,a){a?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function ke(e,a,r,n){var o=aa(e);J&&(o[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||o[a]!==(o[a]=r)&&(a==="loading"&&(e[ka]=r),r==null?e.removeAttribute(a):typeof r!="string"&&ra(e).includes(a)?e[a]=r:e.setAttribute(a,r))}function gr(e,a,r,n,o=!1){var c=aa(e),i=c[ea],s=!c[ta];let u=J&&i;u&&Ve(!1);var d=a||{},v=e.tagName==="OPTION";for(var f in a)f in r||(r[f]=null);r.class?r.class=dr(r.class):r[Ze]&&(r.class=null),r[Je]&&(r.style??(r.style=null));var l=ra(e);for(const D in r){let m=r[D];if(v&&D==="value"&&m==null){e.value=e.__value="",d[D]=m;continue}if(D==="class"){var x=e.namespaceURI==="http://www.w3.org/1999/xhtml";rt(e,x,m,n,a==null?void 0:a[Ze],r[Ze]),d[D]=m,d[Ze]=r[Ze];continue}if(D==="style"){We(e,m,a==null?void 0:a[Je],r[Je]),d[D]=m,d[Je]=r[Je];continue}var b=d[D];if(!(m===b&&!(m===void 0&&e.hasAttribute(D)))){d[D]=m;var C=D[0]+D[1];if(C!=="$$")if(C==="on"){const E={},z="$$"+D;let k=D.slice(2);var w=Oa(k);if(La(k)&&(k=k.slice(0,-7),E.capture=!0),!w&&b){if(m!=null)continue;e.removeEventListener(k,d[z],E),d[z]=null}if(m!=null)if(w)e[`__${k}`]=m,Ia([k]);else{let $=function(O){d[D].call(this,O)};d[z]=Fa(k,e,$,E)}else w&&(e[`__${k}`]=void 0)}else if(D==="style")ke(e,D,m);else if(D==="autofocus")Ya(e,!!m);else if(!i&&(D==="__value"||D==="value"&&m!=null))e.value=e.__value=m;else if(D==="selected"&&v)fr(e,m);else{var T=D;s||(T=Pa(T));var L=T==="defaultValue"||T==="defaultChecked";if(m==null&&!i&&!L)if(c[D]=null,T==="value"||T==="checked"){let E=e;const z=a===void 0;if(T==="value"){let k=E.defaultValue;E.removeAttribute(T),E.defaultValue=k,E.value=E.__value=z?k:null}else{let k=E.defaultChecked;E.removeAttribute(T),E.defaultChecked=k,E.checked=z?k:!1}}else e.removeAttribute(D);else L||l.includes(T)&&(i||typeof m!="string")?e[T]=m:typeof m!="function"&&ke(e,T,m)}}}return u&&Ve(!0),d}function Pt(e,a,r=[],n,o=!1,c=Aa){const i=r.map(c);var s=void 0,u={},d=e.nodeName==="SELECT",v=!1;if(ut(()=>{var l=a(...i.map(t)),x=gr(e,s,l,n,o);v&&d&&"value"in l&&nt(e,l.value,!1);for(let C of Object.getOwnPropertySymbols(u))l[C]||at(u[C]);for(let C of Object.getOwnPropertySymbols(l)){var b=l[C];C.description===Na&&(!s||b!==s[C])&&(u[C]&&at(u[C]),u[C]=st(()=>or(e,()=>b))),x[C]=b}s=x}),d){var f=e;vt(()=>{nt(f,s.value),St(f)})}v=!0}function aa(e){return e.__attributes??(e.__attributes={[ea]:e.nodeName.includes("-"),[ta]:e.namespaceURI===Sa})}var zt=new Map;function ra(e){var a=zt.get(e.nodeName);if(a)return a;zt.set(e.nodeName,a=[]);for(var r,n=e,o=Element.prototype;o!==n;){r=Ra(n);for(var c in r)r[c].set&&a.push(c);n=za(n)}return a}function De(e,a,r=a){var n=Ua();Gt(e,"input",o=>{var c=o?e.defaultValue:e.value;if(c=_t(e)?wt(c):c,r(c),n&&c!==(c=a())){var i=e.selectionStart,s=e.selectionEnd;e.value=c??"",s!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(s,e.value.length))}}),(J&&e.defaultValue!==e.value||I(a)==null&&e.value)&&r(_t(e)?wt(e.value):e.value),Va(()=>{var o=a();_t(e)&&o===wt(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function _t(e){var a=e.type;return a==="number"||a==="range"}function wt(e){return e===""?null:+e}function hr(e){return function(...a){var r=a[0];r.target===this&&(e==null||e.apply(this,a))}}function mr(e){return function(...a){var r=a[0];return r.stopPropagation(),e==null?void 0:e.apply(this,a)}}function br(e){return function(...a){var r=a[0];return r.preventDefault(),e==null?void 0:e.apply(this,a)}}const Ot={events:[],calendars:[],isLoadingEvents:!1,isLoadingCalendars:!1,error:null,selectedCalendarId:null},xt=e=>({id:e.id,calendarId:e.calendarId,title:e.title,description:e.description,startTime:new Date(Number(e.startTime/1000000n)),endTime:new Date(Number(e.endTime/1000000n)),color:e.color}),Dt=e=>({id:e.id,owner:e.owner,name:e.name,color:e.color}),Ee=(()=>{const e=Ha(Ot);let a=null,r=null;const n=async()=>{if(a)return a;const i=dt(ct);if(!i)return e.update(s=>({...s,error:"User not authenticated for calendar operations"})),null;try{return a=await Za(Ja,er,i),a}catch(s){return console.error("Failed to create calendar canister actor:",s),e.update(u=>({...u,error:"Failed to connect to calendar service"})),null}},o=async()=>{if(r)return r;const i=dt(ct);if(!i)return e.update(s=>({...s,error:"User not authenticated for user registry operations"})),null;try{return r=await Xt(i),r}catch(s){return console.error("Failed to create user registry actor:",s),e.update(u=>({...u,error:"Failed to connect to user registry service"})),null}};ct.subscribe(i=>{i?dt(Qt)&&c.fetchUserCalendars():(a=null,r=null,e.set(Ot))});const c={subscribe:e.subscribe,set:e.set,update:e.update,fetchUserCalendars:async()=>{e.update(s=>({...s,isLoadingCalendars:!0,error:null}));const i=await o();if(!i){e.update(s=>({...s,isLoadingCalendars:!1,error:"User Registry actor not available"}));return}try{console.log("Fetching user calendars from UserRegistry...");const u=(await i.get_my_calendars()).map(Dt);if(e.update(d=>({...d,calendars:u,isLoadingCalendars:!1})),console.log("User calendars fetched:",u),u.length>0){const d=dt(e).selectedCalendarId,v=u.some(f=>f.id===d);(!d||!v)&&(console.log("Auto-selecting first calendar:",u[0].id),e.update(f=>({...f,selectedCalendarId:u[0].id})),c.fetchEvents(u[0].id,new Date(new Date().getFullYear(),new Date().getMonth(),1),new Date(new Date().getFullYear(),new Date().getMonth()+1,0)))}else e.update(d=>({...d,selectedCalendarId:null,events:[]}))}catch(s){console.error("Error fetching user calendars:",s);const u=(s==null?void 0:s.message)||String(s);if(u.includes("User not registered")){console.log("User not registered error detected, triggering re-authentication...");try{await Tt();const v=(await i.get_my_calendars()).map(Dt);e.update(f=>({...f,calendars:v,isLoadingCalendars:!1})),console.log("User calendars fetched after registration:",v);return}catch(d){console.error("Failed to auto-register user:",d)}}e.update(d=>({...d,error:u||"Failed to fetch user calendars",isLoadingCalendars:!1}))}},createNewUserCalendar:async(i,s)=>{e.update(d=>({...d,isLoadingCalendars:!0,error:null}));const u=await o();if(!u)return e.update(d=>({...d,isLoadingCalendars:!1,error:"User Registry actor not available"})),null;try{const d=await u.create_calendar(i,s),v=Dt(d);return await c.fetchUserCalendars(),e.update(f=>({...f,selectedCalendarId:v.id})),c.fetchEvents(v.id,new Date(new Date().getFullYear(),new Date().getMonth(),1),new Date(new Date().getFullYear(),new Date().getMonth()+1,0)),v}catch(d){return console.error("Error creating new user calendar:",d),e.update(v=>({...v,error:d.message||"Failed to create new calendar",isLoadingCalendars:!1})),null}},setSelectedCalendar:i=>{e.update(v=>({...v,selectedCalendarId:i,events:[]}));const s=new Date,u=new Date(s.getFullYear(),s.getMonth(),1),d=new Date(s.getFullYear(),s.getMonth()+1,0);c.fetchEvents(i,u,d)},fetchEvents:async(i,s,u)=>{if(!i){e.update(v=>({...v,events:[],error:"No calendar selected to fetch events for."}));return}e.update(v=>({...v,isLoadingEvents:!0,error:null}));const d=await n();if(!d){e.update(v=>({...v,isLoadingEvents:!1,error:"Calendar Canister actor not available"}));return}try{const v=BigInt(s.getTime())*1000000n,f=BigInt(u.getTime())*1000000n;console.log(`Fetching events for calendar ${i} from ${s.toISOString()} to ${u.toISOString()}`);const x=(await d.get_events_for_range(i,v,f)).map(xt);e.update(b=>({...b,events:x,isLoadingEvents:!1}))}catch(v){console.error("Error fetching events:",v),e.update(f=>({...f,error:v.message||"Failed to fetch events",isLoadingEvents:!1}))}},createEvent:async i=>{e.update(u=>({...u,isLoadingEvents:!0,error:null}));const s=await n();if(!s)return e.update(u=>({...u,isLoadingEvents:!1,error:"Calendar Canister actor not available"})),null;try{const u=i.calendarId,d=i.title,v=i.description,f=BigInt(i.startTime.getTime())*1000000n,l=BigInt(i.endTime.getTime())*1000000n,x=i.color;console.log("Creating event with params:",u,d,v,f,l,x);const b=await s.create_event(u,d,v,f,l,x),C=xt(b);return e.update(w=>({...w,events:[...w.events,C].sort((T,L)=>T.startTime.getTime()-L.startTime.getTime()),isLoadingEvents:!1})),C}catch(u){return console.error("Error creating event:",u),e.update(d=>({...d,error:u.message||"Failed to create event",isLoadingEvents:!1})),null}},updateEvent:async(i,s)=>{e.update(d=>({...d,isLoadingEvents:!0,error:null}));const u=await n();if(!u)return e.update(d=>({...d,isLoadingEvents:!1,error:"Calendar Canister actor not available"})),null;try{const d=s.title!==void 0?[s.title]:[],v=s.description!==void 0?[s.description]:[],f=s.startTime!==void 0?[BigInt(s.startTime.getTime())*1000000n]:[],l=s.endTime!==void 0?[BigInt(s.endTime.getTime())*1000000n]:[],x=s.color!==void 0?[s.color]:[];console.log(`Updating event ${i} with data:`,s);const b=await u.update_event(i,d,v,f,l,x);if(b.length>0){const C=b[0],w=xt(C);return e.update(T=>({...T,events:T.events.map(L=>L.id===i?w:L).sort((L,D)=>L.startTime.getTime()-D.startTime.getTime()),isLoadingEvents:!1})),w}else return e.update(C=>({...C,error:"Failed to update event (no event returned)",isLoadingEvents:!1})),null}catch(d){return console.error("Error updating event:",d),e.update(v=>({...v,error:d.message||"Failed to update event",isLoadingEvents:!1})),null}},deleteEvent:async i=>{e.update(u=>({...u,isLoadingEvents:!0,error:null}));const s=await n();if(!s)return e.update(u=>({...u,isLoadingEvents:!1,error:"Calendar Canister actor not available"})),!1;try{console.log(`Deleting event ${i}`);const u=await s.delete_event(i);return u?e.update(d=>({...d,events:d.events.filter(v=>v.id!==i),isLoadingEvents:!1})):e.update(d=>({...d,error:"Failed to delete event on backend (returned false)",isLoadingEvents:!1})),u}catch(u){return console.error("Error deleting event:",u),e.update(d=>({...d,error:u.message||"Failed to delete event",isLoadingEvents:!1})),!1}}};return c})();console.log("calendarStore.ts updated to use actual canister declarations and actor calls.");/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const pr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var yr=qa("<svg><!><!></svg>");function Te(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]),n=ve(r,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Pe(a,!1);let o=se(a,"name",8,void 0),c=se(a,"color",8,"currentColor"),i=se(a,"size",8,24),s=se(a,"strokeWidth",8,2),u=se(a,"absoluteStrokeWidth",8,!1),d=se(a,"iconNode",24,()=>[]);const v=(...b)=>b.filter((C,w,T)=>!!C&&T.indexOf(C)===w).join(" ");Ye();var f=yr();Pt(f,(b,C)=>({...pr,...n,width:i(),height:i(),stroke:c(),"stroke-width":b,class:C}),[()=>(ge(u()),ge(s()),ge(i()),I(()=>u()?Number(s())*24/Number(i()):s())),()=>(ge(o()),ge(r),I(()=>v("lucide-icon","lucide",o()?`lucide-${o()}`:"",r.class)))]);var l=p(f);me(l,1,d,He,(b,C)=>{var w=Ba(()=>ja(t(C),2));let T=()=>t(w)[0],L=()=>t(w)[1];var D=be(),m=fe(D);sr(m,T,!0,(E,z)=>{Pt(E,()=>({...L()}))}),A(b,D)});var x=M(l);pe(x,a,"default",{}),h(f),A(e,f),ze()}function Rt(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]];Te(e,Ce({name:"calendar"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function _r(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"m6 9 6 6 6-6"}]];Te(e,Ce({name:"chevron-down"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function wr(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"m15 18-6-6 6-6"}]];Te(e,Ce({name:"chevron-left"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function xr(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"m9 18 6-6-6-6"}]];Te(e,Ce({name:"chevron-right"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function Dr(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}],["path",{d:"M12 17h.01"}]];Te(e,Ce({name:"circle-question-mark"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function Ut(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]];Te(e,Ce({name:"clock"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function Er(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]];Te(e,Ce({name:"plus"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function Cr(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"m21 21-4.34-4.34"}],["circle",{cx:"11",cy:"11",r:"8"}]];Te(e,Ce({name:"search"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function Tr(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]];Te(e,Ce({name:"settings"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}function $r(e,a){const r=ve(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}],["circle",{cx:"12",cy:"7",r:"4"}]];Te(e,Ce({name:"user"},()=>r,{get iconNode(){return n},children:(o,c)=>{var i=be(),s=fe(i);pe(s,a,"default",{}),A(o,i)},$$slots:{default:!0}}))}var Mr=H("<option> </option>"),kr=H('<header class="px-4 py-2 flex items-center bg-white shadow sticky top-0 z-50"><img src="/favicon.svg" alt="Calendar Icon" class="h-8 w-8 mr-2"/> <h1 class="mr-10 text-xl text-gray-500 font-bold hidden sm:block">Calendar</h1> <button class="border rounded py-2 px-4 mr-2 sm:mr-5 text-gray-600 hover:bg-gray-100 text-sm sm:text-base">Today</button> <button class="p-2 rounded-full text-gray-600 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Previous period"><!></button> <button class="p-2 rounded-full text-gray-600 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Next period"><!></button> <h2 class="ml-2 sm:ml-4 text-lg sm:text-xl text-gray-700 font-medium whitespace-nowrap overflow-hidden text-ellipsis" style="min-width: 120px; max-width: 300px;"> </h2> <button title="Create new event" class="ml-4 sm:ml-6 p-2 rounded-full bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md"><!></button> <div class="ml-auto flex items-center space-x-2"><button class="p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 hidden md:inline-flex" title="Search"><!></button> <button class="p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 hidden md:inline-flex" title="Help"><!></button> <button class="p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 hidden md:inline-flex" title="Settings"><!></button> <div class="relative"><select aria-label="Calendar View" class="appearance-none border border-gray-300 rounded-md py-2 pl-3 pr-10 text-sm bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 svelte-17e862m"></select> <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600"><!></div></div> <button class="ml-2 p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 hidden sm:inline-flex" title="Account"><!></button></div></header>');function Sr(e,a){Pe(a,!1);const r=V();let n=se(a,"currentView",12,"month"),o=se(a,"displayDate",24,()=>new Date);const c=it(),i=[{label:"Day",value:"day"},{label:"Month",value:"month"},{label:"Year",value:"year"}];function s(Y){const K=Y.target.value;K!==n()&&c("setView",K)}function u(Y){c("navigate",Y)}function d(){c("openEventModal")}qe(()=>(ge(n()),ge(o())),()=>{_(r,n()==="month"?o().toLocaleString("default",{month:"long",year:"numeric"}):n()==="day"?o().toLocaleDateString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):n()==="year"?o().getFullYear().toString():o().toLocaleDateString())}),Ge(),Ye();var v=kr(),f=M(p(v),4),l=M(f,2),x=p(l);wr(x,{size:20}),h(l);var b=M(l,2),C=p(b);xr(C,{size:20}),h(b);var w=M(b,2),T=p(w,!0);h(w);var L=M(w,2),D=p(L);Er(D,{size:20}),h(L);var m=M(L,2),E=p(m),z=p(E);Cr(z,{size:18,class:"text-gray-600"}),h(E);var k=M(E,2),$=p(k);Dr($,{size:18,class:"text-gray-600"}),h(k);var O=M(k,2),F=p(O);Tr(F,{size:18,class:"text-gray-600"}),h(O);var g=M(O,2),y=p(g);W(()=>{n(),Wa(()=>{})}),me(y,5,()=>i,Y=>Y.value,(Y,U)=>{var K=Mr(),te=p(K,!0);h(K);var G={};W(()=>{ee(te,(t(U),I(()=>t(U).label))),G!==(G=(t(U),I(()=>t(U).value)))&&(K.value=(K.__value=(t(U),I(()=>t(U).value)))??"")}),A(Y,K)}),h(y);var N=M(y,2),R=p(N);_r(R,{size:16}),h(N),h(g);var B=M(g,2),q=p(B);$r(q,{size:18,class:"text-gray-600"}),h(B),h(m),h(v),W(()=>ee(T,t(r))),Q("click",f,()=>u("today")),Q("click",l,()=>u("prev")),Q("click",b,()=>u("next")),Q("click",L,d),vr(y,n),Q("change",y,s),A(e,v),ze()}var Ar=H('<div class="event-item text-xs p-1 rounded truncate text-white svelte-48jz61"> </div>'),Nr=H('<div class="events-list space-y-1 overflow-y-auto flex-grow"></div>'),Lr=H('<div role="button" tabindex="0"><div> </div> <!></div>'),Fr=H('<div class="month-view bg-white"><div class="days-of-week grid grid-cols-7 text-center text-sm text-gray-600 font-medium border-b border-gray-200"><div>Sun</div> <div>Mon</div> <div>Tue</div> <div>Wed</div> <div>Thu</div> <div>Fri</div> <div>Sat</div></div> <div class="grid grid-cols-7 grid-rows-5 min-h-[calc(100vh-200px)]"></div></div>');function Ir(e,a){Pe(a,!1);let r=se(a,"displayDate",24,()=>new Date),n=se(a,"events",24,()=>[]);se(a,"selectedCalendarId",8,null);const o=it();let c=V([]);function i(){r().toLocaleString("default",{month:"long"}),r().getFullYear();const f=r().getFullYear(),l=r().getMonth(),x=new Date(f,l,1),C=new Date(f,l+1,0).getDate(),w=x.getDay(),T=[],L=new Date,D=new Date(f,l,0),m=w;for(let $=0;$<m;$++){const O=new Date(D.getFullYear(),D.getMonth(),D.getDate()-$);T.unshift({date:O,isCurrentMonth:!1,isToday:!1})}for(let $=1;$<=C;$++){const O=new Date(f,l,$);T.push({date:O,isCurrentMonth:!0,isToday:O.getDate()===L.getDate()&&O.getMonth()===L.getMonth()&&O.getFullYear()===L.getFullYear()})}const E=T.length,k=(Math.ceil(E/7)*7<35?35:Math.ceil(E/7)*7)-E;for(let $=1;$<=k;$++){const O=new Date(f,l+1,$);T.push({date:O,isCurrentMonth:!1,isToday:!1})}_(c,T)}function s(f){return n().filter(l=>{const x=new Date(l.startTime);return x.getFullYear()===f.getFullYear()&&x.getMonth()===f.getMonth()&&x.getDate()===f.getDate()}).slice(0,3)}function u(f){f.isCurrentMonth&&o("openEventModalForDate",f.date)}ft(()=>{i()}),qe(()=>ge(r()),()=>{r()&&i()}),Ge(),Ye();var d=Fr(),v=M(p(d),2);me(v,5,()=>t(c),f=>f.date.toISOString(),(f,l)=>{var x=Lr();let b;var C=p(x);let w;var T=p(C,!0);h(C);var L=M(C,2);{var D=m=>{var E=Nr();me(E,5,()=>(t(l),I(()=>s(t(l).date))),z=>z.id,(z,k)=>{var $=Ar();let O;var F=p($,!0);h($),W(g=>{ke($,"title",(t(k),I(()=>t(k).title))),O=We($,"",O,g),ee(F,(t(k),I(()=>t(k).title)))},[()=>({"background-color":(t(k),I(()=>t(k).color||"#3b82f6"))})],he),A(z,$)}),h(E),A(m,E)};j(L,m=>{t(l),I(()=>t(l).isCurrentMonth)&&m(D)})}h(x),W((m,E,z,k)=>{b=rt(x,1,"day-cell border border-gray-200 p-2 flex flex-col relative hover:bg-gray-50 svelte-48jz61",null,b,m),ke(x,"aria-label",E),w=rt(C,1,"day-number text-xs sm:text-sm mb-1 svelte-48jz61",null,w,z),ee(T,k)},[()=>({"not-current-month":!t(l).isCurrentMonth,today:t(l).isToday&&t(l).isCurrentMonth}),()=>(t(l),I(()=>`Date ${t(l).date.toLocaleDateString()}`)),()=>({"text-gray-900":t(l).isCurrentMonth,"text-gray-400":!t(l).isCurrentMonth,"font-bold":t(l).isToday&&t(l).isCurrentMonth}),()=>(t(l),I(()=>t(l).date.getDate()))],he),Q("click",x,()=>u(t(l))),Q("keydown",x,m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),u(t(l)))}),A(f,x)}),h(v),h(d),A(e,d),ze()}var Yr=H('<p class="text-sm text-blue-600 mt-1">Today</p>'),Pr=H('<div class="event-item p-2 rounded text-white text-sm cursor-pointer hover:opacity-90 svelte-1xbaijq" role="button" tabindex="0"> </div>'),zr=H('<div class="all-day-events mb-6 p-4 bg-gray-50 rounded-lg"><h3 class="text-sm font-semibold text-gray-700 mb-2">All Day</h3> <div class="space-y-2"></div></div>'),Or=H('<div class="current-time-line absolute left-0 right-0 h-0.5 bg-red-500 z-10 flex items-center svelte-1xbaijq"><div class="w-3 h-3 bg-red-500 rounded-full -ml-1.5"></div> <div class="text-xs text-red-500 ml-2 bg-white px-1"> </div></div>'),Rr=H('<div class="text-xs opacity-90 mt-1"> </div>'),Ur=H('<div class="event-item absolute left-4 right-4 p-2 rounded text-white text-sm cursor-pointer hover:opacity-90 z-20 svelte-1xbaijq" role="button" tabindex="0"><div class="font-medium"> </div> <!> <div class="text-xs opacity-75 mt-1"> </div></div>'),Vr=H('<div class="time-slot flex border-b border-gray-100 hover:bg-gray-50 cursor-pointer relative svelte-1xbaijq" role="button" tabindex="0"><div class="time-label w-20 flex-shrink-0 text-xs text-gray-500 text-right pr-4 py-2"> </div> <div class="time-content flex-1 min-h-[60px] py-2 px-4 relative"></div></div>'),Hr=H('<div class="day-view bg-white svelte-1xbaijq"><div class="day-header text-center mb-6"><h2 class="text-2xl font-bold text-gray-800"> </h2> <!></div> <!> <div class="timeline-container relative svelte-1xbaijq"><!> <div class="time-slots"></div></div></div>');function qr(e,a){Pe(a,!1);const r=V();let n=se(a,"displayDate",24,()=>new Date),o=se(a,"events",24,()=>[]);const c=it();let i=V(),s=V([]),u=V([]);function d(){_(i,n().toLocaleDateString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"}));const F=o().filter(g=>{const y=new Date(g.startTime);return y.getFullYear()===n().getFullYear()&&y.getMonth()===n().getMonth()&&y.getDate()===n().getDate()});_(u,F.filter(g=>{const y=new Date(g.startTime);return new Date(g.endTime).getTime()-y.getTime()>=24*60*60*1e3-1})),_(s,[]);for(let g=0;g<24;g++){const y=v(g),N=F.filter(R=>new Date(R.startTime).getHours()===g&&!t(u).includes(R));t(s).push({hour:g,timeLabel:y,events:N})}}function v(F){return F===0?"12:00 AM":F===12?"12:00 PM":F<12?`${F}:00 AM`:`${F-12}:00 PM`}function f(F){const g=new Date(n());g.setHours(F,0,0,0),c("openEventModalForDate",g)}function l(F){c("eventClick",F)}function x(){const F=new Date;if(F.getFullYear()===n().getFullYear()&&F.getMonth()===n().getMonth()&&F.getDate()===n().getDate()){const g=F.getHours(),y=F.getMinutes();return(g*60+y)/(24*60)*100}return-1}qe(()=>ge(n()),()=>{n()&&d()}),qe(()=>{},()=>{_(r,x())}),Ge(),Ye();var b=Hr(),C=p(b),w=p(C),T=p(w,!0);h(w);var L=M(w,2);{var D=F=>{var g=Yr();A(F,g)};j(L,F=>{ge(n()),I(()=>n().getDate()===new Date().getDate()&&n().getMonth()===new Date().getMonth()&&n().getFullYear()===new Date().getFullYear())&&F(D)})}h(C);var m=M(C,2);{var E=F=>{var g=zr(),y=M(p(g),2);me(y,5,()=>t(u),He,(N,R)=>{var B=Pr();let q;var Y=p(B,!0);h(B),W(U=>{q=We(B,"",q,U),ee(Y,(t(R),I(()=>t(R).title)))},[()=>({"background-color":(t(R),I(()=>t(R).color||"#3b82f6"))})],he),Q("click",B,()=>l(t(R))),Q("keydown",B,U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),l(t(R)))}),A(N,B)}),h(y),h(g),A(F,g)};j(m,F=>{t(u),I(()=>t(u).length>0)&&F(E)})}var z=M(m,2),k=p(z);{var $=F=>{var g=Or();let y;var N=M(p(g),2),R=p(N,!0);h(N),h(g),W((B,q)=>{y=We(g,"",y,B),ee(R,q)},[()=>({top:`${t(r)??""}%`}),()=>I(()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))],he),A(F,g)};j(k,F=>{t(r)>=0&&F($)})}var O=M(k,2);me(O,5,()=>t(s),He,(F,g)=>{var y=Vr(),N=p(y),R=p(N,!0);h(N);var B=M(N,2);me(B,5,()=>(t(g),I(()=>t(g).events)),He,(q,Y)=>{var U=Ur();let K;var te=p(U),G=p(te,!0);h(te);var oe=M(te,2);{var Se=le=>{var ye=Rr(),$e=p(ye,!0);h(ye),W(()=>ee($e,(t(Y),I(()=>t(Y).description)))),A(le,ye)};j(oe,le=>{t(Y),I(()=>t(Y).description)&&le(Se)})}var Ae=M(oe,2),Be=p(Ae);h(Ae),h(U),W((le,ye,$e)=>{K=We(U,"",K,le),ee(G,(t(Y),I(()=>t(Y).title))),ee(Be,`${ye??""} -
									${$e??""}`)},[()=>({"background-color":(t(Y),I(()=>t(Y).color||"#3b82f6"))}),()=>(t(Y),I(()=>new Date(t(Y).startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),()=>(t(Y),I(()=>new Date(t(Y).endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})))],he),Q("click",U,mr(()=>l(t(Y)))),Q("keydown",U,le=>{(le.key==="Enter"||le.key===" ")&&(le.preventDefault(),l(t(Y)))}),A(q,U)}),h(B),h(y),W(()=>ee(R,(t(g),I(()=>t(g).timeLabel)))),Q("click",y,()=>f(t(g).hour)),Q("keydown",y,q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),f(t(g).hour))}),A(F,y)}),h(O),h(z),h(b),W(()=>ee(T,t(i))),A(e,b),ze()}var Br=H('<div role="button"><!></div>'),jr=H('<div class="month-card bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow svelte-13nvr66"><div class="month-header bg-gray-50 px-4 py-3 border-b border-gray-200"><h3 class="text-lg font-semibold text-gray-800 text-center cursor-pointer hover:text-blue-600" role="button" tabindex="0"> </h3></div> <div class="month-body p-2"><div class="days-of-week grid grid-cols-7 text-center text-xs text-gray-500 font-medium mb-1"><div>S</div> <div>M</div> <div>T</div> <div>W</div> <div>T</div> <div>F</div> <div>S</div></div> <div class="days-grid grid grid-cols-7 gap-1"></div></div></div>'),Wr=H('<div class="year-view bg-white svelte-13nvr66"><div class="year-header text-center mb-8"><h2 class="text-3xl font-bold text-gray-800"> </h2></div> <div class="months-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div></div>');function Gr(e,a){Pe(a,!1);let r=se(a,"displayDate",24,()=>new Date),n=se(a,"events",24,()=>[]);const o=it();let c=V(),i=V([]);function s(){_(c,r().getFullYear());const C=new Date;_(i,[]);for(let w=0;w<12;w++){const T=new Date(t(c),w,1),L=T.toLocaleString("default",{month:"long"}),D=new Date(t(c),w+1,0).getDate(),m=T.getDay(),E=[];for(let z=0;z<m;z++)E.push({date:new Date(0),isToday:!1,hasEvents:!1,isEmpty:!0});for(let z=1;z<=D;z++){const k=new Date(t(c),w,z),$=k.getDate()===C.getDate()&&k.getMonth()===C.getMonth()&&k.getFullYear()===C.getFullYear(),O=n().some(F=>{const g=new Date(F.startTime);return g.getFullYear()===k.getFullYear()&&g.getMonth()===k.getMonth()&&g.getDate()===k.getDate()});E.push({date:k,isToday:$,hasEvents:O,isEmpty:!1})}t(i).push({name:L,date:T,days:E})}}function u(C){o("switchToMonthView",C)}function d(C){o("openEventModalForDate",C)}qe(()=>ge(r()),()=>{r()&&s()}),Ge(),Ye();var v=Wr(),f=p(v),l=p(f),x=p(l,!0);h(l),h(f);var b=M(f,2);me(b,5,()=>t(i),He,(C,w)=>{var T=jr(),L=p(T),D=p(L),m=p(D,!0);h(D),h(L);var E=M(L,2),z=M(p(E),2);me(z,5,()=>(t(w),I(()=>t(w).days)),He,(k,$)=>{var O=Br(),F=p(O);{var g=y=>{var N=Ue();W(R=>ee(N,R),[()=>(t($),I(()=>t($).date.getDate()))],he),A(y,N)};j(F,y=>{t($),I(()=>!t($).isEmpty)&&y(g)})}h(O),W(y=>{rt(O,1,`day-cell w-8 h-8 flex items-center justify-center text-xs rounded cursor-pointer
									${t($),I(()=>t($).isEmpty?"invisible":"")??""}
									${t($),I(()=>t($).isToday?"bg-blue-500 text-white font-bold":"hover:bg-gray-100")??""}
									${t($),I(()=>t($).hasEvents?"bg-blue-100 text-blue-800":"")??""}
									${t($),I(()=>t($).isToday&&t($).hasEvents?"bg-blue-600 text-white":"")??""}
								`,"svelte-13nvr66"),ke(O,"tabindex",(t($),I(()=>t($).isEmpty?-1:0))),ke(O,"aria-label",y)},[()=>(t($),I(()=>t($).isEmpty?"":`${t($).date.toLocaleDateString()}`))],he),Q("click",O,()=>!t($).isEmpty&&d(t($).date)),Q("keydown",O,y=>{!t($).isEmpty&&(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),d(t($).date))}),A(k,O)}),h(z),h(E),h(T),W(()=>ee(m,(t(w),I(()=>t(w).name)))),Q("click",D,()=>u(t(w).date)),Q("keydown",D,k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),u(t(w).date))}),A(C,T)}),h(b),h(v),W(()=>ee(x,t(c))),A(e,v),ze()}var Kr=H('<p class="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-4 text-sm"> </p>'),Xr=H('<span class="text-white text-sm">✓</span>'),Qr=H('<button type="button"><!></button>'),Zr=H('<div class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-[1000]" role="dialog" aria-modal="true" aria-labelledby="event-modal-title"><div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto"><h2 id="event-modal-title" class="text-xl font-semibold mb-4"> </h2> <!> <form><div class="mb-4"><label for="event-title" class="block text-sm font-medium text-gray-700 mb-1">Title</label> <input type="text" id="event-title" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"/></div> <div class="grid grid-cols-1 gap-4 mb-4"><div class="grid grid-cols-2 gap-4"><div><label for="event-start-date" class="block text-sm font-medium text-gray-700 mb-1">Start Date</label> <div class="relative"><input type="date" id="event-start-date" required class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"/> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><!></div></div></div> <div><label for="event-start-time" class="block text-sm font-medium text-gray-700 mb-1">Start Time</label> <div class="relative"><input type="time" id="event-start-time" required class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"/> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><!></div></div></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="event-end-date" class="block text-sm font-medium text-gray-700 mb-1">End Date</label> <div class="relative"><input type="date" id="event-end-date" required class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"/> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><!></div></div></div> <div><label for="event-end-time" class="block text-sm font-medium text-gray-700 mb-1">End Time</label> <div class="relative"><input type="time" id="event-end-time" required class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"/> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><!></div></div></div></div></div> <div class="mb-4"><label for="event-description" class="block text-sm font-medium text-gray-700 mb-1">Description (Optional)</label> <textarea id="event-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea></div> <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Color</label> <div class="flex flex-wrap gap-2"></div> <div class="mt-2"><label for="custom-color" class="block text-xs text-gray-500 mb-1">Custom Color</label> <input type="color" id="custom-color" class="w-16 h-8 rounded border border-gray-300 cursor-pointer"/></div></div> <div class="flex justify-end space-x-3"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Cancel</button> <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"><!></button></div></form></div></div>');function Jr(e,a){Pe(a,!1);let r=se(a,"targetDate",8,null),n=se(a,"eventToEdit",8,null),o=se(a,"calendarId",8);const c=it();let i=V(""),s=V(""),u=V(""),d=V(""),v=V(""),f=V(""),l=V("#3b82f6"),x=V(!1),b=V("");const C=[{name:"Blue",value:"#3b82f6"},{name:"Red",value:"#ef4444"},{name:"Green",value:"#10b981"},{name:"Yellow",value:"#f59e0b"},{name:"Purple",value:"#8b5cf6"},{name:"Pink",value:"#ec4899"},{name:"Indigo",value:"#6366f1"},{name:"Teal",value:"#14b8a6"},{name:"Orange",value:"#f97316"},{name:"Gray",value:"#6b7280"}];function w(S){const P=S.getFullYear(),X=(S.getMonth()+1).toString().padStart(2,"0"),Le=S.getDate().toString().padStart(2,"0");return`${P}-${X}-${Le}`}function T(S){const P=S.getHours().toString().padStart(2,"0"),X=S.getMinutes().toString().padStart(2,"0");return`${P}:${X}`}function L(S,P){return new Date(`${S}T${P}`)}ft(()=>{if(n()){_(i,n().title),_(s,n().description);const S=new Date(n().startTime),P=new Date(n().endTime);_(u,w(S)),_(d,T(S)),_(v,w(P)),_(f,T(P)),_(l,n().color||"#3b82f6")}else if(r()){const S=new Date(r());S.setHours(9,0,0,0),_(u,w(S)),_(d,T(S));const P=new Date(S);P.setHours(S.getHours()+1),_(v,w(P)),_(f,T(P))}else{const S=new Date;S.setHours(S.getHours()+1,0,0,0),_(u,w(S)),_(d,T(S));const P=new Date(S);P.setHours(S.getHours()+1),_(v,w(P)),_(f,T(P))}});async function D(){if(!t(i).trim()){_(b,"Title is required.");return}if(!t(u)||!t(d)||!t(v)||!t(f)){_(b,"Start and end dates/times are required.");return}const S=L(t(u),t(d)),P=L(t(v),t(f));if(S>=P){_(b,"End time must be after start time.");return}_(x,!0),_(b,"");try{const X={calendarId:o(),title:t(i),description:t(s),startTime:S,endTime:P,color:t(l)};if(n()&&n().id){const{calendarId:Le,...Oe}=X;await Ee.updateEvent(n().id,Oe)}else await Ee.createEvent(X);c("eventSaved"),m()}catch(X){console.error("Failed to save event:",X),_(b,X.message||"Failed to save event. Please try again.")}finally{_(x,!1)}}function m(){c("close")}function E(S){const P=S.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),X=P[0],Le=P[P.length-1];function Oe(Re){Re.key==="Tab"?Re.shiftKey?document.activeElement===X&&(Le.focus(),Re.preventDefault()):document.activeElement===Le&&(X.focus(),Re.preventDefault()):Re.key==="Escape"&&m()}return X==null||X.focus(),S.addEventListener("keydown",Oe),{destroy(){S.removeEventListener("keydown",Oe)}}}Ye();var z=Zr(),k=p(z),$=p(k),O=p($,!0);h($);var F=M($,2);{var g=S=>{var P=Kr(),X=p(P,!0);h(P),W(()=>ee(X,t(b))),A(S,P)};j(F,S=>{t(b)&&S(g)})}var y=M(F,2),N=p(y),R=M(p(N),2);Me(R),h(N);var B=M(N,2),q=p(B),Y=p(q),U=M(p(Y),2),K=p(U);Me(K);var te=M(K,2),G=p(te);Rt(G,{size:16,class:"text-gray-400"}),h(te),h(U),h(Y);var oe=M(Y,2),Se=M(p(oe),2),Ae=p(Se);Me(Ae);var Be=M(Ae,2),le=p(Be);Ut(le,{size:16,class:"text-gray-400"}),h(Be),h(Se),h(oe),h(q);var ye=M(q,2),$e=p(ye),ot=M(p($e),2),Ke=p(ot);Me(Ke);var lt=M(Ke,2),gt=p(lt);Rt(gt,{size:16,class:"text-gray-400"}),h(lt),h(ot),h($e);var Z=M($e,2),ie=M(p(Z),2),ue=p(ie);Me(ue);var _e=M(ue,2),de=p(_e);Ut(de,{size:16,class:"text-gray-400"}),h(_e),h(ie),h(Z),h(ye),h(B);var ne=M(B,2),Ne=M(p(ne),2);Ga(Ne),h(ne);var re=M(ne,2),we=M(p(re),2);me(we,5,()=>C,He,(S,P)=>{var X=Qr();let Le,Oe;var Re=p(X);{var oa=Qe=>{var ht=Xr();A(Qe,ht)};j(Re,Qe=>{t(l),t(P),I(()=>t(l)===t(P).value)&&Qe(oa)})}h(X),W((Qe,ht)=>{Le=rt(X,1,"w-8 h-8 rounded-full border-2 transition-all duration-200 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",null,Le,Qe),ke(X,"title",(t(P),I(()=>t(P).name))),Oe=We(X,"",Oe,ht)},[()=>({"border-gray-800":t(l)===t(P).value,"border-gray-300":t(l)!==t(P).value}),()=>({"background-color":(t(P),I(()=>t(P).value))})],he),Q("click",X,()=>_(l,t(P).value)),A(S,X)}),h(we);var xe=M(we,2),je=M(p(xe),2);Me(je),h(xe),h(re);var ae=M(re,2),ce=p(ae),Xe=M(ce,2),na=p(Xe);{var sa=S=>{var P=Ue("Saving...");A(S,P)},ia=S=>{var P=Ue();W(()=>ee(P,n()?"Save Changes":"Add Event")),A(S,P)};j(na,S=>{t(x)?S(sa):S(ia,!1)})}h(Xe),h(ae),h(y),h(k),ir(k,S=>E==null?void 0:E(S)),h(z),W(()=>{ee(O,n()?"Edit Event":"Add New Event"),Xe.disabled=t(x)}),De(R,()=>t(i),S=>_(i,S)),De(K,()=>t(u),S=>_(u,S)),De(Ae,()=>t(d),S=>_(d,S)),De(Ke,()=>t(v),S=>_(v,S)),De(ue,()=>t(f),S=>_(f,S)),De(Ne,()=>t(s),S=>_(s,S)),De(je,()=>t(l),S=>_(l,S)),Q("click",ce,m),Q("submit",y,br(D)),Q("click",z,hr(m)),A(e,z),ze()}var en=H('<div class="text-center p-10">Loading events...</div>'),tn=H('<div class="calendar-container flex flex-col h-full bg-gray-50 svelte-t4e59n"><!> <div class="calendar-body flex-grow overflow-auto p-4"><!> <!></div> <!></div>');function an(e,a){Pe(a,!1);let r=V("month"),n=V(new Date),o=V(!1),c=V(null),i=V([]),s=V(null),u=V(!1);const d=Ee.subscribe(g=>{_(i,g.events),_(s,g.selectedCalendarId),_(u,g.isLoadingEvents)});function v(g){_(r,g.detail),w()}function f(g){const y=g.detail;let N=new Date(t(n));if(y==="today")N=new Date;else{const R=y==="next"?1:-1;t(r)==="month"?N.setMonth(N.getMonth()+R):t(r)==="day"?N.setDate(N.getDate()+R):t(r)==="year"&&N.setFullYear(N.getFullYear()+R)}_(n,N)}function l(g){_(c,(g==null?void 0:g.detail)||new Date),_(o,!0)}function x(g){_(n,g.detail),_(r,"month"),w()}function b(g){console.log("Event clicked:",g.detail)}function C(){_(o,!1),_(c,null)}async function w(){if(!t(s)){Ee.update(N=>({...N,events:[]}));return}let g,y;if(t(r)==="month")g=new Date(t(n).getFullYear(),t(n).getMonth(),1),y=new Date(t(n).getFullYear(),t(n).getMonth()+1,0,23,59,59,999);else if(t(r)==="day")g=new Date(t(n).getFullYear(),t(n).getMonth(),t(n).getDate()),y=new Date(t(n).getFullYear(),t(n).getMonth(),t(n).getDate(),23,59,59,999);else if(t(r)==="year")g=new Date(t(n).getFullYear(),0,1),y=new Date(t(n).getFullYear(),11,31,23,59,59,999);else{console.error("Unknown view for fetching events:",t(r));return}await Ee.fetchEvents(t(s),g,y)}ft(()=>{t(s)&&w()}),Kt(()=>{d&&d()}),qe(()=>(t(n),t(r),t(s)),()=>{(t(n)||t(r)||t(s))&&w()}),Ge(),Ye();var T=tn(),L=p(T);Sr(L,{get currentView(){return t(r)},set currentView(g){_(r,g)},get displayDate(){return t(n)},set displayDate(g){_(n,g)},$$events:{setView:v,navigate:f,openEventModal:l},$$legacy:!0});var D=M(L,2),m=p(D);{var E=g=>{var y=en();A(g,y)};j(m,g=>{t(u)&&g(E)})}var z=M(m,2);{var k=g=>{Ir(g,{get events(){return t(i)},get selectedCalendarId(){return t(s)},get displayDate(){return t(n)},set displayDate(y){_(n,y)},$$events:{openEventModalForDate:l},$$legacy:!0})},$=(g,y)=>{{var N=B=>{qr(B,{get events(){return t(i)},get displayDate(){return t(n)},set displayDate(q){_(n,q)},$$events:{openEventModalForDate:l,eventClick:b},$$legacy:!0})},R=(B,q)=>{{var Y=U=>{Gr(U,{get events(){return t(i)},get displayDate(){return t(n)},set displayDate(K){_(n,K)},$$events:{openEventModalForDate:l,switchToMonthView:x},$$legacy:!0})};j(B,U=>{t(r)==="year"&&U(Y)},q)}};j(g,B=>{t(r)==="day"?B(N):B(R,!1)},y)}};j(z,g=>{t(r)==="month"?g(k):g($,!1)})}h(D);var O=M(D,2);{var F=g=>{Jr(g,{get targetDate(){return t(c)},get calendarId(){return t(s)},$$events:{close:C,eventSaved:()=>{w(),C()}}})};j(O,g=>{t(o)&&t(s)&&g(F)})}h(T),A(e,T),ze()}var rn=H('<meta name="description" content="A simple calendar application"/>'),nn=H('<p class="text-red-500 text-sm mb-4"> </p>'),sn=H('<div class="registration-form bg-white p-8 rounded-lg shadow-md max-w-md mx-auto my-10"><h2 class="text-xl font-semibold text-center mb-6">Welcome! Please Register</h2> <!> <input type="text" placeholder="Your Name" class="w-full px-3 py-2 border rounded mb-4"/> <button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded disabled:opacity-75"><!></button></div>'),on=H('<p class="text-sm text-gray-500">Loading calendars...</p>'),ln=H("<option> </option>"),dn=H('<select id="calendar-select" class="w-full sm:min-w-[200px] mt-1 block pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"></select>'),cn=H('<p class="text-sm text-gray-500">No calendars found. Please create one.</p>'),un=H('<p class="text-red-500 text-xs mt-1"> </p>'),vn=H('<p class="text-red-500 text-sm mb-2"> </p>'),fn=H('<div class="new-calendar-form mt-4 pt-4 border-t"><h3 class="text-md font-semibold mb-2">Create New Calendar</h3> <!> <input type="text" placeholder="My Calendar" class="w-full px-3 py-2 border rounded mb-2"/> <div class="flex items-center mb-3"><label for="new-calendar-color" class="mr-2 text-sm">Color:</label> <input type="color" id="new-calendar-color" class="h-8 w-12 border rounded"/></div> <button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded text-sm disabled:opacity-75"><!></button></div>'),gn=H('<p class="text-center text-gray-600">Please select a calendar to view.</p>'),hn=H('<div class="calendar-management mb-6 p-4 bg-white rounded-lg shadow"><div class="flex flex-col sm:flex-row items-center justify-between gap-4"><div class="flex-grow w-full sm:w-auto"><label for="calendar-select" class="block text-sm font-medium text-gray-700 mb-1">Select Calendar:</label> <!> <!></div> <button class="w-full sm:w-auto mt-2 sm:mt-0 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"> </button></div> <!></div> <!>',1),mn=H('<p class="text-center text-gray-500 mt-10">Please log in to manage and view your calendars.</p>'),bn=H('<p class="text-center text-gray-500 mt-10">Loading user information...</p>'),pn=H('<div class="container mx-auto p-4 min-h-screen svelte-gsiio6"><!></div>');function Tn(e,a){Pe(a,!1);const[r,n]=Qa(),o=()=>bt(Qt,"$isLoggedIn",r),c=()=>bt(tr,"$userProfile",r),i=()=>bt(ct,"$authIdentity",r);let s=V(!1),u=V(""),d=V(!1),v=V(""),f=V([]),l=V(null),x=V(!1),b=V(null);const C=Ee.subscribe(y=>{_(f,y.calendars),_(l,y.selectedCalendarId),_(x,y.isLoadingCalendars),_(b,y.error)});let w=V(!1),T=V(""),L=V("#4285F4"),D=V(!1),m=V("");const E=async()=>{var y;if(!t(u).trim()){_(v,"Please enter your name.");return}_(d,!0),_(v,"");try{const N=i();if(!N)throw new Error("Identity not available.");await(await Xt(N)).register(t(u)),await Tt(),_(s,!1),o()&&c()&&Ee.fetchUserCalendars()}catch(N){console.error("Registration failed:",N),_(v,(y=N.message)!=null&&y.includes("User already registered")?"Already registered. Refreshing...":"Registration failed."),t(v).includes("Refreshing")&&await Tt()}finally{_(d,!1)}};function z(y){const N=y.target,R=BigInt(N.value);R&&Ee.setSelectedCalendar(R)}async function k(){if(!t(T).trim()){_(m,"Calendar name is required.");return}_(D,!0),_(m,"");try{await Ee.createNewUserCalendar(t(T),t(L))?(_(w,!1),_(T,"")):_(m,t(b)||"Failed to create calendar.")}catch(y){console.error("Failed to create new calendar:",y),_(m,y.message||"An unexpected error occurred.")}finally{_(D,!1)}}ft(async()=>{o()&&c()&&t(f).length===0&&!t(x)&&await Ee.fetchUserCalendars()}),Kt(()=>{C&&C()}),qe(()=>(o(),c(),i()),()=>{o()&&c()===null&&!i().getPrincipal().isAnonymous()?_(s,!0):_(s,!1)}),Ge(),Ye();var $=pn();Ka(y=>{var N=rn();Xa.title="ICP Calendar",A(y,N)});var O=p($);{var F=y=>{var N=sn(),R=M(p(N),2);{var B=G=>{var oe=nn(),Se=p(oe,!0);h(oe),W(()=>ee(Se,t(v))),A(G,oe)};j(R,G=>{t(v)&&G(B)})}var q=M(R,2);Me(q);var Y=M(q,2),U=p(Y);{var K=G=>{var oe=Ue("Registering...");A(G,oe)},te=G=>{var oe=Ue("Register");A(G,oe)};j(U,G=>{t(d)?G(K):G(te,!1)})}h(Y),h(N),W(()=>{q.disabled=t(d),Y.disabled=t(d)}),De(q,()=>t(u),G=>_(u,G)),Q("click",Y,E),A(y,N)},g=(y,N)=>{{var R=q=>{var Y=hn(),U=fe(Y),K=p(U),te=p(K),G=M(p(te),2);{var oe=Z=>{var ie=on();A(Z,ie)},Se=(Z,ie)=>{{var ue=de=>{var ne=dn();me(ne,5,()=>t(f),re=>re.id,(re,we)=>{var xe=ln(),je=p(xe,!0);h(xe);var ae={};W(ce=>{ee(je,(t(we),I(()=>t(we).name||"My Calendar"))),ae!==(ae=ce)&&(xe.value=(xe.__value=ce)??"")},[()=>(t(we),I(()=>t(we).id.toString()))],he),A(re,xe)}),h(ne);var Ne;St(ne),W(re=>{Ne!==(Ne=re)&&(ne.value=(ne.__value=re)??"",nt(ne,re))},[()=>(t(l),I(()=>{var re;return((re=t(l))==null?void 0:re.toString())||""}))],he),Q("change",ne,z),A(de,ne)},_e=de=>{var ne=cn();A(de,ne)};j(Z,de=>{t(f),I(()=>t(f).length>0)?de(ue):de(_e,!1)},ie)}};j(G,Z=>{t(x)?Z(oe):Z(Se,!1)})}var Ae=M(G,2);{var Be=Z=>{var ie=un(),ue=p(ie,!0);h(ie),W(()=>ee(ue,t(b))),A(Z,ie)};j(Ae,Z=>{t(b)&&Z(Be)})}h(te);var le=M(te,2),ye=p(le,!0);h(le),h(K);var $e=M(K,2);{var ot=Z=>{var ie=fn(),ue=M(p(ie),2);{var _e=ae=>{var ce=vn(),Xe=p(ce,!0);h(ce),W(()=>ee(Xe,t(m))),A(ae,ce)};j(ue,ae=>{t(m)&&ae(_e)})}var de=M(ue,2);Me(de);var ne=M(de,2),Ne=M(p(ne),2);Me(Ne),h(ne);var re=M(ne,2),we=p(re);{var xe=ae=>{var ce=Ue("Creating...");A(ae,ce)},je=ae=>{var ce=Ue("Create Calendar");A(ae,ce)};j(we,ae=>{t(D)?ae(xe):ae(je,!1)})}h(re),h(ie),W(()=>re.disabled=t(D)),De(de,()=>t(T),ae=>_(T,ae)),De(Ne,()=>t(L),ae=>_(L,ae)),Q("click",re,k),A(Z,ie)};j($e,Z=>{t(w)&&Z(ot)})}h(U);var Ke=M(U,2);{var lt=Z=>{an(Z,{})},gt=(Z,ie)=>{{var ue=_e=>{var de=gn();A(_e,de)};j(Z,_e=>{t(x),t(f),I(()=>!t(x)&&t(f).length>0)&&_e(ue)},ie)}};j(Ke,Z=>{t(l)?Z(lt):Z(gt,!1)})}W(()=>ee(ye,t(w)?"Cancel":"+ New Calendar")),Q("click",le,()=>_(w,!t(w))),A(q,Y)},B=(q,Y)=>{{var U=te=>{var G=mn();A(te,G)},K=te=>{var G=bn();A(te,G)};j(q,te=>{o()?te(K,!1):te(U)},Y)}};j(y,q=>{o()&&c()?q(R):q(B,!1)},N)}};j(O,y=>{t(s)?y(F):y(g,!1)})}h($),A(e,$),ze(),n()}export{Tn as component};
