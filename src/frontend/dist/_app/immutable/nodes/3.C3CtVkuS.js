import"../chunks/CWj6FrbW.js";import{i as z}from"../chunks/heriVLba.js";import{j as B,o as Y,k as D,m as F,n as g,t as L,q as G,r as s,v as H,s as n,w as P,x as l,y as f,a as d,z as c,A as J,B as K}from"../chunks/s4GdUkTq.js";import{i as v,s as N,a as k}from"../chunks/Bf4ltAop.js";import{i as O,l as Q}from"../chunks/3xWfw-0N.js";import{g as y}from"../chunks/DMWDyL2v.js";import{p as T}from"../chunks/5uyD5zu_.js";var V=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert"><strong class="font-bold">Error:</strong> <span class="block sm:inline"> </span></div>'),W=g("<span>Logging in...</span>"),X=g("<span>Already Logged In</span>"),Z=g('<p class="text-xs text-gray-600 mt-4 text-center">You will be redirected to the Internet Identity service.</p>'),ee=g('<div class="flex items-center justify-center min-h-screen bg-gray-200"><div class="p-8 bg-white shadow-xl rounded-lg max-w-md w-full"><h1 class="text-3xl font-bold text-center text-blue-600 mb-6">ICP Calendar Login</h1> <!> <p class="text-gray-700 mb-6 text-center">Please log in using your Internet Identity to access the calendar.</p> <button class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline transition duration-150 ease-in-out disabled:opacity-50"><!></button> <!></div></div>');function le(C,U){B(U,!1);const[h,$]=N(),r=()=>k(O,"$isLoggedIn",h),m=()=>k(T,"$page",h);let a=P(!1),p=P(null);Y(()=>{if(r()){console.log("User already logged in on mount, redirecting..."),n(a,!1);const e=m().url.searchParams.get("redirect"),t=e?decodeURIComponent(e):"/";y(t,{replaceState:!0})}});const S=async()=>{n(a,!0),n(p,null);try{console.log("Starting login process..."),await Q(),console.log("Login process completed")}catch(e){console.error("Login attempt failed:",e),n(p,"Login failed. Please try again. Ensure your Internet Identity is set up and pop-ups are allowed."),n(a,!1)}};D(()=>(r(),m(),y),()=>{if(r()){console.log("User is logged in, redirecting..."),n(a,!1);const e=m().url.searchParams.get("redirect"),t=e?decodeURIComponent(e):"/";y(t,{replaceState:!0})}}),F(),z();var b=ee(),I=l(b),w=f(l(I),2);{var j=e=>{var t=V(),u=f(l(t),2),_=l(u,!0);c(u),c(t),L(()=>J(_,d(p))),s(e,t)};v(w,e=>{d(p)&&e(j)})}var i=f(w,4),A=l(i);{var E=e=>{var t=W();s(e,t)},M=(e,t)=>{{var u=o=>{var x=X();s(o,x)},_=o=>{var x=K("Log In with Internet Identity");s(o,x)};v(e,o=>{r()?o(u):o(_,!1)},t)}};v(A,e=>{d(a)?e(E):e(M,!1)})}c(i);var R=f(i,2);{var q=e=>{var t=Z();s(e,t)};v(R,e=>{!r()&&!d(a)&&e(q)})}c(I),c(b),L(()=>i.disabled=d(a)||r()),G("click",i,S),s(C,b),H(),$()}export{le as component};
